{
	"name": "GSO_ETL",
	"properties": {
		"folder": {
			"name": "GSO"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Fact_GSO_Data_Flow",
						"type": "DatasetReference"
					},
					"name": "fGsoCallSummarySource"
				},
				{
					"dataset": {
						"referenceName": "Fact_GSO_Data_Flow",
						"type": "DatasetReference"
					},
					"name": "fGsoResponseSource"
				},
				{
					"dataset": {
						"referenceName": "Fact_GSO_Data_Flow",
						"type": "DatasetReference"
					},
					"name": "dSalesForceTeradata"
				},
				{
					"dataset": {
						"referenceName": "Fact_GSO_Data_Flow",
						"type": "DatasetReference"
					},
					"name": "dSalesForceFuncionario"
				},
				{
					"dataset": {
						"referenceName": "Fact_GSO_Data_Flow",
						"type": "DatasetReference"
					},
					"name": "dSalesForceSqlServer"
				},
				{
					"dataset": {
						"referenceName": "Fact_GSO_Data_Flow",
						"type": "DatasetReference"
					},
					"name": "dSalesForceRegiao"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Salvar_Fato_GSO_Sink",
						"type": "DatasetReference"
					},
					"name": "FatoGsoDestino"
				},
				{
					"dataset": {
						"referenceName": "Salvar_Dim_GSO_Sink",
						"type": "DatasetReference"
					},
					"name": "SalesForceDestino"
				}
			],
			"transformations": [
				{
					"name": "UniaoFato"
				},
				{
					"name": "LeftJoinFuncionario"
				},
				{
					"name": "SelecionarValoresUnicos"
				},
				{
					"name": "LeftJoinSalesForceSQLSERVER"
				},
				{
					"name": "SelecionarValoresUnicos2"
				},
				{
					"name": "LeftJoinRegiao"
				},
				{
					"name": "SelecaoFinal"
				}
			],
			"script": "source(output(\n\t\tCALL_SUMMARY_ID as string,\n\t\tPARENT_CALL_AID as string,\n\t\tLOCAL_CALL_DATE_ID as string,\n\t\tCALL_DATE_ID as string,\n\t\tTERRITORY_ID as string,\n\t\tCYCLE as string,\n\t\tSALES_FORCE_KEY as string,\n\t\tDATE as string,\n\t\tLOCAL_CALL_TIME_ID as string,\n\t\tACCOUNT_ID as string,\n\t\tCALL_NAME as string,\n\t\tRX_CALL_TYPE as string,\n\t\tCALL_STATUS as string,\n\t\tATTENDEE_TYPE as string,\n\t\tCLM_IND as string,\n\t\tSAMPLE_CALL_IND as string,\n\t\tCALL_TYPE as string,\n\t\tDETAILED_PRODUCTS as string,\n\t\tDURATION as string,\n\t\tCREATED_DATE_ID as string,\n\t\tCREATED_DATE_TIME_ID as string,\n\t\tLAST_MODIFIED_DATE_ID as string,\n\t\tLAST_MODIFIED_DATE_TIME_ID as string,\n\t\tPRE_CALL_NOTES as string,\n\t\tNEXT_CALL_NOTES as string,\n\t\tREVIEW_STATUS as string,\n\t\tACCOUNT_NAME as string,\n\t\tRX_LEGAL_ID as string,\n\t\tKEY_MESSAGE_NAME as string,\n\t\tQUESTION_ID as string,\n\t\tPRODUCT as string,\n\t\tCALL_DATE as string,\n\t\tORIGEM as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/fato_gso_call_summary.parquet'],\n\tpartitionBy('hash', 1)) ~> fGsoCallSummarySource\nsource(output(\n\t\tSURVEY_KEY as string,\n\t\tQUESTION_ID as string,\n\t\tSOURCE_CREATED_TS as string,\n\t\tRESPONSE_LAST_MODIFIED_TS as string,\n\t\tSOURCE_USER_AID as string,\n\t\tQUESTION_RESPONSE_ID as string,\n\t\tRESPONSE_NAME as string,\n\t\tRESPONSE_NUMBER as string,\n\t\tRESPONSE as string,\n\t\tPRODUCT as string,\n\t\tRESPONSE_QUESTION_ORDER as string,\n\t\tDATE as string,\n\t\tTARGET_LAST_MODIFIED_TS as string,\n\t\tMODIFIED_DATE as string,\n\t\tSTART_DATE_ID as string,\n\t\tEND_DATE_ID as string,\n\t\tREVIEW_DATE_ID as string,\n\t\tREVIEW_STATUS as string,\n\t\tMANAGER_TERRITORY_ID as string,\n\t\tEMPLOYEE_TERRITORY_ID as string,\n\t\tTERRITORY_ID as string,\n\t\tDATE_DIFF as string,\n\t\tFLAG_PREMIO as string,\n\t\tSALES_FORCE_KEY as string,\n\t\tRESPONSES_KEY as string,\n\t\tORIGEM as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/fato_gso_response.parquet'],\n\tpartitionBy('hash', 1)) ~> fGsoResponseSource\nsource(output(\n\t\tRX_EXTERNAL_ID as string,\n\t\tUSER_ID as string,\n\t\tSF_SOURCE_USER_AID as string,\n\t\tUSER_NAME as string,\n\t\tFIRST_NAME as string,\n\t\tNAME as string,\n\t\tLAST_NAME as string,\n\t\tCOUNTRY as string,\n\t\tSTATE_PROVINCE as string,\n\t\tCITY as string,\n\t\tPOSTAL_CODE as string,\n\t\tACTIVE_IND as string,\n\t\tEMAIL as string,\n\t\tEMPLOYEE_NUMBER_AID as string,\n\t\tUSER_IDENTIFIER_AID as string,\n\t\tCORE_GSK_FUNCTIONAL_PROFILE as string,\n\t\tPROFILE_NAME as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_sales_force_teradata.parquet'],\n\tpartitionBy('hash', 1)) ~> dSalesForceTeradata\nsource(output(\n\t\tRX_EXTERNAL_ID as string,\n\t\tUF as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_sales_force_funcionario.parquet'],\n\tpartitionBy('hash', 1)) ~> dSalesForceFuncionario\nsource(output(\n\t\tRX_EXTERNAL_ID as string,\n\t\tCICLO as string,\n\t\tSALES_FORCE_KEY as string,\n\t\tSF_KEY as string,\n\t\tROW_ID_TERRITORIO as string,\n\t\tROW_ID_GD as string,\n\t\tNOME_GD as string,\n\t\tNOME_GR as string,\n\t\tTERRITORIO_GD as string,\n\t\tTERRITORIO_GR as string,\n\t\tBU as string,\n\t\t{DIVISÃO} as string,\n\t\tTERRITORIO as string,\n\t\tNOME_REP as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_sales_force_sqlserver.parquet'],\n\tpartitionBy('hash', 1)) ~> dSalesForceSqlServer\nsource(output(\n\t\tAREA as string,\n\t\tUF as string,\n\t\tREGION as string,\n\t\tSTATE as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_region.parquet'],\n\tpartitionBy('hash', 1)) ~> dSalesForceRegiao\nfGsoCallSummarySource, fGsoResponseSource union(byName: true,\n\tpartitionBy('hash', 1))~> UniaoFato\ndSalesForceTeradata, dSalesForceFuncionario join(dSalesForceTeradata@RX_EXTERNAL_ID == dSalesForceFuncionario@RX_EXTERNAL_ID,\n\tjoinType:'left',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> LeftJoinFuncionario\nLeftJoinFuncionario select(mapColumn(\n\t\tRX_EXTERNAL_ID = dSalesForceTeradata@RX_EXTERNAL_ID,\n\t\tUSER_ID,\n\t\tSF_SOURCE_USER_AID,\n\t\tUSER_NAME,\n\t\tFIRST_NAME,\n\t\tNAME,\n\t\tLAST_NAME,\n\t\tCOUNTRY,\n\t\tSTATE_PROVINCE,\n\t\tCITY,\n\t\tPOSTAL_CODE,\n\t\tACTIVE_IND,\n\t\tEMAIL,\n\t\tEMPLOYEE_NUMBER_AID,\n\t\tUSER_IDENTIFIER_AID,\n\t\tCORE_GSK_FUNCTIONAL_PROFILE,\n\t\tPROFILE_NAME,\n\t\tUF\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecionarValoresUnicos\nSelecionarValoresUnicos, dSalesForceSqlServer join(SelecionarValoresUnicos@RX_EXTERNAL_ID == dSalesForceSqlServer@RX_EXTERNAL_ID,\n\tjoinType:'left',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> LeftJoinSalesForceSQLSERVER\nLeftJoinSalesForceSQLSERVER select(mapColumn(\n\t\tRX_EXTERNAL_ID = SelecionarValoresUnicos@RX_EXTERNAL_ID,\n\t\tUSER_ID,\n\t\tSF_SOURCE_USER_AID,\n\t\tUSER_NAME,\n\t\tFIRST_NAME,\n\t\tNAME,\n\t\tLAST_NAME,\n\t\tCOUNTRY,\n\t\tSTATE_PROVINCE,\n\t\tCITY,\n\t\tPOSTAL_CODE,\n\t\tACTIVE_IND,\n\t\tEMAIL,\n\t\tEMPLOYEE_NUMBER_AID,\n\t\tUSER_IDENTIFIER_AID,\n\t\tCORE_GSK_FUNCTIONAL_PROFILE,\n\t\tPROFILE_NAME,\n\t\tUF,\n\t\tCICLO,\n\t\tSALES_FORCE_KEY,\n\t\tSF_KEY,\n\t\tROW_ID_TERRITORIO,\n\t\tROW_ID_GD,\n\t\tNOME_GD,\n\t\tNOME_GR,\n\t\tTERRITORIO_GD,\n\t\tTERRITORIO_GR,\n\t\tBU,\n\t\t{DIVISÃO},\n\t\tTERRITORIO,\n\t\tNOME_REP\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecionarValoresUnicos2\nSelecionarValoresUnicos2, dSalesForceRegiao join(SelecionarValoresUnicos2@UF == dSalesForceRegiao@UF,\n\tjoinType:'left',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> LeftJoinRegiao\nLeftJoinRegiao select(mapColumn(\n\t\tRX_EXTERNAL_ID,\n\t\tUSER_ID,\n\t\tSF_SOURCE_USER_AID,\n\t\tUSER_NAME,\n\t\tFIRST_NAME,\n\t\tNAME,\n\t\tLAST_NAME,\n\t\tCOUNTRY,\n\t\tSTATE_PROVINCE,\n\t\tCITY,\n\t\tPOSTAL_CODE,\n\t\tACTIVE_IND,\n\t\tEMAIL,\n\t\tEMPLOYEE_NUMBER_AID,\n\t\tUSER_IDENTIFIER_AID,\n\t\tCORE_GSK_FUNCTIONAL_PROFILE,\n\t\tPROFILE_NAME,\n\t\tCICLO,\n\t\tSALES_FORCE_KEY,\n\t\tSF_KEY,\n\t\tROW_ID_TERRITORIO,\n\t\tROW_ID_GD,\n\t\tNOME_GD,\n\t\tNOME_GR,\n\t\tTERRITORIO_GD,\n\t\tTERRITORIO_GR,\n\t\tBU,\n\t\t{DIVISÃO},\n\t\tTERRITORIO,\n\t\tNOME_REP,\n\t\tUF = SelecionarValoresUnicos2@UF,\n\t\tAREA = {BRASIL.Area},\n\t\tREGION = Regiao,\n\t\tSTATE = State\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoFinal\nUniaoFato sink(input(\n\t\tCALL_SUMMARY_ID as string,\n\t\tPARENT_CALL_AID as string,\n\t\tLOCAL_CALL_DATE_ID as string,\n\t\tCALL_DATE_ID as string,\n\t\tTERRITORY_ID as string,\n\t\tCYCLE as string,\n\t\tSALES_FORCE_KEY as string,\n\t\tDATE as string,\n\t\tLOCAL_CALL_TIME_ID as string,\n\t\tACCOUNT_ID as string,\n\t\tCALL_NAME as string,\n\t\tRX_CALL_TYPE as string,\n\t\tCALL_STATUS as string,\n\t\tATTENDEE_TYPE as string,\n\t\tCLM_IND as string,\n\t\tSAMPLE_CALL_IND as string,\n\t\tCALL_TYPE as string,\n\t\tDETAILED_PRODUCTS as string,\n\t\tDURATION as string,\n\t\tCREATED_DATE_ID as string,\n\t\tCREATED_DATE_TIME_ID as string,\n\t\tLAST_MODIFIED_DATE_ID as string,\n\t\tLAST_MODIFIED_DATE_TIME_ID as string,\n\t\tPRE_CALL_NOTES as string,\n\t\tNEXT_CALL_NOTES as string,\n\t\tREVIEW_STATUS as string,\n\t\tACCOUNT_NAME as string,\n\t\tRX_LEGAL_ID as string,\n\t\tKEY_MESSAGE_NAME as string,\n\t\tQUESTION_ID as string,\n\t\tPRODUCT as string,\n\t\tCALL_DATE as string,\n\t\tORIGEM as string,\n\t\tSURVEY_KEY as string,\n\t\tSOURCE_CREATED_TS as string,\n\t\tRESPONSE_LAST_MODIFIED_TS as string,\n\t\tSOURCE_USER_AID as string,\n\t\tQUESTION_RESPONSE_ID as string,\n\t\tRESPONSE_NAME as string,\n\t\tRESPONSE_NUMBER as string,\n\t\tRESPONSE as string,\n\t\tRESPONSE_QUESTION_ORDER as string,\n\t\tTARGET_LAST_MODIFIED_TS as string,\n\t\tMODIFIED_DATE as string,\n\t\tSTART_DATE_ID as string,\n\t\tEND_DATE_ID as string,\n\t\tREVIEW_DATE_ID as string,\n\t\tMANAGER_TERRITORY_ID as string,\n\t\tEMPLOYEE_TERRITORY_ID as string,\n\t\tDATE_DIFF as string,\n\t\tFLAG_PREMIO as string,\n\t\tRESPONSES_KEY as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['fato_gso.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> FatoGsoDestino\nSelecaoFinal sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dim_sales_force.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SalesForceDestino"
		}
	}
}