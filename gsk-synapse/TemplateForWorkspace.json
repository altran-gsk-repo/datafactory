{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"workspaceName": {
			"type": "string",
			"metadata": "Workspace name",
			"defaultValue": "gsk-synapse"
		},
		"Arquivos_Em_Parquet_3_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Arquivos_Em_Parquet_3'"
		},
		"AzureBlobStorageSynapse_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureBlobStorageSynapse'"
		},
		"AzureDataLakeStorage1_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'AzureDataLakeStorage1'"
		},
		"AzureDataLakeStorageBlobSynapse_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'AzureDataLakeStorageBlobSynapse'"
		},
		"CompressArquivoSave_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'CompressArquivoSave'"
		},
		"FileServerDouglas_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'FileServerDouglas'"
		},
		"FileServerDouglasNew_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'FileServerDouglasNew'"
		},
		"FileServerGSK_password": {
			"type": "secureString",
			"metadata": "Secure string for 'password' of 'FileServerGSK'"
		},
		"Listar_Arquivos_Txt_3_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'Listar_Arquivos_Txt_3'"
		},
		"SqlServerConfigCarga_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'SqlServerConfigCarga'"
		},
		"SqlServerGSK_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'SqlServerGSK'"
		},
		"SqlServerLocalDouglasDB_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'SqlServerLocalDouglasDB'"
		},
		"SqlServerLocalDouglasDev_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'SqlServerLocalDouglasDev'"
		},
		"TeradataVeevaGSK_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'TeradataVeevaGSK'"
		},
		"gsk-synapse-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'gsk-synapse-WorkspaceDefaultSqlServer'"
		},
		"AzureDataLakeStorage1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://gsksynapseaccount.dfs.core.windows.net"
		},
		"CompressArquivoSave_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://gsksynapseaccount.dfs.core.windows.net"
		},
		"FileServerDouglas_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "D:\\Documentos"
		},
		"FileServerDouglas_properties_typeProperties_userId": {
			"type": "string",
			"defaultValue": "DESKTOP-FVENMUR\\dougl"
		},
		"FileServerDouglasNew_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "C:\\Users\\dougl\\OneDrive\\GSK_FLAT_FILES"
		},
		"FileServerDouglasNew_properties_typeProperties_userId": {
			"type": "string",
			"defaultValue": "DESKTOP-FVENMUR\\dougl"
		},
		"FileServerGSK_properties_typeProperties_host": {
			"type": "string",
			"defaultValue": "C:\\Users\\dqa99106\\OneDrive - GSK\\Documents\\"
		},
		"FileServerGSK_properties_typeProperties_userId": {
			"type": "string",
			"defaultValue": "WMSERVICE\\dqa99106"
		},
		"gsk-synapse-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://gsksynapseaccount.dfs.core.windows.net"
		}
	},
	"variables": {
		"workspaceId": "[concat('Microsoft.Synapse/workspaces/', parameters('workspaceName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('workspaceName'), '/1 - Extract - Email 1-1')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "dim_painel_medico",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings",
									"compressionProperties": {
										"type": "ZipDeflateReadSettings"
									}
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CRM_CICLO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CRM_CICLO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "MES",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MES",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CICLO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CICLO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CRM",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CRM",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "MEDICO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MEDICO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TIPO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TIPO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TIPOCONTATO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TIPOCONTATO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "GRUPOPROMOCIONAL",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "GRUPOPROMOCIONAL",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ESPECIALIDADE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ESPECIALIDADE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "LOGRADOURO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "LOGRADOURO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "COMPLEMENTO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "COMPLEMENTO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "BAIRRO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BAIRRO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CIDADE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CIDADE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "UF",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "UF",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CEP",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CEP",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "BRICK",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "BRICK",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TELEFONEMEDICO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "TELEFONEMEDICO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CELULARMEDICO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CELULARMEDICO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "EMAIL_1_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EMAIL_1_1",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ROW_ID_FUNCIONARIO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ROW_ID_FUNCIONARIO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ROW_ID_TERRITORIO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ROW_ID_TERRITORIO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ROW_ID_CONTATO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ROW_ID_CONTATO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "STATUS",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "QTD_VISITA_PLANEJADA_PAINEL",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "QTD_VISITA_PLANEJADA_PAINEL",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "QTD_VISITA_REALIZADA_PAINEL",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "QTD_VISITA_REALIZADA_PAINEL",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ESPECIALIDADE_02",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ESPECIALIDADE_02",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ESPECIALIDADE_03",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ESPECIALIDADE_03",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "VP_PROX",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "VP_PROX",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "STATUS_MEDICO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "STATUS_MEDICO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "EMAIL_1_1_CONSENT",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EMAIL_1_1_CONSENT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NETWORK_ID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "NETWORK_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "RX_GIGYA_ID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "RX_GIGYA_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "VEEVA_ID",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "VEEVA_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ROW_ID_CONTATO_EXT",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ROW_ID_CONTATO_EXT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "EMAIL_MASS",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EMAIL_MASS",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "EMAIL_MASS_CONSENT",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "EMAIL_MASS_CONSENT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CYCLE_PLAN",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CYCLE_PLAN",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "MERCADO",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MERCADO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PRODUTO_PAINEL",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PRODUTO_PAINEL",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FileSystemGSK",
								"type": "DatasetReference",
								"parameters": {
									"nome_arquivo": "dim_painel_medico.zip"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Arquivo_Em_TxT_1",
								"type": "DatasetReference",
								"parameters": {
									"nome_arquivo": "dim_painel_medico.zip",
									"pasta": "dash.email1to1"
								}
							}
						]
					}
				],
				"folder": {
					"name": "Extract"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/FileSystemGSK')]",
				"[concat(variables('workspaceId'), '/datasets/Arquivo_Em_TxT_1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/1 - Transform  - Email 1-1 e KPI')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Lista_Arquivos",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Listar_Arquivos_Txt_1",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "Filtra_Arquivos_ZIP",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Lista_Arquivos",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lista_Arquivos').output.childitems",
								"type": "Expression"
							},
							"condition": {
								"value": "@contains(item().name,'.zip')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Para_Cada_ZIP",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filtra_Arquivos_ZIP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filtra_Arquivos_ZIP').output.Value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Transforma_ZIP_to_TXT",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"wildcardFolderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.email1to1",
												"wildcardFileName": {
													"value": "@{item().name}",
													"type": "Expression"
												}
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings",
												"compressionProperties": {
													"type": "ZipDeflateReadSettings"
												}
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "ListarArquivosComprimidos_1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "arquivo_txt_s_comprimir",
											"type": "DatasetReference",
											"parameters": {
												"nome_arquivo": {
													"value": "@{replace(item().name,'.zip','.txt')}",
													"type": "Expression"
												},
												"pasta": "dash.email1to1"
											}
										}
									]
								},
								{
									"name": "Transforma_TXT_toParquet",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Transforma_ZIP_to_TXT",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true,
												"wildcardFolderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.email1to1",
												"wildcardFileName": {
													"value": "@{replace(item().name,'.zip','.txt')}",
													"type": "Expression"
												},
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "ParquetSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "ParquetWriteSettings"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Listar_Arquivos_Txt_1",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Arquivos_Em_Parquet_1",
											"type": "DatasetReference",
											"parameters": {
												"nome_arquivo": "@{replace(item().name,'.zip','.parquet')}"
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Deletar_Arquivos_ZIP",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Para_Cada_ZIP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Listar_Arquivos_Txt_1",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"wildcardFileName": "*.zip"
							}
						}
					},
					{
						"name": "Deletar_Arquivos_TXT",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Para_Cada_ZIP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Listar_Arquivos_Txt_1",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"wildcardFileName": "*.txt",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "EMAIL_ETL",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Deletar_Arquivos_TXT",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Deletar_Arquivos_ZIP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "EMAIL_ETL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"dIntVisitasRealizadas": {},
									"dIntVisitasMedico": {},
									"dIntEmail": {},
									"dIntVisitasFranchise": {},
									"dIntEventos": {},
									"HistZona": {},
									"RepsZona": {},
									"dForcaVendas": {},
									"dKPITerritorio": {},
									"dCoaching": {},
									"dMSLDivision": {},
									"dTargetSRO": {},
									"dQuadranteMedico": {},
									"dQuadranteMedicoGP": {},
									"dAuditEnd": {},
									"dPainelMedico": {},
									"TraducaoEspecialidadeEventos": {},
									"SinkFatoInteracoes": {},
									"SinkDimForcaVendas": {},
									"SinkDimHistoricoZonas": {},
									"SinkDimKpiTerritorio": {},
									"SinkCoaching": {},
									"SinkDimMslDivision": {},
									"SinkDimTargetSro": {},
									"SinkDimQuadranteMedico": {},
									"SinkDimQuadranteMedicoGp": {},
									"SinkDimAuditEnd": {},
									"SinkDimPainelMedico": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"variables": {
					"ValorVerdadeiro": {
						"type": "Array"
					},
					"ValorFalso": {
						"type": "Array"
					}
				},
				"folder": {
					"name": "Transform"
				},
				"annotations": [],
				"lastPublishTime": "2020-12-17T02:42:58Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Listar_Arquivos_Txt_1')]",
				"[concat(variables('workspaceId'), '/dataflows/EMAIL_ETL')]",
				"[concat(variables('workspaceId'), '/datasets/ListarArquivosComprimidos_1')]",
				"[concat(variables('workspaceId'), '/datasets/arquivo_txt_s_comprimir')]",
				"[concat(variables('workspaceId'), '/datasets/Arquivos_Em_Parquet_1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/2 - Transform  - KPI Visitacao')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Lista_Arquivos",
						"type": "GetMetadata",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Listar_Arquivos_Txt_2",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "Filtra_Arquivos_ZIP",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Lista_Arquivos",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lista_Arquivos').output.childitems",
								"type": "Expression"
							},
							"condition": {
								"value": "@contains(item().name,'.zip')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Para_Cada_ZIP",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filtra_Arquivos_ZIP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filtra_Arquivos_ZIP').output.Value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Transforma_ZIP_to_TXT",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobFSReadSettings",
												"recursive": true,
												"wildcardFolderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao",
												"wildcardFileName": {
													"value": "@{item().name}",
													"type": "Expression"
												}
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings",
												"compressionProperties": {
													"type": "ZipDeflateReadSettings"
												}
											}
										},
										"sink": {
											"type": "DelimitedTextSink",
											"storeSettings": {
												"type": "AzureBlobFSWriteSettings"
											},
											"formatSettings": {
												"type": "DelimitedTextWriteSettings",
												"quoteAllText": true,
												"fileExtension": ".txt"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "ListarArquivosComprimidos_2",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "arquivo_txt_s_comprimir",
											"type": "DatasetReference",
											"parameters": {
												"nome_arquivo": {
													"value": "@{replace(item().name,'.zip','.txt')}",
													"type": "Expression"
												},
												"pasta": "dash.kpi_visitacao"
											}
										}
									]
								},
								{
									"name": "Transforma_TXT_toParquet",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Transforma_ZIP_to_TXT",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true,
												"wildcardFolderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao",
												"wildcardFileName": {
													"value": "@{replace(item().name,'.zip','.txt')}",
													"type": "Expression"
												},
												"enablePartitionDiscovery": false
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "ParquetSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "ParquetWriteSettings"
											}
										},
										"enableStaging": false,
										"enableSkipIncompatibleRow": true,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Listar_Arquivos_Txt_2",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Arquivos_Em_Parquet_2",
											"type": "DatasetReference",
											"parameters": {
												"nome_arquivo": {
													"value": "@{replace(item().name,'.zip','.parquet')}",
													"type": "Expression"
												}
											}
										}
									]
								}
							]
						}
					},
					{
						"name": "Deletar_Arquivos_ZIP",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Para_Cada_ZIP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Listar_Arquivos_Txt_2",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"wildcardFileName": "*.zip"
							}
						}
					},
					{
						"name": "Deletar_Arquivos_TXT",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Para_Cada_ZIP",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Listar_Arquivos_Txt_2",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"wildcardFileName": "*.txt",
								"enablePartitionDiscovery": false
							}
						}
					},
					{
						"name": "KPI_ETL",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Deletar_Arquivos_ZIP",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Deletar_Arquivos_TXT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "KPI_ETL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"DimTopIndependentes": {},
									"DimPainelMedico": {},
									"FatoVisitasRealizadas": {},
									"SinkDimPainelMedico": {},
									"SinkFatoVisitasRealizadas": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"variables": {
					"ValorVerdadeiro": {
						"type": "Array"
					},
					"ValorFalso": {
						"type": "Array"
					}
				},
				"folder": {
					"name": "Transform"
				},
				"annotations": [],
				"lastPublishTime": "2020-12-17T02:42:58Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Listar_Arquivos_Txt_2')]",
				"[concat(variables('workspaceId'), '/dataflows/KPI_ETL')]",
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]",
				"[concat(variables('workspaceId'), '/datasets/ListarArquivosComprimidos_2')]",
				"[concat(variables('workspaceId'), '/datasets/arquivo_txt_s_comprimir')]",
				"[concat(variables('workspaceId'), '/datasets/Arquivos_Em_Parquet_2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/3 - Extract - GSO')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "dim_visits",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "TeradataSource",
								"query": "SELECT DISTINCT\n\t\"P\".SURVEY_TARGET_ID \t\t\t\t\tAS \"SURVEY_KEY\",\n\t\"ST\".\"DATE\" AS \"VISIT_DATE\",\n\tCOALESCE(\"PRD\".SURVEY_KEY,'NOT INFORMED') AS \"VISIT_PRODUCT\",\n\tSUM(\"P\".RESPONSE_NUMBER) AS \"TOTAL_VISITS\"\n    \n FROM LATAMCRMFBICNTRYBRVW.F_SURVEY_RESPONSES AS \"P\"\n \n LEFT JOIN (SELECT DISTINCT\n\t\"P\".SURVEY_TARGET_ID \t\t\t\t\tAS \"SURVEY_KEY\",\n    \"P\".RESPONSE\n FROM LATAMCRMFBICNTRYBRVW.F_SURVEY_RESPONSES AS \"P\"\n WHERE \"P\".QUESTION_ORDER = 0  AND \"P\".RESPONSE IS NOT NULL) AS \"PRD\" ON \"P\".SURVEY_TARGET_ID = \"PRD\".SURVEY_KEY\n \n INNER JOIN (SELECT \n\t  \"ST\".SURVEY_TARGET_ID as \"SURVEY_KEY\",\n\t  CAST(TRIM(CAST(LEFT(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)),4)||'-'||\n\t  SUBSTRING(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)) FROM 5 FOR 2) ||'-'||\n\t  RIGHT(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)),2) AS VARCHAR(10))) AS DATE FORMAT 'yyyy-mm-dd') AS \"DATE\",\n\t  \"ST\".SOURCE_LAST_MODIFIED_TS as \"TARGET_LAST_MODIFIED_TS\",\n\t  CAST(\"ST\".SOURCE_LAST_MODIFIED_TS AS DATE FORMAT 'YYYYMMDD') AS \"MODIFIED_DATE\",\n\t  \"ST\".START_DATE_ID,\n\t  \"ST\".END_DATE_ID,\n\t  \"ST\".REVIEW_DATE_ID,\n\t  \"ST\".REVIEW_STATUS,\n\t  \"ST\".MANAGER_TERRITORY_ID,\n\t  \"ST\".EMPLOYEE_TERRITORY_ID,\n\t  \"ST\".TERRITORY_ID\nFROM LATAMCRMFBICNTRYBRVW.F_SURVEY_TARGETS AS \"ST\"\nWHERE \"ST\".COUNTRY_CODE = 'BR'  AND \n\t\"ST\".SURVEY_TARGET_NAME LIKE '%GSO U%' AND\n\tLEFT(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)),6) > '201901') AS \"ST\" ON \"P\".SURVEY_TARGET_ID = \"ST\".SURVEY_KEY\n\nWHERE \"P\".QUESTION_ID = '12215'\nGROUP BY \"P\".SURVEY_TARGET_ID,\n\t\t\t\"ST\".\"DATE\",\n\t\tCOALESCE(\"PRD\".SURVEY_KEY,'NOT INFORMED');",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SURVEY_KEY",
											"type": "Int32"
										},
										"sink": {
											"name": "SURVEY_KEY",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "VISIT_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "VISIT_DATE",
											"type": "DateTime",
											"physicalType": "DateTime"
										}
									},
									{
										"source": {
											"name": "VISIT_PRODUCT",
											"type": "String"
										},
										"sink": {
											"name": "VISIT_PRODUCT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TOTAL_VISITS",
											"type": "Int32"
										},
										"sink": {
											"name": "TOTAL_VISITS",
											"type": "Int32",
											"physicalType": "Int32"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "TeradataTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Arquivo_Em_TxT_3",
								"type": "DatasetReference",
								"parameters": {
									"pasta_nome_arquivo": "dim_visits.txt"
								}
							}
						]
					},
					{
						"name": "dim_survey_question",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "dim_visits",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "TeradataSource",
								"query": "SELECT \n\t  QUESTION_ID,\n      CREATED_DATE AS \"QUESTION_CREATED_DATE\",\n      QUESTION_NAME,     \n      SOURCE_LAST_MODIFIED_TS\tAS \"QUESTION_LAST_MODIFIED_TS\",\n      QUESTION_TEXT,\n      QUESTION_ORDER \t\tAS \"QUESTION_ORDER\",\n      CASE\n      WHEN QUESTION_ORDER = 0 THEN 'PRODUCT'\n      WHEN QUESTION_ORDER = 1 THEN 'COCO'\n      WHEN QUESTION_ORDER = 2 THEN 'SOB'\n      WHEN QUESTION_ORDER = 3 THEN 'QTC'\n      WHEN QUESTION_ORDER = 4 THEN 'GSO'\n      WHEN QUESTION_ORDER = 5 THEN 'VISITS'\n      ELSE\t'' END \tAS \"QUESTION_TYPE\",\n      CASE\n      WHEN QUESTION_ORDER = 0 THEN 'PRODUCT' \n      WHEN QUESTION_ORDER = 1 THEN 'OCV'\n      WHEN QUESTION_ORDER = 2 THEN 'Foco da Discuss√£o'\n      WHEN QUESTION_ORDER = 3 THEN 'Fechamento'\n      WHEN QUESTION_ORDER = 4 THEN 'GSO'\n      WHEN QUESTION_ORDER = 5 THEN 'Visitas'\n      ELSE '' END\tAS \"TIPO_QUESTAO\"\nFROM LATAMCRMFBICNTRYBRVW.D_SURVEY_QUESTION\nWHERE COUNTRY_CODE = 'BR' AND\nQUESTION_ORDER < 6 AND \nDELETED_IND = 0",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "QUESTION_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "QUESTION_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "QUESTION_CREATED_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "QUESTION_CREATED_DATE",
											"type": "DateTime",
											"physicalType": "DateTime"
										}
									},
									{
										"source": {
											"name": "QUESTION_NAME",
											"type": "String"
										},
										"sink": {
											"name": "QUESTION_NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "QUESTION_LAST_MODIFIED_TS",
											"type": "DateTime"
										},
										"sink": {
											"name": "QUESTION_LAST_MODIFIED_TS",
											"type": "DateTime",
											"physicalType": "DateTime"
										}
									},
									{
										"source": {
											"name": "QUESTION_TEXT",
											"type": "String"
										},
										"sink": {
											"name": "QUESTION_TEXT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "QUESTION_ORDER",
											"type": "Decimal"
										},
										"sink": {
											"name": "QUESTION_ORDER",
											"type": "Decimal",
											"physicalType": "Decimal"
										}
									},
									{
										"source": {
											"name": "QUESTION_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "QUESTION_TYPE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TIPO_QUESTAO",
											"type": "String"
										},
										"sink": {
											"name": "TIPO_QUESTAO",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "TeradataTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Arquivo_Em_TxT_3",
								"type": "DatasetReference",
								"parameters": {
									"pasta_nome_arquivo": "dim_survey_question.txt"
								}
							}
						]
					},
					{
						"name": "dim_sales_force_teradata",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "dim_survey_question",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "TeradataSource",
								"query": "SELECT RX_EXTERNAL_ID,\n      USER_ID,\n \t  SOURCE_USER_AID\t\t\t\t\t\t\t\t\t\tAS \"SF_SOURCE_USER_AID\",\n      USER_NAME,\n      FIRST_NAME,\n      NAME,\n      LAST_NAME,      \n      COUNTRY,\n      STATE_PROVINCE,\n      UPPER(CITY) \t\t\t\t\t\t\t\t\t\t\tAS \"CITY\",\n      POSTAL_CODE,\n      ACTIVE_IND,\n      EMAIL,\n      EMPLOYEE_NUMBER_AID,\n      USER_IDENTIFIER_AID,\n      CORE_GSK_FUNCTIONAL_PROFILE,\n      PROFILE_NAME\n FROM  LATAMCRMFBICNTRYBRVW.D_USER\nWHERE ACTIVE_IND = 1;\n ;",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "RX_EXTERNAL_ID",
											"type": "String"
										},
										"sink": {
											"name": "RX_EXTERNAL_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "USER_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "USER_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "SF_SOURCE_USER_AID",
											"type": "String"
										},
										"sink": {
											"name": "SF_SOURCE_USER_AID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "USER_NAME",
											"type": "String"
										},
										"sink": {
											"name": "USER_NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "FIRST_NAME",
											"type": "String"
										},
										"sink": {
											"name": "FIRST_NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NAME",
											"type": "String"
										},
										"sink": {
											"name": "NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "LAST_NAME",
											"type": "String"
										},
										"sink": {
											"name": "LAST_NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "COUNTRY",
											"type": "String"
										},
										"sink": {
											"name": "COUNTRY",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "STATE_PROVINCE",
											"type": "String"
										},
										"sink": {
											"name": "STATE_PROVINCE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CITY",
											"type": "String"
										},
										"sink": {
											"name": "CITY",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "POSTAL_CODE",
											"type": "String"
										},
										"sink": {
											"name": "POSTAL_CODE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ACTIVE_IND",
											"type": "String"
										},
										"sink": {
											"name": "ACTIVE_IND",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "EMAIL",
											"type": "String"
										},
										"sink": {
											"name": "EMAIL",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "EMPLOYEE_NUMBER_AID",
											"type": "String"
										},
										"sink": {
											"name": "EMPLOYEE_NUMBER_AID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "USER_IDENTIFIER_AID",
											"type": "String"
										},
										"sink": {
											"name": "USER_IDENTIFIER_AID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CORE_GSK_FUNCTIONAL_PROFILE",
											"type": "String"
										},
										"sink": {
											"name": "CORE_GSK_FUNCTIONAL_PROFILE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PROFILE_NAME",
											"type": "String"
										},
										"sink": {
											"name": "PROFILE_NAME",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "TeradataTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Arquivo_Em_TxT_3",
								"type": "DatasetReference",
								"parameters": {
									"pasta_nome_arquivo": "dim_sales_force_teradata.txt"
								}
							}
						]
					},
					{
						"name": "dim_sales_force_funcionario",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "dim_sales_force_teradata",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "select DISTINCT MUDID\tAS 'RX_EXTERNAL_ID',\n \t  UF\nfrom Dim_Cad_Funcionarios",
								"queryTimeout": "07:30:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "RX_EXTERNAL_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RX_EXTERNAL_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "UF",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UF",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServerGSK",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Arquivo_Em_TxT_3",
								"type": "DatasetReference",
								"parameters": {
									"pasta_nome_arquivo": "dim_sales_force_funcionario.txt"
								}
							}
						]
					},
					{
						"name": "dim_sales_force_sqlserver",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "dim_sales_force_funcionario",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"sqlReaderQuery": "SELECT \n     ROW_ID_FUNCIONARIO\t\t\t\t\t\t\t\t\t\tAS RX_EXTERNAL_ID,\n\t CICLO,\n     CICLO + '-' + ROW_ID_TERRITORIO\t\t\t\t\t\tAS SALES_FORCE_KEY,\n     CICLO + '-' + ROW_ID_TERRITORIO\t\t\t\t\t\tAS SF_KEY,\n\t ROW_ID_TERRITORIO,\n     ROW_ID_GD,\n     NOME_GD,\n     NOME_GR,\n\t CASE\n     WHEN Len(COALESCE(TERRITORIO_GD,'0123456789')) = 0 THEN TERRITORIO_GD\n     ELSE Right(TERRITORIO_GD, 6) END AS TERRITORIO_GD,\n\t CASE\n\t WHEN Len(COALESCE(TERRITORIO_GR,'0123456789')) = 0 THEN TERRITORIO_GR\n     ELSE Right(TERRITORIO_GR, 6)END AS TERRITORIO_GR,\n     BU,\n     CASE\n\t WHEN DIVIS√ÉO = 'REDES' THEN 'REDES DIRETAS'\n     ELSE DIVIS√ÉO END  AS DIVIS√ÉO,\n     CASE\n\t WHEN Len(COALESCE(TERRITORIO,'0123456789')) = 0 THEN TERRITORIO\n     ELSE Right(TERRITORIO, 6) END AS TERRITORIO,\n\t NOME_REPRESENTANTE\t\t\t\t\t\t\t\t\t\tAS NOME_REP        \nFROM Dim_Cad_Forca_Vendas\nWHERE STATUS = 'A'\n  AND CICLO >= '201901'\n  AND (BU = 'FARMA' OR BU = 'BIOTECH');",
								"queryTimeout": "07:30:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "RX_EXTERNAL_ID",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "RX_EXTERNAL_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CICLO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "CICLO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "SALES_FORCE_KEY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SALES_FORCE_KEY",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "SF_KEY",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "SF_KEY",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ROW_ID_TERRITORIO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ROW_ID_TERRITORIO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ROW_ID_GD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ROW_ID_GD",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NOME_GD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOME_GD",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NOME_GR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOME_GR",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TERRITORIO_GD",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TERRITORIO_GD",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TERRITORIO_GR",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TERRITORIO_GR",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "BU",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "BU",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "DIVIS√ÉO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DIVIS√ÉO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "TERRITORIO",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "TERRITORIO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NOME_REP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "NOME_REP",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SqlServerGSK",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Arquivo_Em_TxT_3",
								"type": "DatasetReference",
								"parameters": {
									"pasta_nome_arquivo": "dim_sales_force_sqlserver.txt"
								}
							}
						]
					},
					{
						"name": "fato_gso_call_summary",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "fato_gso_response",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "TeradataSource",
								"query": "SELECT \n\t\"CM\".CALL_SUMMARY_ID,\n\t \"CM\".PARENT_CALL_AID,\n\t \"CM\".LOCAL_CALL_DATE_ID,\n\t \"CM\".CALL_DATE_ID,\n\t \"CM\".TERRITORY_ID,\n\t LEFT(CAST(\"CM\".CALL_DATE_ID as CHAR(8)),6) \t\tAS \"CYCLE\",\n\t ((LEFT(CAST(\"CM\".CALL_DATE_ID as CHAR(8)),6)||'-')||\"CM\".TERRITORY_ID)\tAS \"SALES_FORCE_KEY\",\n\t LEFT(CAST(\"CM\".CALL_DATE_ID as CHAR(8)),6)\tAS \"DATE\",\n\t \"CM\".LOCAL_CALL_TIME_ID,\n\t \"CM\".ACCOUNT_ID,\n\t \"CM\".CALL_NAME,\n\t \"CM\".RX_CALL_TYPE,\n\t \"CM\".CALL_STATUS,\n\t \"CM\".ATTENDEE_TYPE,\n\t \"CM\".CLM_IND,\n\t \"CM\".SAMPLE_CALL_IND,\n\t \"CM\".CALL_TYPE,\n\t \"CM\".DETAILED_PRODUCTS,\n\t \"CM\".DURATION,\n\t \"CM\".CREATED_DATE_ID,\n\t \"CM\".CREATED_DATE_TIME_ID,\n\t \"CM\".LAST_MODIFIED_DATE_ID,\n\t \"CM\".LAST_MODIFIED_DATE_TIME_ID,\n\t \"CM\".PRE_CALL_NOTES,\n\t \"CM\".NEXT_CALL_NOTES,\n\t 'Completed_vod'\t\t\t\t\t\t\t\t\t\tAS \"REVIEW_STATUS\",\n\t \"AC\".ACCOUNT_NAME,\n\t \"AC\".RX_LEGAL_ID,\n\t \"KEY\".KEY_MESSAGE_NAME,\n\t \"KEY\".QUESTION_ID,\n\t COALESCE(\"KEY\".PRODUCT_NAME,'NOT INFORMED') AS \"PRODUCT\",\n\t \"KEY\".CALL_DATE,\n\t 'CALLS'\t\t\t\tAS \"ORIGEM\"\n\nFROM  \n\tLATAMCRMFBICNTRYBRVW.F_CALL_SUMMARY \"CM\"\n\nLEFT JOIN (\n\t\t\tSELECT \n\t\t\t\tACCOUNT_ID,\n\t \t\t\tNAME AS \"ACCOUNT_NAME\",\n     \t\t\tRX_LEGAL_ID\n\t\t\tFROM \n\t\t\t\tLATAMCRMFBICNTRYBRVW.D_ACCOUNT\n\t\t\tWHERE\n\t\t\t\tCOUNTRY_CODE = 'BR'\n  \t\t\t\tAND DELETED_IND = 0\n  \t\t\t) as \"AC\" ON \"CM\".ACCOUNT_ID = \"AC\".ACCOUNT_ID\n\nLEFT JOIN (\n\t\t\tSELECT\n\t\t\t\t\"CM\".CALL_SUMMARY_ID,\n\t\t\t\t\"KM\".KEY_MESSAGE_NAME,\n\t\t\t\tCASE\n\t\t\t\tWHEN \"KM\".KEY_MESSAGE_NAME = 'Tentativa de GSO - Expositiva' THEN '12209'\n\t\t\t    WHEN \"KM\".KEY_MESSAGE_NAME = 'Tentativa de GSO - Interativa' THEN '12213'\n\t\t\t    WHEN \"KM\".KEY_MESSAGE_NAME = 'Lembran√ßa da marca' THEN '12210'\n\t\t\t    WHEN \"KM\".KEY_MESSAGE_NAME = 'Good Sell Outcome (GSO)' THEN '12212'\n\t\t\t    ELSE \"KM\".KEY_MESSAGE_NAME END AS \"QUESTION_ID\",\n\t\t\t    \"PC\".PRODUCT_NAME,\n\t\t\t    \"CM\".CALL_DATE_ID as \"CALL_DATE\",\n\t\t\t    \"CM\".TERRITORY_ID  \n\t\t\t\n\t\t\tFROM \n\t\t\t\tLATAMCRMFBICNTRYBRVW.F_CALL_MESSAGE as \"CM\"\n\n\t\t\tLEFT JOIN (\n\t\t\t\t\t\tSELECT DISTINCT\n\t\t\t\t\t\t    KEY_MESSAGE_ID \tas \"MESSAGE_ID\",\n\t\t\t\t\t\t    KEY_MESSAGE_ID,\n\t\t\t\t\t\t    KEY_MESSAGE_NAME\n\t\t\t\t\t\t\n\t\t\t\t\t\tFROM \n\t\t\t\t\t\t\tLATAMCRMFBICNTRYBRVW.D_KEY_MESSAGE\n\t\t\t\t\t\tWHERE \t\n\t\t\t\t\t\t\t(KEY_MESSAGE_NAME = 'Visita n√£o promocional' OR\n\t\t\t\t\t\t\t KEY_MESSAGE_NAME = 'Lembran√ßa da marca' OR\n\t\t\t\t\t\t     KEY_MESSAGE_NAME LIKE '*GSO*')\n\t\t\t\t\t \t) AS \"KM\" ON \"CM\".KEY_MESSAGE_ID = \"KM\".KEY_MESSAGE_ID\n        \n\t\t\tLEFT JOIN (\n\t\t\t\t\t\tSELECT \n\t\t\t\t\t\t\tPRODUCT_CATALOG_ID,\n\t\t\t\t \t\t\tPRODUCT_NAME\n\t\t\t\t\t\tFROM \n\t\t\t\t\t\tLATAMCRMFBICNTRYBRVW.D_PRODUCT_CATALOG\n\t\t\t\t\t  ) AS \"PC\" ON \"CM\".PRODUCT_CATALOG_ID = \"PC\".PRODUCT_CATALOG_ID\n\t\t\t\t\t\t\n\t\t\t\n\t\t\t\t\t\tWHERE \n\t\t\t\t\t\t(EXISTS (\n\t\t\t\t\t\t\t\t\tSELECT DISTINCT\n\t\t\t\t\t\t\t\t\t    KEY_MESSAGE_ID \tas \"MESSAGE_ID\",\n\t\t\t\t\t\t\t\t\t    KEY_MESSAGE_ID,\n\t\t\t\t\t\t\t\t\t    KEY_MESSAGE_NAME\n\t\t\t\t\t\t\t\t\tFROM \n\t\t\t\t\t\t\t\t\t\tLATAMCRMFBICNTRYBRVW.D_KEY_MESSAGE\n\t\t\t\t\t\t\t\t\tWHERE \t\n\t\t\t\t\t\t\t\t\t\t(KEY_MESSAGE_NAME = 'Visita n√£o promocional' OR\n\t\t\t\t\t\t\t\t\t\t KEY_MESSAGE_NAME = 'Lembran√ßa da marca' OR\n\t\t\t\t\t\t\t\t\t     KEY_MESSAGE_NAME LIKE '*GSO*')\n\t\t\t\t\t\t\t\t\t     AND KEY_MESSAGE_ID = \"CM\".KEY_MESSAGE_ID)\n\t\t\t\t\t\t\t\t) \n\t\t\t\t\t\tAND\n\t\t\t\t\t\t(EXISTS (\n\t\t\t\t\t\t\t\t\tSELECT \n\t\t\t\t\t\t\t\t\t\tPRODUCT_CATALOG_ID,\n\t\t\t\t\t\t\t \t\t\tPRODUCT_NAME\n\t\t\t\t\t\t\t\t\tFROM \n\t\t\t\t\t\t\t\t\t\tLATAMCRMFBICNTRYBRVW.D_PRODUCT_CATALOG\n\t\t\t\t\t\t      \t\tWHERE PRODUCT_CATALOG_ID =\t\"CM\".PRODUCT_CATALOG_ID)\n\t\t\t\t\t\t \t\t)\n\t\t\t\t\t\t AND\n\t\t\t\t\t\t LEFT(CAST(CALL_DATE_ID as CHAR(8)),6) > '201901'\n\t\t) AS \"KEY\" ON \"CM\".CALL_SUMMARY_ID = \"KEY\".CALL_SUMMARY_ID\n  \nWHERE \n\tLEFT(CAST(\"CM\".CALL_DATE_ID as CHAR(8)),6)>= '201901' AND\n\t\"CM\".COUNTRY_CODE = 'BR' AND \n  \t\"CM\".CALL_STATUS = 'Submitted_vod' AND \n  \t\"CM\".DELETED_IND = 0;",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 16,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "CALL_SUMMARY_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "CALL_SUMMARY_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "PARENT_CALL_AID",
											"type": "String"
										},
										"sink": {
											"name": "PARENT_CALL_AID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "LOCAL_CALL_DATE_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "LOCAL_CALL_DATE_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "CALL_DATE_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "CALL_DATE_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "TERRITORY_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "TERRITORY_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "CYCLE",
											"type": "String"
										},
										"sink": {
											"name": "CYCLE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "SALES_FORCE_KEY",
											"type": "String"
										},
										"sink": {
											"name": "SALES_FORCE_KEY",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "DATE",
											"type": "String"
										},
										"sink": {
											"name": "DATE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "LOCAL_CALL_TIME_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "LOCAL_CALL_TIME_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "ACCOUNT_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "CALL_NAME",
											"type": "String"
										},
										"sink": {
											"name": "CALL_NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "RX_CALL_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "RX_CALL_TYPE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CALL_STATUS",
											"type": "String"
										},
										"sink": {
											"name": "CALL_STATUS",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ATTENDEE_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "ATTENDEE_TYPE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CLM_IND",
											"type": "String"
										},
										"sink": {
											"name": "CLM_IND",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "SAMPLE_CALL_IND",
											"type": "String"
										},
										"sink": {
											"name": "SAMPLE_CALL_IND",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CALL_TYPE",
											"type": "String"
										},
										"sink": {
											"name": "CALL_TYPE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "DETAILED_PRODUCTS",
											"type": "String"
										},
										"sink": {
											"name": "DETAILED_PRODUCTS",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "DURATION",
											"type": "Decimal"
										},
										"sink": {
											"name": "DURATION",
											"type": "Decimal",
											"physicalType": "Decimal"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "CREATED_DATE_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "CREATED_DATE_TIME_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "CREATED_DATE_TIME_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "LAST_MODIFIED_DATE_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "LAST_MODIFIED_DATE_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "LAST_MODIFIED_DATE_TIME_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "LAST_MODIFIED_DATE_TIME_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "PRE_CALL_NOTES",
											"type": "String"
										},
										"sink": {
											"name": "PRE_CALL_NOTES",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "NEXT_CALL_NOTES",
											"type": "String"
										},
										"sink": {
											"name": "NEXT_CALL_NOTES",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "REVIEW_STATUS",
											"type": "String"
										},
										"sink": {
											"name": "REVIEW_STATUS",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ACCOUNT_NAME",
											"type": "String"
										},
										"sink": {
											"name": "ACCOUNT_NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "RX_LEGAL_ID",
											"type": "String"
										},
										"sink": {
											"name": "RX_LEGAL_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "KEY_MESSAGE_NAME",
											"type": "String"
										},
										"sink": {
											"name": "KEY_MESSAGE_NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "QUESTION_ID",
											"type": "String"
										},
										"sink": {
											"name": "QUESTION_ID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PRODUCT",
											"type": "String"
										},
										"sink": {
											"name": "PRODUCT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "CALL_DATE",
											"type": "Int32"
										},
										"sink": {
											"name": "CALL_DATE",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "ORIGEM",
											"type": "String"
										},
										"sink": {
											"name": "ORIGEM",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "TeradataTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Arquivo_Em_TxT_3",
								"type": "DatasetReference",
								"parameters": {
									"pasta_nome_arquivo": "fato_gso_call_summary.txt"
								}
							}
						]
					},
					{
						"name": "fato_gso_response",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "dim_sales_force_sqlserver",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "TeradataSource",
								"query": "SELECT \n\t\"P\".SURVEY_TARGET_ID \t\t\t\t\tAS \"SURVEY_KEY\",\n    \"P\".QUESTION_ID,\t\t\t\t\t\n    \"P\".SOURCE_CREATED_TS,\n    \"P\".SOURCE_LAST_MODIFIED_TS\t\t\tAS \"RESPONSE_LAST_MODIFIED_TS\",\n    \"P\".SOURCE_CREATED_BY_AID AS \"SOURCE_USER_AID\",\n    \"P\".QUESTION_RESPONSE_ID,          \n    \"P\".RESPONSE_NAME,\n    \"P\".RESPONSE_NUMBER,\n    \"P\".RESPONSE,\n    COALESCE(\"PRD\".SURVEY_KEY,'NOT INFORMED') AS \"PRODUCT\",\n    \"P\".QUESTION_ORDER\t\t\t\tAS \"RESPONSE_QUESTION_ORDER\",\n\t\"ST\".\"DATE\",\n\t\"ST\".TARGET_LAST_MODIFIED_TS,\n\t\"ST\".MODIFIED_DATE,\n\t\"ST\".START_DATE_ID,\n\t\"ST\".END_DATE_ID,\n\t\"ST\".REVIEW_DATE_ID,\n\t\"ST\".REVIEW_STATUS,\n\t\"ST\".MANAGER_TERRITORY_ID,\n\t\"ST\".EMPLOYEE_TERRITORY_ID,\n\t\"ST\".TERRITORY_ID,\n \t(\"ST\".MODIFIED_DATE - \"ST\".\"DATE\" ) AS \"DATE_DIFF\",\n \tCASE\n \tWHEN (\"ST\".MODIFIED_DATE - ADD_MONTHS(\"ST\".\"DATE\" - EXTRACT(DAY FROM \"ST\".\"DATE\")+1,6)) > 7 THEN 'N'\n \tELSE 'S' END AS \"FLAG_PREMIO\",\n \tLEFT(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)),6)||'-'||TRIM(\"ST\".EMPLOYEE_TERRITORY_ID) AS \"SALES_FORCE_KEY\",\n \tLEFT(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)),6)||'-'||TRIM(\"ST\".EMPLOYEE_TERRITORY_ID) AS \"RESPONSES_KEY\",\n\t'SURVEYS'\t\t\t\tAS \"ORIGEM\"\n    \n FROM LATAMCRMFBICNTRYBRVW.F_SURVEY_RESPONSES AS \"P\"\n \n LEFT JOIN (SELECT DISTINCT\n\t\"P\".SURVEY_TARGET_ID \t\t\t\t\tAS \"SURVEY_KEY\",\n    \"P\".RESPONSE\n FROM LATAMCRMFBICNTRYBRVW.F_SURVEY_RESPONSES AS \"P\"\n WHERE \"P\".QUESTION_ORDER = 0  AND \"P\".RESPONSE IS NOT NULL) AS \"PRD\" ON \"P\".SURVEY_TARGET_ID = \"PRD\".SURVEY_KEY\n \n INNER JOIN (SELECT \n\t  \"ST\".SURVEY_TARGET_ID as \"SURVEY_KEY\",\n\t  CAST(TRIM(CAST(LEFT(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)),4)||'-'||\n\t  SUBSTRING(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)) FROM 5 FOR 2) ||'-'||\n\t  RIGHT(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)),2) AS VARCHAR(10))) AS DATE FORMAT 'yyyy-mm-dd') AS \"DATE\",\n\t  \"ST\".SOURCE_LAST_MODIFIED_TS as \"TARGET_LAST_MODIFIED_TS\",\n\t  CAST(\"ST\".SOURCE_LAST_MODIFIED_TS AS DATE FORMAT 'YYYYMMDD') AS \"MODIFIED_DATE\",\n\t  \"ST\".START_DATE_ID,\n\t  \"ST\".END_DATE_ID,\n\t  \"ST\".REVIEW_DATE_ID,\n\t  \"ST\".REVIEW_STATUS,\n\t  \"ST\".MANAGER_TERRITORY_ID,\n\t  \"ST\".EMPLOYEE_TERRITORY_ID,\n\t  \"ST\".TERRITORY_ID\nFROM LATAMCRMFBICNTRYBRVW.F_SURVEY_TARGETS AS \"ST\"\nWHERE \"ST\".COUNTRY_CODE = 'BR'  AND \n\t\"ST\".SURVEY_TARGET_NAME LIKE '%GSO U%' AND\n\tLEFT(CAST(\"ST\".REVIEW_DATE_ID AS CHAR(8)),6) > '201901') AS \"ST\" ON \"P\".SURVEY_TARGET_ID = \"ST\".SURVEY_KEY;",
								"partitionOption": "None"
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"dataIntegrationUnits": 16,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "SURVEY_KEY",
											"type": "Int32"
										},
										"sink": {
											"name": "SURVEY_KEY",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "QUESTION_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "QUESTION_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "SOURCE_CREATED_TS",
											"type": "DateTime"
										},
										"sink": {
											"name": "SOURCE_CREATED_TS",
											"type": "DateTime",
											"physicalType": "DateTime"
										}
									},
									{
										"source": {
											"name": "RESPONSE_LAST_MODIFIED_TS",
											"type": "DateTime"
										},
										"sink": {
											"name": "RESPONSE_LAST_MODIFIED_TS",
											"type": "DateTime",
											"physicalType": "DateTime"
										}
									},
									{
										"source": {
											"name": "SOURCE_USER_AID",
											"type": "String"
										},
										"sink": {
											"name": "SOURCE_USER_AID",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "QUESTION_RESPONSE_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "QUESTION_RESPONSE_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "RESPONSE_NAME",
											"type": "String"
										},
										"sink": {
											"name": "RESPONSE_NAME",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "RESPONSE_NUMBER",
											"type": "Int32"
										},
										"sink": {
											"name": "RESPONSE_NUMBER",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "RESPONSE",
											"type": "String"
										},
										"sink": {
											"name": "RESPONSE",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "PRODUCT",
											"type": "String"
										},
										"sink": {
											"name": "PRODUCT",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "RESPONSE_QUESTION_ORDER",
											"type": "Decimal"
										},
										"sink": {
											"name": "RESPONSE_QUESTION_ORDER",
											"type": "Decimal",
											"physicalType": "Decimal"
										}
									},
									{
										"source": {
											"name": "DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "DATE",
											"type": "DateTime",
											"physicalType": "DateTime"
										}
									},
									{
										"source": {
											"name": "TARGET_LAST_MODIFIED_TS",
											"type": "DateTime"
										},
										"sink": {
											"name": "TARGET_LAST_MODIFIED_TS",
											"type": "DateTime",
											"physicalType": "DateTime"
										}
									},
									{
										"source": {
											"name": "MODIFIED_DATE",
											"type": "DateTime"
										},
										"sink": {
											"name": "MODIFIED_DATE",
											"type": "DateTime",
											"physicalType": "DateTime"
										}
									},
									{
										"source": {
											"name": "START_DATE_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "START_DATE_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "END_DATE_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "END_DATE_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "REVIEW_DATE_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "REVIEW_DATE_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "REVIEW_STATUS",
											"type": "String"
										},
										"sink": {
											"name": "REVIEW_STATUS",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "MANAGER_TERRITORY_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "MANAGER_TERRITORY_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "EMPLOYEE_TERRITORY_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "EMPLOYEE_TERRITORY_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "TERRITORY_ID",
											"type": "Int32"
										},
										"sink": {
											"name": "TERRITORY_ID",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "DATE_DIFF",
											"type": "Int32"
										},
										"sink": {
											"name": "DATE_DIFF",
											"type": "Int32",
											"physicalType": "Int32"
										}
									},
									{
										"source": {
											"name": "FLAG_PREMIO",
											"type": "String"
										},
										"sink": {
											"name": "FLAG_PREMIO",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "SALES_FORCE_KEY",
											"type": "String"
										},
										"sink": {
											"name": "SALES_FORCE_KEY",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "RESPONSES_KEY",
											"type": "String"
										},
										"sink": {
											"name": "RESPONSES_KEY",
											"type": "String",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "ORIGEM",
											"type": "String"
										},
										"sink": {
											"name": "ORIGEM",
											"type": "String",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "TeradataTable1",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Arquivo_Em_TxT_3",
								"type": "DatasetReference",
								"parameters": {
									"pasta_nome_arquivo": "fato_gso_response.txt"
								}
							}
						]
					}
				],
				"folder": {
					"name": "Extract"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/TeradataTable1')]",
				"[concat(variables('workspaceId'), '/datasets/Arquivo_Em_TxT_3')]",
				"[concat(variables('workspaceId'), '/datasets/SqlServerGSK')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/3 - Transform - GSO')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Lista_Arquivos",
						"type": "GetMetadata",
						"dependsOn": [
							{
								"activity": "TranformRegionTxt",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Listar_Arquivos_Txt_3",
								"type": "DatasetReference",
								"parameters": {}
							},
							"fieldList": [
								"childItems"
							],
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"enablePartitionDiscovery": false
							},
							"formatSettings": {
								"type": "DelimitedTextReadSettings"
							}
						}
					},
					{
						"name": "Filtra_Arquivos_TXT",
						"type": "Filter",
						"dependsOn": [
							{
								"activity": "Lista_Arquivos",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Lista_Arquivos').output.childitems",
								"type": "Expression"
							},
							"condition": {
								"value": "@contains(item().name,'.txt')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Para_Cada_TXT",
						"type": "ForEach",
						"dependsOn": [
							{
								"activity": "Filtra_Arquivos_TXT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"items": {
								"value": "@activity('Filtra_Arquivos_TXT').output.Value",
								"type": "Expression"
							},
							"isSequential": true,
							"activities": [
								{
									"name": "Transforma_TXT_to_Parquet",
									"type": "Copy",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "DelimitedTextSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true,
												"wildcardFolderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.gso",
												"wildcardFileName": {
													"value": "@{item().name}",
													"type": "Expression"
												}
											},
											"formatSettings": {
												"type": "DelimitedTextReadSettings"
											}
										},
										"sink": {
											"type": "ParquetSink",
											"storeSettings": {
												"type": "AzureBlobStorageWriteSettings"
											},
											"formatSettings": {
												"type": "ParquetWriteSettings"
											}
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "Listar_Arquivos_Txt_3",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "Arquivos_Em_Parquet_3",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								}
							]
						}
					},
					{
						"name": "Deletar_Arquivos_TXT",
						"type": "Delete",
						"dependsOn": [
							{
								"activity": "Para_Cada_TXT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataset": {
								"referenceName": "Listar_Arquivos_Txt_3",
								"type": "DatasetReference",
								"parameters": {}
							},
							"enableLogging": false,
							"storeSettings": {
								"type": "AzureBlobStorageReadSettings",
								"recursive": true,
								"wildcardFileName": "*.txt"
							}
						}
					},
					{
						"name": "GSO_ETL",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "Deletar_Arquivos_TXT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "GSO_ETL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"fGsoCallSummarySource": {},
									"fGsoResponseSource": {},
									"dSalesForceTeradata": {},
									"dSalesForceFuncionario": {},
									"dSalesForceSqlServer": {},
									"dSalesForceRegiao": {},
									"dSurveyQuestion": {},
									"dVisits": {},
									"FatoGsoDestino": {},
									"SalesForceDestino": {},
									"SinkDimSurveyQuestion": {},
									"SinkDimVisits": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Coarse"
						}
					},
					{
						"name": "TranformRegionTxt",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "DelimitedTextSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "DelimitedTextWriteSettings",
									"quoteAllText": true,
									"fileExtension": ".txt"
								}
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "BRASIL.Area",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AREA",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Outlet State",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "UF",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "Regiao",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "REGION",
											"physicalType": "String"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "STATE",
											"physicalType": "String"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Fact_GSO_Aux_Regiao",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "Arquivo_Em_TxT_3",
								"type": "DatasetReference",
								"parameters": {
									"pasta_nome_arquivo": "dim_region.txt"
								}
							}
						]
					}
				],
				"folder": {
					"name": "Transform"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Listar_Arquivos_Txt_3')]",
				"[concat(variables('workspaceId'), '/dataflows/GSO_ETL')]",
				"[concat(variables('workspaceId'), '/datasets/Fact_GSO_Aux_Regiao')]",
				"[concat(variables('workspaceId'), '/datasets/Arquivo_Em_TxT_3')]",
				"[concat(variables('workspaceId'), '/datasets/Arquivos_Em_Parquet_3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CopyPipeline_uhq')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy_uhq",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "EMAIL 1-1/FILES/dim_audit_end.txt"
							},
							{
								"name": "Destination",
								"value": "gsksynapsestorage/synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_audit_end.parquet"
							}
						],
						"typeProperties": {
							"source": {
								"type": "DelimitedTextSource",
								"storeSettings": {
									"type": "FileServerReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								},
								"formatSettings": {
									"type": "DelimitedTextReadSettings",
									"skipLineCount": 0
								}
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								},
								"formatSettings": {
									"type": "ParquetWriteSettings"
								}
							},
							"enableStaging": false,
							"validateDataConsistency": false
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_uhq",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_uhq",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2020-12-16T21:57:23Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/SourceDataset_uhq')]",
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_uhq')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/temp')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "KPI_ETL",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "KPI_ETL",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"DimTopIndependentes": {},
									"DimPainelMedico": {},
									"FatoVisitasRealizadas": {},
									"SinkDimPainelMedico": {},
									"SinkFatoVisitasRealizadas": {}
								}
							},
							"staging": {},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"folder": {
					"name": "ISOLATION"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/dataflows/KPI_ETL')]",
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Arquivo_Em_TxT_1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CompressArquivoSave",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"nome_arquivo": {
						"type": "string"
					},
					"pasta": {
						"type": "string"
					}
				},
				"folder": {
					"name": "1 - Email 1-1"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().nome_arquivo",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@concat('synapse/workspaces/gsk-synapse/warehouse/',dataset().pasta)",
							"type": "Expression"
						},
						"fileSystem": "gsksynapsestorage"
					},
					"columnDelimiter": "$",
					"compressionCodec": "bzip2",
					"compressionLevel": "Fastest",
					"encodingName": "ISO-8859-1",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/CompressArquivoSave')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Arquivo_Em_TxT_2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CompressArquivoSave",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"nome_arquivo": {
						"type": "string"
					},
					"pasta": {
						"type": "string"
					}
				},
				"folder": {
					"name": "2 - KPI Visitacao"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().nome_arquivo",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@concat('synapse/workspaces/gsk-synapse/warehouse/',dataset().pasta)",
							"type": "Expression"
						},
						"fileSystem": "gsksynapsestorage"
					},
					"columnDelimiter": "~",
					"compressionCodec": "ZipDeflate",
					"encodingName": "ISO-8859-1",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/CompressArquivoSave')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Arquivo_Em_TxT_3')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorageBlobSynapse",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"pasta_nome_arquivo": {
						"type": "string"
					}
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().pasta_nome_arquivo",
							"type": "Expression"
						},
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.gso",
						"container": "gsksynapsestorage"
					},
					"columnDelimiter": "\t",
					"encodingName": "ISO-8859-1",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureDataLakeStorageBlobSynapse')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Arquivos_Em_Parquet_1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Arquivos_Em_Parquet_3",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"nome_arquivo": {
						"type": "string"
					}
				},
				"folder": {
					"name": "1 - Email 1-1"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().nome_arquivo",
							"type": "Expression"
						},
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.email1to1",
						"container": "gsksynapsestorage"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Arquivos_Em_Parquet_3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Arquivos_Em_Parquet_2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Arquivos_Em_Parquet_3",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"nome_arquivo": {
						"type": "string"
					}
				},
				"folder": {
					"name": "2 - KPI Visitacao"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": {
							"value": "@dataset().nome_arquivo",
							"type": "Expression"
						},
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao",
						"container": "gsksynapsestorage"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Arquivos_Em_Parquet_3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Arquivos_Em_Parquet_3')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Arquivos_Em_Parquet_3",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.gso",
						"container": "gsksynapsestorage"
					},
					"compressionCodec": "gzip"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Arquivos_Em_Parquet_3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DelimitedText1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "GSK_Pulmonar_PF_Datasus.txt.bz2",
						"folderPath": "dev",
						"fileSystem": "gsksynapsestorage"
					},
					"columnDelimiter": ";",
					"compressionCodec": "bzip2",
					"compressionLevel": "Fastest",
					"encodingName": "ISO-8859-1",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "PRODUTO_DESC",
						"type": "String"
					},
					{
						"name": "MUNICIPIO",
						"type": "String"
					},
					{
						"name": "UF",
						"type": "String"
					},
					{
						"name": "FANTASIA",
						"type": "String"
					},
					{
						"name": "NR_CNPJ",
						"type": "String"
					},
					{
						"name": "CNES",
						"type": "String"
					},
					{
						"name": "CID",
						"type": "String"
					},
					{
						"name": "QTDE_INICIAL_PACIENTES",
						"type": "String"
					},
					{
						"name": "MS_INICIAL_PACIENTES",
						"type": "String"
					},
					{
						"name": "QTDE_PACIENTES_NOVOS",
						"type": "String"
					},
					{
						"name": "QTDE_PACIENTES_RETORNO_MESMA",
						"type": "String"
					},
					{
						"name": "QTDE_PACIENTES_RETORNO_OUTRA",
						"type": "String"
					},
					{
						"name": "QTDE_PACIENTES_VIERAM",
						"type": "String"
					},
					{
						"name": "QTDE_PACIENTES_FORAM",
						"type": "String"
					},
					{
						"name": "QTDE_PACIENTES_DELTA",
						"type": "String"
					},
					{
						"name": "QTDE_PACIENTES_SAIRAM",
						"type": "String"
					},
					{
						"name": "QTDE_MOVIMENTACAO",
						"type": "String"
					},
					{
						"name": "QTDE_FINAL_PACIENTES",
						"type": "String"
					},
					{
						"name": "MS_FINAL_PACIENTES",
						"type": "String"
					},
					{
						"name": "PP",
						"type": "String"
					},
					{
						"name": "DT_PERIODO_INICIAL",
						"type": "String"
					},
					{
						"name": "DT_PERIODO_FINAL",
						"type": "String"
					},
					{
						"name": "QTDE_PACIENTES_CONTINUAM",
						"type": "String"
					},
					{
						"name": "MERCADO",
						"type": "String"
					},
					{
						"name": "TERRITORIO",
						"type": "String"
					},
					{
						"name": "GD",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_uhq')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorageSynapse",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"fileName": "dim_audit_end.parquet",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.email1to1",
						"container": "gsksynapsestorage"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureBlobStorageSynapse')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Dim_Email_1_1_Parquet')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "1 - Email 1-1"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.email1to1",
						"fileSystem": "gsksynapsestorage"
					},
					"compressionCodec": "gzip"
				},
				"schema": [
					{
						"name": "ID",
						"type": "UTF8"
					},
					{
						"name": "CRM_UNIV",
						"type": "UTF8"
					},
					{
						"name": "MEDICO_UNIV",
						"type": "UTF8"
					},
					{
						"name": "ESPECIALIDADE_UNIV",
						"type": "UTF8"
					},
					{
						"name": "LOGRADOURO_UNIV",
						"type": "UTF8"
					},
					{
						"name": "BAIRRO_UNIV",
						"type": "UTF8"
					},
					{
						"name": "CIDADE_UNIV",
						"type": "UTF8"
					},
					{
						"name": "CEP_UNIV",
						"type": "UTF8"
					},
					{
						"name": "ORIGEM_UNIV",
						"type": "UTF8"
					},
					{
						"name": "UF_UNIV",
						"type": "UTF8"
					},
					{
						"name": "BRICK_UNIV",
						"type": "UTF8"
					},
					{
						"name": "TELEFONE_UNIV",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Dim_KPI_Vis_Parquet')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "2 - KPI Visitacao"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao",
						"fileSystem": "gsksynapsestorage"
					},
					"compressionCodec": "gzip"
				},
				"schema": [
					{
						"name": "ID",
						"type": "UTF8"
					},
					{
						"name": "CRM_UNIV",
						"type": "UTF8"
					},
					{
						"name": "MEDICO_UNIV",
						"type": "UTF8"
					},
					{
						"name": "ESPECIALIDADE_UNIV",
						"type": "UTF8"
					},
					{
						"name": "LOGRADOURO_UNIV",
						"type": "UTF8"
					},
					{
						"name": "BAIRRO_UNIV",
						"type": "UTF8"
					},
					{
						"name": "CIDADE_UNIV",
						"type": "UTF8"
					},
					{
						"name": "CEP_UNIV",
						"type": "UTF8"
					},
					{
						"name": "ORIGEM_UNIV",
						"type": "UTF8"
					},
					{
						"name": "UF_UNIV",
						"type": "UTF8"
					},
					{
						"name": "BRICK_UNIV",
						"type": "UTF8"
					},
					{
						"name": "TELEFONE_UNIV",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Fact_Email_e_KPI_Data_Flow')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorageSynapse",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.email1to1",
						"container": "gsksynapsestorage"
					},
					"compressionCodec": "gzip"
				},
				"schema": [
					{
						"name": "CALL_SUMMARY_ID",
						"type": "UTF8"
					},
					{
						"name": "PARENT_CALL_AID",
						"type": "UTF8"
					},
					{
						"name": "LOCAL_CALL_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "CALL_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "TERRITORY_ID",
						"type": "UTF8"
					},
					{
						"name": "CYCLE",
						"type": "UTF8"
					},
					{
						"name": "SALES_FORCE_KEY",
						"type": "UTF8"
					},
					{
						"name": "DATE",
						"type": "UTF8"
					},
					{
						"name": "LOCAL_CALL_TIME_ID",
						"type": "UTF8"
					},
					{
						"name": "ACCOUNT_ID",
						"type": "UTF8"
					},
					{
						"name": "CALL_NAME",
						"type": "UTF8"
					},
					{
						"name": "RX_CALL_TYPE",
						"type": "UTF8"
					},
					{
						"name": "CALL_STATUS",
						"type": "UTF8"
					},
					{
						"name": "ATTENDEE_TYPE",
						"type": "UTF8"
					},
					{
						"name": "CLM_IND",
						"type": "UTF8"
					},
					{
						"name": "SAMPLE_CALL_IND",
						"type": "UTF8"
					},
					{
						"name": "CALL_TYPE",
						"type": "UTF8"
					},
					{
						"name": "DETAILED_PRODUCTS",
						"type": "UTF8"
					},
					{
						"name": "DURATION",
						"type": "UTF8"
					},
					{
						"name": "CREATED_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "CREATED_DATE_TIME_ID",
						"type": "UTF8"
					},
					{
						"name": "LAST_MODIFIED_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "LAST_MODIFIED_DATE_TIME_ID",
						"type": "UTF8"
					},
					{
						"name": "PRE_CALL_NOTES",
						"type": "UTF8"
					},
					{
						"name": "NEXT_CALL_NOTES",
						"type": "UTF8"
					},
					{
						"name": "REVIEW_STATUS",
						"type": "UTF8"
					},
					{
						"name": "ACCOUNT_NAME",
						"type": "UTF8"
					},
					{
						"name": "RX_LEGAL_ID",
						"type": "UTF8"
					},
					{
						"name": "KEY_MESSAGE_NAME",
						"type": "UTF8"
					},
					{
						"name": "QUESTION_ID",
						"type": "UTF8"
					},
					{
						"name": "PRODUCT",
						"type": "UTF8"
					},
					{
						"name": "CALL_DATE",
						"type": "UTF8"
					},
					{
						"name": "ORIGEM",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureBlobStorageSynapse')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Fact_GSO_Aux_Regiao')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Sheet1",
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "area.xlsx",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/aux.tabelas_auxiliares",
						"fileSystem": "gsksynapsestorage"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "BRASIL.Area",
						"type": "String"
					},
					{
						"name": "Outlet State",
						"type": "String"
					},
					{
						"name": "Regiao",
						"type": "String"
					},
					{
						"name": "State",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Fact_GSO_Data_Flow')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorageSynapse",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.gso",
						"container": "gsksynapsestorage"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "CALL_SUMMARY_ID",
						"type": "UTF8"
					},
					{
						"name": "PARENT_CALL_AID",
						"type": "UTF8"
					},
					{
						"name": "LOCAL_CALL_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "CALL_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "TERRITORY_ID",
						"type": "UTF8"
					},
					{
						"name": "CYCLE",
						"type": "UTF8"
					},
					{
						"name": "SALES_FORCE_KEY",
						"type": "UTF8"
					},
					{
						"name": "DATE",
						"type": "UTF8"
					},
					{
						"name": "LOCAL_CALL_TIME_ID",
						"type": "UTF8"
					},
					{
						"name": "ACCOUNT_ID",
						"type": "UTF8"
					},
					{
						"name": "CALL_NAME",
						"type": "UTF8"
					},
					{
						"name": "RX_CALL_TYPE",
						"type": "UTF8"
					},
					{
						"name": "CALL_STATUS",
						"type": "UTF8"
					},
					{
						"name": "ATTENDEE_TYPE",
						"type": "UTF8"
					},
					{
						"name": "CLM_IND",
						"type": "UTF8"
					},
					{
						"name": "SAMPLE_CALL_IND",
						"type": "UTF8"
					},
					{
						"name": "CALL_TYPE",
						"type": "UTF8"
					},
					{
						"name": "DETAILED_PRODUCTS",
						"type": "UTF8"
					},
					{
						"name": "DURATION",
						"type": "UTF8"
					},
					{
						"name": "CREATED_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "CREATED_DATE_TIME_ID",
						"type": "UTF8"
					},
					{
						"name": "LAST_MODIFIED_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "LAST_MODIFIED_DATE_TIME_ID",
						"type": "UTF8"
					},
					{
						"name": "PRE_CALL_NOTES",
						"type": "UTF8"
					},
					{
						"name": "NEXT_CALL_NOTES",
						"type": "UTF8"
					},
					{
						"name": "REVIEW_STATUS",
						"type": "UTF8"
					},
					{
						"name": "ACCOUNT_NAME",
						"type": "UTF8"
					},
					{
						"name": "RX_LEGAL_ID",
						"type": "UTF8"
					},
					{
						"name": "KEY_MESSAGE_NAME",
						"type": "UTF8"
					},
					{
						"name": "QUESTION_ID",
						"type": "UTF8"
					},
					{
						"name": "PRODUCT",
						"type": "UTF8"
					},
					{
						"name": "CALL_DATE",
						"type": "UTF8"
					},
					{
						"name": "ORIGEM",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureBlobStorageSynapse')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/FileServerLocalDouglas')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "FileServerDouglasNew",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "0_Habilitado"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "FileServerLocation"
					},
					"columnDelimiter": "\t",
					"compressionCodec": "ZipDeflate",
					"compressionLevel": "Fastest",
					"encodingName": "ISO-8859-1",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"nullValue": "N/D",
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "PK\u0003\u0004-\u0000\u0000\u0000\t\u0000ÔøΩ\u0011ÔøΩQÔøΩSÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ\u0019\u0000\u0014\u0000dim_interacao_eventos.txt\u0001\u0000\u0010\u0000'ÔøΩÔøΩÔøΩ\u0002\u0000\u0000\u0000ÔøΩK+)\u0000\u0000\u0000\u0000ÔøΩ_ÕéÔøΩ8r>ÔøΩ\u0001ÔøΩ\u0003/>6 QÔøΩ{c*YJVJb6%eMÔøΩ1ÔøΩ",
						"type": "String"
					},
					{
						"name": "\u0016\u0003",
						"type": "String"
					},
					{
						"name": "ÔøΩÔøΩÔøΩ`ÔøΩ}<c\u000fÔøΩ\u001e|ÔøΩÔøΩOÔøΩ ÔøΩ*ÔøΩÔøΩg_\u0002ÔøΩÔøΩÔøΩMvV%ÔøΩ\u001bÔøΩÔøΩ√à`HÔøΩÔøΩÔøΩÔøΩ'sÔøΩÔøΩ=ÔøΩw—õ~ÔøΩOÔøΩ\"ÔøΩjUÔøΩÔøΩ8ÔøΩÔøΩ€™ÔøΩ3ÔøΩuÔøΩÔøΩkÔøΩÔøΩW\u0005oÔøΩÔøΩ7ÔøΩ{zÔøΩÔøΩÔøΩÔøΩ)7ÔøΩV”õÔøΩÔøΩWÔøΩ4ÔøΩIÔøΩÔøΩÔøΩÔøΩqÔøΩÔøΩ\u001bÔøΩÔøΩÔøΩÔ¶∑mÀ¶ÔøΩ\u0007ÔøΩwÔøΩO:ÔøΩ~ÔøΩÔøΩÔøΩÔøΩr”ΩQÔøΩ9ÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩiÔøΩ7m\u000bÔøΩÔøΩÔøΩ/ÔøΩoÔøΩÔøΩÔøΩÔøΩÔøΩ7ÔøΩOﬁú=oÔøΩÔøΩvsfÔøΩœé/",
						"type": "String"
					},
					{
						"name": "ÔøΩÔøΩÔøΩ3ÔøΩÔøΩÔøΩÔøΩ}ÔøΩ",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/FileServerDouglasNew')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/FileSystemGSK')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "FileServerGSK",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"nome_arquivo": {
						"type": "string"
					}
				},
				"folder": {
					"name": "0_Habilitado"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "FileServerLocation",
						"fileName": {
							"value": "@dataset().nome_arquivo",
							"type": "Expression"
						},
						"folderPath": "EMAIL 1-1/FILES"
					},
					"columnDelimiter": "$",
					"compressionCodec": "ZipDeflate",
					"compressionLevel": "Optimal",
					"encodingName": "ISO-8859-1",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "ID~CRM_UNIV~MEDICO_UNIV~ESPECIALIDADE_UNIV~LOGRADOURO_UNIV~BAIRRO_UNIV~CIDADE_UNIV~CEP_UNIV~ORIGEM_UNIV~UF_UNIV~BRICK_UNIV~TELEFONE_UNIV",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/FileServerGSK')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ListarArquivosComprimidos_1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "1 - Email 1-1"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.email1to1",
						"fileSystem": "gsksynapsestorage"
					},
					"columnDelimiter": "<",
					"compressionCodec": "ZipDeflate",
					"compressionLevel": "Fastest",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/ListarArquivosComprimidos_2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "1 - Email 1-1"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao",
						"fileSystem": "gsksynapsestorage"
					},
					"columnDelimiter": "<",
					"compressionCodec": "ZipDeflate",
					"compressionLevel": "Fastest",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Listar_Arquivos_Txt_1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Listar_Arquivos_Txt_3",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "1 - Email 1-1"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.email1to1",
						"container": "gsksynapsestorage"
					},
					"columnDelimiter": "<",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Listar_Arquivos_Txt_3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Listar_Arquivos_Txt_2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Listar_Arquivos_Txt_3",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "2 - KPI Visitacao"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao",
						"container": "gsksynapsestorage"
					},
					"columnDelimiter": "<",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Listar_Arquivos_Txt_3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Listar_Arquivos_Txt_3')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Listar_Arquivos_Txt_3",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.gso",
						"container": "gsksynapsestorage"
					},
					"columnDelimiter": "\t",
					"encodingName": "ISO-8859-1",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Listar_Arquivos_Txt_3')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Parquet1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureDataLakeStorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "dev/gsk_pulmonar",
						"fileSystem": "gsksynapsestorage"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "ID",
						"type": "UTF8"
					},
					{
						"name": "CRM_UNIV",
						"type": "UTF8"
					},
					{
						"name": "MEDICO_UNIV",
						"type": "UTF8"
					},
					{
						"name": "ESPECIALIDADE_UNIV",
						"type": "UTF8"
					},
					{
						"name": "LOGRADOURO_UNIV",
						"type": "UTF8"
					},
					{
						"name": "BAIRRO_UNIV",
						"type": "UTF8"
					},
					{
						"name": "CIDADE_UNIV",
						"type": "UTF8"
					},
					{
						"name": "CEP_UNIV",
						"type": "UTF8"
					},
					{
						"name": "ORIGEM_UNIV",
						"type": "UTF8"
					},
					{
						"name": "UF_UNIV",
						"type": "UTF8"
					},
					{
						"name": "BRICK_UNIV",
						"type": "UTF8"
					},
					{
						"name": "TELEFONE_UNIV",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureDataLakeStorage1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SINK_GSO_ADSL2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "GSO",
						"fileSystem": "gskoutputfiles"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SINK_KPI_EMAIL_ADSL2')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "1 - Email 1-1"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Email & KPI Visitacao",
						"fileSystem": "gskoutputfiles"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Salvar_Dim_GSO_Region_Sink')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "dim_region.parquet",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.gso",
						"fileSystem": "gsksynapsestorage"
					},
					"compressionCodec": "gzip"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Salvar_Dim_GSO_Sink')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.gso",
						"fileSystem": "gsksynapsestorage"
					},
					"compressionCodec": "gzip"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Salvar_Fato_GSO_Sink')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.gso",
						"fileSystem": "gsksynapsestorage"
					},
					"compressionCodec": "gzip"
				},
				"schema": [
					{
						"name": "CALL_SUMMARY_ID",
						"type": "UTF8"
					},
					{
						"name": "PARENT_CALL_AID",
						"type": "UTF8"
					},
					{
						"name": "LOCAL_CALL_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "CALL_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "TERRITORY_ID",
						"type": "UTF8"
					},
					{
						"name": "CYCLE",
						"type": "UTF8"
					},
					{
						"name": "SALES_FORCE_KEY",
						"type": "UTF8"
					},
					{
						"name": "DATE",
						"type": "UTF8"
					},
					{
						"name": "LOCAL_CALL_TIME_ID",
						"type": "UTF8"
					},
					{
						"name": "ACCOUNT_ID",
						"type": "UTF8"
					},
					{
						"name": "CALL_NAME",
						"type": "UTF8"
					},
					{
						"name": "RX_CALL_TYPE",
						"type": "UTF8"
					},
					{
						"name": "CALL_STATUS",
						"type": "UTF8"
					},
					{
						"name": "ATTENDEE_TYPE",
						"type": "UTF8"
					},
					{
						"name": "CLM_IND",
						"type": "UTF8"
					},
					{
						"name": "SAMPLE_CALL_IND",
						"type": "UTF8"
					},
					{
						"name": "CALL_TYPE",
						"type": "UTF8"
					},
					{
						"name": "DETAILED_PRODUCTS",
						"type": "UTF8"
					},
					{
						"name": "DURATION",
						"type": "UTF8"
					},
					{
						"name": "CREATED_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "CREATED_DATE_TIME_ID",
						"type": "UTF8"
					},
					{
						"name": "LAST_MODIFIED_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "LAST_MODIFIED_DATE_TIME_ID",
						"type": "UTF8"
					},
					{
						"name": "PRE_CALL_NOTES",
						"type": "UTF8"
					},
					{
						"name": "NEXT_CALL_NOTES",
						"type": "UTF8"
					},
					{
						"name": "REVIEW_STATUS",
						"type": "UTF8"
					},
					{
						"name": "ACCOUNT_NAME",
						"type": "UTF8"
					},
					{
						"name": "RX_LEGAL_ID",
						"type": "UTF8"
					},
					{
						"name": "KEY_MESSAGE_NAME",
						"type": "UTF8"
					},
					{
						"name": "QUESTION_ID",
						"type": "UTF8"
					},
					{
						"name": "PRODUCT",
						"type": "UTF8"
					},
					{
						"name": "CALL_DATE",
						"type": "UTF8"
					},
					{
						"name": "ORIGEM",
						"type": "UTF8"
					},
					{
						"name": "SURVEY_KEY",
						"type": "UTF8"
					},
					{
						"name": "SOURCE_CREATED_TS",
						"type": "UTF8"
					},
					{
						"name": "RESPONSE_LAST_MODIFIED_TS",
						"type": "UTF8"
					},
					{
						"name": "SOURCE_USER_AID",
						"type": "UTF8"
					},
					{
						"name": "QUESTION_RESPONSE_ID",
						"type": "UTF8"
					},
					{
						"name": "RESPONSE_NAME",
						"type": "UTF8"
					},
					{
						"name": "RESPONSE_NUMBER",
						"type": "UTF8"
					},
					{
						"name": "RESPONSE",
						"type": "UTF8"
					},
					{
						"name": "RESPONSE_QUESTION_ORDER",
						"type": "UTF8"
					},
					{
						"name": "TARGET_LAST_MODIFIED_TS",
						"type": "UTF8"
					},
					{
						"name": "MODIFIED_DATE",
						"type": "UTF8"
					},
					{
						"name": "START_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "END_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "REVIEW_DATE_ID",
						"type": "UTF8"
					},
					{
						"name": "MANAGER_TERRITORY_ID",
						"type": "UTF8"
					},
					{
						"name": "EMPLOYEE_TERRITORY_ID",
						"type": "UTF8"
					},
					{
						"name": "DATE_DIFF",
						"type": "UTF8"
					},
					{
						"name": "FLAG_PREMIO",
						"type": "UTF8"
					},
					{
						"name": "RESPONSES_KEY",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SourceDataset_uhq')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "FileServerGSK",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "FileServerLocation",
						"fileName": "dim_audit_end.txt",
						"folderPath": "EMAIL 1-1/FILES"
					},
					"columnDelimiter": "~",
					"encodingName": "ISO-8859-1",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "CRM_UNIV",
						"type": "String"
					},
					{
						"name": "MEDICO_UNIV",
						"type": "String"
					},
					{
						"name": "ESPECIALIDADE_UNIV",
						"type": "String"
					},
					{
						"name": "LOGRADOURO_UNIV",
						"type": "String"
					},
					{
						"name": "BAIRRO_UNIV",
						"type": "String"
					},
					{
						"name": "CIDADE_UNIV",
						"type": "String"
					},
					{
						"name": "CEP_UNIV",
						"type": "String"
					},
					{
						"name": "ORIGEM_UNIV",
						"type": "String"
					},
					{
						"name": "UF_UNIV",
						"type": "String"
					},
					{
						"name": "BRICK_UNIV",
						"type": "String"
					},
					{
						"name": "TELEFONE_UNIV",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/FileServerGSK')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Source_Dim_KPI')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureBlobStorageSynapse",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "3 - GSO"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao",
						"container": "gsksynapsestorage"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/AzureBlobStorageSynapse')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SqlServerGSK')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "SqlServerGSK",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "0_Habilitado"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [
					{
						"name": "EVENTO",
						"type": "nvarchar"
					},
					{
						"name": "ID_EVENTO",
						"type": "nvarchar"
					},
					{
						"name": "EV CICLO",
						"type": "nvarchar"
					},
					{
						"name": "% DATA_EVENTO",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DATA_EVENTO",
						"type": "smalldatetime",
						"precision": 16,
						"scale": 0
					},
					{
						"name": "EV CICLO_TERRITORIO",
						"type": "nvarchar"
					},
					{
						"name": "EV CICLO_CONTATO",
						"type": "nvarchar"
					},
					{
						"name": "KEY_TERR_CONT_CICLO",
						"type": "nvarchar"
					},
					{
						"name": "ID_PARTICIPANTE",
						"type": "nvarchar"
					},
					{
						"name": "NOME_PARTICIPANTE",
						"type": "nvarchar"
					},
					{
						"name": "EV ROW_ID_TERRITORIO",
						"type": "nvarchar"
					},
					{
						"name": "NOME_USUARIO",
						"type": "nvarchar"
					},
					{
						"name": "EV ROW_ID_CONTATO",
						"type": "nvarchar"
					},
					{
						"name": "DOCUMENTO",
						"type": "nvarchar"
					},
					{
						"name": "EV ESPECIALIDADE_ENG",
						"type": "varchar"
					},
					{
						"name": "STATUS_CONVIDADO_GR",
						"type": "nvarchar"
					},
					{
						"name": "STATUS_CONVIDADO",
						"type": "nvarchar"
					},
					{
						"name": "STATUS_CONVIDADO_ENG",
						"type": "nvarchar"
					},
					{
						"name": "PRODUTO_PRIMARIO",
						"type": "nvarchar"
					},
					{
						"name": "PRODUTO_SECUNDARIO",
						"type": "nvarchar"
					},
					{
						"name": "TIPO_PARTICIPACAO",
						"type": "nvarchar"
					},
					{
						"name": "TIPO_PARTICIPACAO_ENG",
						"type": "nvarchar"
					},
					{
						"name": "TIPO_CONTA",
						"type": "varchar"
					},
					{
						"name": "TIPO_CONTA_ENG",
						"type": "varchar"
					},
					{
						"name": "VISITADO_SETOR",
						"type": "varchar"
					},
					{
						"name": "NOME_SETOR_VISITANTE",
						"type": "nvarchar"
					},
					{
						"name": "TIPO_INTERACAO",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "altran_fato_eventos_email_1_to_1"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/SqlServerGSK')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SqlServerLocalDev')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "SqlServerLocalDouglasDev",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "0_Habilitado"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/SqlServerLocalDouglasDev')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SqlServerLocalDouglas')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "SqlServerLocalDouglasDB",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "0_Habilitado"
				},
				"annotations": [],
				"type": "SqlServerTable",
				"schema": [
					{
						"name": "EVENTO",
						"type": "nvarchar"
					},
					{
						"name": "ID_EVENTO",
						"type": "nvarchar"
					},
					{
						"name": "EV CICLO",
						"type": "nvarchar"
					},
					{
						"name": "% DATA_EVENTO",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DATA_EVENTO",
						"type": "smalldatetime",
						"precision": 16,
						"scale": 0
					},
					{
						"name": "EV CICLO_TERRITORIO",
						"type": "nvarchar"
					},
					{
						"name": "EV CICLO_CONTATO",
						"type": "nvarchar"
					},
					{
						"name": "KEY_TERR_CONT_CICLO",
						"type": "nvarchar"
					},
					{
						"name": "ID_PARTICIPANTE",
						"type": "nvarchar"
					},
					{
						"name": "NOME_PARTICIPANTE",
						"type": "nvarchar"
					},
					{
						"name": "EV ROW_ID_TERRITORIO",
						"type": "nvarchar"
					},
					{
						"name": "NOME_USUARIO",
						"type": "nvarchar"
					},
					{
						"name": "EV ROW_ID_CONTATO",
						"type": "nvarchar"
					},
					{
						"name": "DOCUMENTO",
						"type": "nvarchar"
					},
					{
						"name": "EV ESPECIALIDADE_ENG",
						"type": "varchar"
					},
					{
						"name": "STATUS_CONVIDADO_GR",
						"type": "nvarchar"
					},
					{
						"name": "STATUS_CONVIDADO",
						"type": "nvarchar"
					},
					{
						"name": "STATUS_CONVIDADO_ENG",
						"type": "nvarchar"
					},
					{
						"name": "PRODUTO_PRIMARIO",
						"type": "nvarchar"
					},
					{
						"name": "PRODUTO_SECUNDARIO",
						"type": "nvarchar"
					},
					{
						"name": "TIPO_PARTICIPACAO",
						"type": "nvarchar"
					},
					{
						"name": "TIPO_PARTICIPACAO_ENG",
						"type": "nvarchar"
					},
					{
						"name": "TIPO_CONTA",
						"type": "varchar"
					},
					{
						"name": "TIPO_CONTA_ENG",
						"type": "varchar"
					},
					{
						"name": "VISITADO_SETOR",
						"type": "varchar"
					},
					{
						"name": "NOME_SETOR_VISITANTE",
						"type": "nvarchar"
					},
					{
						"name": "TIPO_INTERACAO",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "altran_email"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/SqlServerLocalDouglasDB')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/TeradataTable1')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "TeradataVeevaGSK",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "0_Habilitado"
				},
				"annotations": [],
				"type": "TeradataTable",
				"schema": [],
				"typeProperties": {}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/TeradataVeevaGSK')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/arquivo_txt_s_comprimir')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "CompressArquivoSave",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"nome_arquivo": {
						"type": "string"
					},
					"pasta": {
						"type": "string"
					}
				},
				"folder": {
					"name": "1 - Email 1-1"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().nome_arquivo",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@concat('synapse/workspaces/gsk-synapse/warehouse/',dataset().pasta)",
							"type": "Expression"
						},
						"fileSystem": "gsksynapsestorage"
					},
					"columnDelimiter": "<",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/CompressArquivoSave')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Arquivos_Em_Parquet_3')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('Arquivos_Em_Parquet_3_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureBlobStorageSynapse')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureBlobStorageSynapse_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataLakeStorage1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage1_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDataLakeStorage1_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataLakeStorageBlobSynapse')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('AzureDataLakeStorageBlobSynapse_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CompressArquivoSave')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('CompressArquivoSave_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('CompressArquivoSave_accountKey')]"
					}
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/FileServerDouglas')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "FileServer",
				"typeProperties": {
					"host": "[parameters('FileServerDouglas_properties_typeProperties_host')]",
					"userId": "[parameters('FileServerDouglas_properties_typeProperties_userId')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('FileServerDouglas_password')]"
					}
				},
				"connectVia": {
					"referenceName": "IntegrationRuntimeLocalDouglas",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/IntegrationRuntimeLocalDouglas')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/FileServerDouglasNew')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "FileServer",
				"typeProperties": {
					"host": "[parameters('FileServerDouglasNew_properties_typeProperties_host')]",
					"userId": "[parameters('FileServerDouglasNew_properties_typeProperties_userId')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('FileServerDouglasNew_password')]"
					}
				},
				"connectVia": {
					"referenceName": "IntegrationRuntimeLocalDouglas",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/IntegrationRuntimeLocalDouglas')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/FileServerGSK')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "FileServer",
				"typeProperties": {
					"host": "[parameters('FileServerGSK_properties_typeProperties_host')]",
					"userId": "[parameters('FileServerGSK_properties_typeProperties_userId')]",
					"password": {
						"type": "SecureString",
						"value": "[parameters('FileServerGSK_password')]"
					}
				},
				"connectVia": {
					"referenceName": "IntegrationRuntimeGSK",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/IntegrationRuntimeGSK')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Listar_Arquivos_Txt_3')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"connectionString": "[parameters('Listar_Arquivos_Txt_3_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/PowerBIWorkspace1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "PowerBIWorkspace",
				"typeProperties": {
					"workspaceID": "e9c95a9d-2a47-44b7-b1ff-f0b5ee336bff",
					"tenantID": "ae26548d-b193-4d6e-8001-922ca3c436d9"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SqlServerConfigCarga')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('SqlServerConfigCarga_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IntegrationRuntimeLocalDouglas",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/IntegrationRuntimeLocalDouglas')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SqlServerGSK')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('SqlServerGSK_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IntegrationRuntimeGSK",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/IntegrationRuntimeGSK')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SqlServerLocalDouglasDB')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('SqlServerLocalDouglasDB_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IntegrationRuntimeLocalDouglas",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/IntegrationRuntimeLocalDouglas')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SqlServerLocalDouglasDev')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "SqlServer",
				"typeProperties": {
					"connectionString": "[parameters('SqlServerLocalDouglasDev_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IntegrationRuntimeLocalDouglas",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/IntegrationRuntimeLocalDouglas')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/TeradataVeevaGSK')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "Teradata",
				"typeProperties": {
					"connectionString": "[parameters('TeradataVeevaGSK_connectionString')]"
				},
				"connectVia": {
					"referenceName": "IntegrationRuntimeGSK",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/IntegrationRuntimeGSK')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/gsk-synapse-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('gsk-synapse-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/gsk-synapse-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('gsk-synapse-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Trigger_6ni')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"type": "TumblingWindowTrigger",
				"typeProperties": {
					"frequency": "Hour",
					"interval": 240,
					"startTime": "2020-12-11T00:37:00.000Z",
					"delay": "00:00:00",
					"maxConcurrency": 50,
					"retryPolicy": {
						"intervalInSeconds": 30
					},
					"dependsOn": []
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Trigger_ap4')]",
			"type": "Microsoft.Synapse/workspaces/triggers",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"type": "TumblingWindowTrigger",
				"typeProperties": {
					"frequency": "Hour",
					"interval": 240,
					"startTime": "2020-12-11T01:11:00.000Z",
					"delay": "00:00:00",
					"maxConcurrency": 50,
					"retryPolicy": {
						"intervalInSeconds": 30
					},
					"dependsOn": []
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AutoResolveIntegrationRuntime')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/IntegrationRuntimeGSK')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/IntegrationRuntimeLocalDouglas')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Dataflow1')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "DelimitedText1",
								"type": "DatasetReference"
							},
							"name": "source1"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Parquet1",
								"type": "DatasetReference"
							},
							"name": "sink1"
						}
					],
					"transformations": [],
					"script": "source(output(\n\t\tPRODUTO_DESC as string,\n\t\tMUNICIPIO as string,\n\t\tUF as string,\n\t\tFANTASIA as string,\n\t\tNR_CNPJ as string,\n\t\tCNES as integer,\n\t\tCID as string,\n\t\tQTDE_INICIAL_PACIENTES as integer,\n\t\tMS_INICIAL_PACIENTES as decimal(10,0),\n\t\tQTDE_PACIENTES_NOVOS as integer,\n\t\tQTDE_PACIENTES_RETORNO_MESMA as integer,\n\t\tQTDE_PACIENTES_RETORNO_OUTRA as integer,\n\t\tQTDE_PACIENTES_VIERAM as integer,\n\t\tQTDE_PACIENTES_FORAM as integer,\n\t\tQTDE_PACIENTES_DELTA as integer,\n\t\tQTDE_PACIENTES_SAIRAM as integer,\n\t\tQTDE_MOVIMENTACAO as integer,\n\t\tQTDE_FINAL_PACIENTES as integer,\n\t\tMS_FINAL_PACIENTES as decimal(10,0),\n\t\tPP as string,\n\t\tDT_PERIODO_INICIAL as string,\n\t\tDT_PERIODO_FINAL as string,\n\t\tQTDE_PACIENTES_CONTINUAM as integer,\n\t\tMERCADO as string,\n\t\tTERRITORIO as string,\n\t\tGD as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: true,\n\tignoreNoFilesFound: false,\n\tinferDriftedColumnTypes: true,\n\tdateFormats: ['yyyy-MM-dd'],\n\ttimestampFormats: ['yyyy.MM.dd HH:mm:ss'],\n\tpreferredIntegralType: 'integer',\n\tpreferredFractionalType: 'decimal',\n\tpartitionBy('key',\n\t\t0,\n\t\tPRODUTO_DESC\n\t)) ~> source1\nsource1 sink(input(\n\t\tID as string,\n\t\tCRM_UNIV as string,\n\t\tMEDICO_UNIV as string,\n\t\tESPECIALIDADE_UNIV as string,\n\t\tLOGRADOURO_UNIV as string,\n\t\tBAIRRO_UNIV as string,\n\t\tCIDADE_UNIV as string,\n\t\tCEP_UNIV as string,\n\t\tORIGEM_UNIV as string,\n\t\tUF_UNIV as string,\n\t\tBRICK_UNIV as string,\n\t\tTELEFONE_UNIV as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tfilePattern:'gsk_pulmonar[n]',\n\ttruncate: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/DelimitedText1')]",
				"[concat(variables('workspaceId'), '/datasets/Parquet1')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/EMAIL_ETL')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dIntVisitasRealizadas"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dIntVisitasMedico"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dIntEmail"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dIntVisitasFranchise"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dIntEventos"
						},
						{
							"linkedService": {
								"referenceName": "AzureBlobStorageSynapse",
								"type": "LinkedServiceReference"
							},
							"name": "HistZona"
						},
						{
							"linkedService": {
								"referenceName": "AzureBlobStorageSynapse",
								"type": "LinkedServiceReference"
							},
							"name": "RepsZona"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dForcaVendas"
						},
						{
							"dataset": {
								"referenceName": "Dim_KPI_Vis_Parquet",
								"type": "DatasetReference"
							},
							"name": "dKPITerritorio"
						},
						{
							"dataset": {
								"referenceName": "Dim_KPI_Vis_Parquet",
								"type": "DatasetReference"
							},
							"name": "dCoaching"
						},
						{
							"dataset": {
								"referenceName": "Dim_KPI_Vis_Parquet",
								"type": "DatasetReference"
							},
							"name": "dMSLDivision"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dTargetSRO"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dQuadranteMedico"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dQuadranteMedicoGP"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dAuditEnd"
						},
						{
							"dataset": {
								"referenceName": "Dim_Email_1_1_Parquet",
								"type": "DatasetReference"
							},
							"name": "dPainelMedico"
						},
						{
							"linkedService": {
								"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "TraducaoEspecialidadeEventos"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkFatoInteracoes"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimForcaVendas"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimHistoricoZonas"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimKpiTerritorio"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkCoaching"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimMslDivision"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimTargetSro"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimQuadranteMedico"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimQuadranteMedicoGp"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimAuditEnd"
						},
						{
							"dataset": {
								"referenceName": "SINK_KPI_EMAIL_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimPainelMedico"
						}
					],
					"transformations": [
						{
							"name": "ChavemamentoVisitasRealizadas",
							"description": "Autogenerated by data preview actions"
						},
						{
							"name": "ConcatChave"
						},
						{
							"name": "ConcatChave2"
						},
						{
							"name": "ChaveamentoVisitasMedicos",
							"description": "Autogenerated by data preview actions"
						},
						{
							"name": "ConcatChave3"
						},
						{
							"name": "ChaveamentoEmail",
							"description": "Autogenerated by data preview actions"
						},
						{
							"name": "ConcatChave4"
						},
						{
							"name": "ChaveamentoVisitasFranchise",
							"description": "Autogenerated by data preview actions"
						},
						{
							"name": "UnpivotHistZona"
						},
						{
							"name": "SelecaoTempHistZona"
						},
						{
							"name": "ChaveamentoHistZona"
						},
						{
							"name": "SelecaoTempRepsZona"
						},
						{
							"name": "ChaveamentoRepsZona"
						},
						{
							"name": "SelecaoTempForcaVendas"
						},
						{
							"name": "ChaveamentoForcaVendas"
						},
						{
							"name": "LeftJoinRepsZonaFV"
						},
						{
							"name": "SelecaoTempKPITerr"
						},
						{
							"name": "ChaveamentoKPITerr"
						},
						{
							"name": "SelecaoTempCoaching"
						},
						{
							"name": "ChaveamentoCoching"
						},
						{
							"name": "SelecaoTempMSLDivision"
						},
						{
							"name": "ChaveamentoMSLDivision"
						},
						{
							"name": "SelecaoTempCadTargetSRO"
						},
						{
							"name": "ChaveamentoTargetSRO"
						},
						{
							"name": "SelecaoTempQM"
						},
						{
							"name": "ChaveamentoQuadranteMedico"
						},
						{
							"name": "SelecaotTempQDGP"
						},
						{
							"name": "ChaveamentoQuadranteMedicoGP"
						},
						{
							"name": "SelecaoTempAuditEnd"
						},
						{
							"name": "ChaveamentoAuditEnd"
						},
						{
							"name": "ChaveamentoPainelMedico"
						},
						{
							"name": "RemoverErros1"
						},
						{
							"name": "RemoverErros2"
						},
						{
							"name": "RemoverErros3"
						},
						{
							"name": "UpperEspecialidadeBR",
							"description": "Autogenerated by data preview actions"
						},
						{
							"name": "TraducaoEspecialidadePTBR"
						},
						{
							"name": "LeftJoinTraducaoEspecialidadeEventos"
						},
						{
							"name": "ChaveamentoEventos"
						},
						{
							"name": "UnionVisitasMedico"
						},
						{
							"name": "SelecaoFatoInteracao"
						},
						{
							"name": "DimForcaVendas"
						},
						{
							"name": "SelecaoPainelMedico"
						}
					],
					"script": "source(output(\n\t\tID as string,\n\t\tID_VISITA as string,\n\t\tTIPO_VISITA as string,\n\t\tTIPO_VISITA_PTBR as string,\n\t\tTIPO_VISITA_ORDER as string,\n\t\tCLM_IND as string,\n\t\tRECORD_TYPE_ID as string,\n\t\tRECORD_TYPE_NAME as string,\n\t\tDATA as string,\n\t\tCICLO as string,\n\t\tTARGET_PER_ID as string,\n\t\tROW_ID_TERRITORIO as string,\n\t\tSEMANA as string,\n\t\tFLAG_VISITA as string,\n\t\tTIPO_INTERACAO as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_interacao_visitas_realizadas.parquet']) ~> dIntVisitasRealizadas\nsource(output(\n\t\tID as string,\n\t\tCICLO as string,\n\t\tROW_ID_TERRITORIO as string,\n\t\tROW_ID_CONTATO as string,\n\t\tVP as string,\n\t\tVR as string,\n\t\tVRE as string,\n\t\tVRT as string,\n\t\tPLANEJUN as string,\n\t\tREALUN as string,\n\t\tEFFECTIVE_CALLS as string,\n\t\tUNDER_CALLS as string,\n\t\tOVER_CALLS as string,\n\t\tOFF_TARGET_CALLS as string,\n\t\tTARGET_CUST as string,\n\t\tUNDER_TARGET as string,\n\t\tON_TARGET as string,\n\t\tOVER_TARGET as string,\n\t\tEMAIL_CONSENT_KPI as string,\n\t\tAT_DESIRED_FREQUENCY as string,\n\t\tOVER_DESIRED_FREQUENCY as string,\n\t\tTIPO_INTERACAO as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_interacao_visitas_medicos.parquet']) ~> dIntVisitasMedico\nsource(output(\n\t\tID as string,\n\t\tCICLO as string,\n\t\tID_ENVIO_EMAIL as string,\n\t\tID_ATIV_EMAIL as string,\n\t\tTIPO_ATIV_EMAIL as string,\n\t\tDATA_ATIV_EMAIL as string,\n\t\tPRODUTO as string,\n\t\tROW_ID_CONTATO as string,\n\t\tROW_ID_TERRITORIO as string,\n\t\tDOCUMENTO_EMAIL as string,\n\t\tDESC_DOCUMENTO_EMAIL as string,\n\t\tASSUNTO_EMAIL as string,\n\t\tTIPO_INTERACAO as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_interacao_email.parquet']) ~> dIntEmail\nsource(output(\n\t\tID as string,\n\t\tROW_ID_CONTATO as string,\n\t\tROW_ID_TERRITORIO as string,\n\t\tCICLO as string,\n\t\tPRODUTO_FRANCHISE as string,\n\t\tFRANCHISE as string,\n\t\tSUB_CAT_FRANCHISE as string,\n\t\tPESO_FRANCHISE as string,\n\t\tTIPO_INTERACAO as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_interacao_visitas_franchise.parquet']) ~> dIntVisitasFranchise\nsource(output(\n\t\tEVENTO as string,\n\t\tID_EVENTO as string,\n\t\tEV_CICLO as string,\n\t\tDATA_EVENTO as string,\n\t\tDATA_EVENTO_2 as string,\n\t\tEV_CICLO_TERRITORIO as string,\n\t\tEV_CICLO_CONTATO as string,\n\t\tKEY_TERR_CONT_CICLO as string,\n\t\tID_PARTICIPANTE as string,\n\t\tNOME_PARTICIPANTE as string,\n\t\tEV_ROW_ID_TERRITORIO as string,\n\t\tNOME_USUARIO as string,\n\t\tEV_ROW_ID_CONTATO as string,\n\t\tDOCUMENTO as string,\n\t\tEV_ESPECIALIDADE_ENG as string,\n\t\tSTATUS_CONVIDADO_GR as string,\n\t\tSTATUS_CONVIDADO as string,\n\t\tSTATUS_CONVIDADO_ENG as string,\n\t\tPRODUTO_PRIMARIO as string,\n\t\tPRODUTO_SECUNDARIO as string,\n\t\tTIPO_PARTICIPACAO as string,\n\t\tTIPO_PARTICIPACAO_ENG as string,\n\t\tTIPO_CONTA as string,\n\t\tTIPO_CONTA_ENG as string,\n\t\tVISITADO_SETOR as string,\n\t\tNOME_SETOR_VISITANTE as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_interacao_eventos.parquet']) ~> dIntEventos\nsource(output(\n\t\tUF as string,\n\t\t{Cidade Base} as string,\n\t\tCHAVE as string,\n\t\tTotal_Reps_OneFarma as short,\n\t\t{2020-05-26} as string,\n\t\t{2020-05-29} as string,\n\t\t{2020-06-01} as string,\n\t\t{2020-06-02} as string,\n\t\t{2020-06-03} as string,\n\t\t{2020-06-08} as string,\n\t\t{2020-06-09} as string,\n\t\t{2020-06-10} as string,\n\t\t{2020-06-11} as string,\n\t\t{2020-06-15} as string,\n\t\t{2020-06-17} as string,\n\t\t{2020-06-18} as string,\n\t\t{2020-06-19} as string,\n\t\t{2020-06-22} as string,\n\t\t{2020-06-24} as string,\n\t\t{2020-06-25} as string,\n\t\t{2020-06-26} as string,\n\t\t{2020-06-29} as string,\n\t\t{2020-06-30} as string,\n\t\t{2020-07-01} as string,\n\t\t{2020-07-06} as string,\n\t\t{2020-07-07} as string,\n\t\t{2020-07-10} as string,\n\t\t{2020-07-13} as string,\n\t\t{2020-07-14} as string,\n\t\t{2020-07-15} as string,\n\t\t{2020-07-20} as string,\n\t\t{2020-07-21} as string,\n\t\t{2020-07-27} as string,\n\t\t{2020-07-28} as string,\n\t\t{2020-08-04} as string,\n\t\t{2020-08-05} as string,\n\t\t{2020-08-06} as string,\n\t\t{2020-08-07} as string,\n\t\t{2020-08-10} as string,\n\t\t{2020-08-11} as string,\n\t\t{2020-09-04} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tinferDriftedColumnTypes: true,\n\tformat: 'excel',\n\tcontainer: 'gsksynapsestorage',\n\tfolderPath: 'synapse/workspaces/gsk-synapse/warehouse/aux.tabelas_auxiliares',\n\tfileName: 'BASE CIDADES REPS - 04_09_2020.xlsx',\n\tsheetName: 'ZONAS CIDADES - HISTORICO',\n\tfirstRowAsHeader: true) ~> HistZona\nsource(output(\n\t\tMudid as string,\n\t\tCIDADE as string,\n\t\tUF as string,\n\t\tCHAVE as string,\n\t\tZONA as string,\n\t\t{_c5} as string,\n\t\t{_c6} as string,\n\t\t{_c7} as string,\n\t\t{_c8} as string,\n\t\t{_c9} as string,\n\t\t{_c10} as string,\n\t\t{_c11} as string,\n\t\t{_c12} as string,\n\t\t{_c13} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'excel',\n\tcontainer: 'gsksynapsestorage',\n\tfolderPath: 'synapse/workspaces/gsk-synapse/warehouse/aux.tabelas_auxiliares',\n\tfileName: 'BASE CIDADES REPS - 04_09_2020.xlsx',\n\tsheetName: 'REPS_ZONAS',\n\tfirstRowAsHeader: true) ~> RepsZona\nsource(output(\n\t\tID as string,\n\t\tBU as string,\n\t\tDIVISAO as string,\n\t\tNOME_GD as string,\n\t\tNOME_GR as string,\n\t\tNOME_REPRESENTANTE as string,\n\t\tMUDID as string,\n\t\tROW_ID_TERRITORIO as string,\n\t\tTERRITORIO as string,\n\t\tTERRITORIO_GD as string,\n\t\tTERRITORIO_GR as string,\n\t\tCICLO_FV as string,\n\t\tROW_ID_FUNCIONARIO as string,\n\t\tFLAG_PROJETO as string,\n\t\tFLAG_TARGET as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_forca_vendas.parquet']) ~> dForcaVendas\nsource(output(\n\t\tID as string,\n\t\tCICLO as string,\n\t\tROW_ID_TERRITORIO as string,\n\t\tTFT as string,\n\t\tDIAS_UTEIS as string,\n\t\tVISITAS_ABATER as string,\n\t\tOBJETIVO_VISITA_DIA as string,\n\t\tDIAS_VISITACAO as string,\n\t\tVR_CLM as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao/dim_kpi_territorio.parquet']) ~> dKPITerritorio\nsource(output(\n\t\tID as string,\n\t\tCICLO as string,\n\t\tTERRITORIO_GD as string,\n\t\tTOTAL_COACHING as string,\n\t\tTOTAL_ABATER as string,\n\t\tDIAS_UTEIS_COACHING as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao/dim_coaching.parquet']) ~> dCoaching\nsource(output(\n\t\tID as string,\n\t\tKEY_DIVISAO_CICLO as string,\n\t\tFUNC_TOTAL as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao/dim_msl_division.parquet']) ~> dMSLDivision\nsource(output(\n\t\tID as string,\n\t\tCICLO as string,\n\t\tDIVISAO as string,\n\t\tTARGET_SRO_CRM as string,\n\t\tTARGET_SRO_VISITA as string,\n\t\tTARGET_SRO_MEDIA_DIA as string,\n\t\tTARGET_SRO_COACHING as string,\n\t\tTARGET_SRO_COB as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_cad_target_sro.parquet']) ~> dTargetSRO\nsource(output(\n\t\tID as string,\n\t\tCICLO_QUAD as string,\n\t\tCRM_QUAD as string,\n\t\tMERCADO_QUAD as string,\n\t\tCATEGORIA_QUAD as string,\n\t\tMKT_SHARE_QUAD as string,\n\t\tQUADRANTE_QUAD as string,\n\t\tJORNADA_QUAD as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_quadrante_medico.parquet']) ~> dQuadranteMedico\nsource(output(\n\t\tID as string,\n\t\tCRM_GP as string,\n\t\tMERCADO_GP as string,\n\t\tCATEGORIA_GP as string,\n\t\tJORNADA_GP as string,\n\t\tQUADRANTE_GP as string,\n\t\tROW_ID_TERRITORIO_GP as string,\n\t\tROW_ID_CONTATO_GP as string,\n\t\tCICLO as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_quadrante_medico_gp.parquet']) ~> dQuadranteMedicoGP\nsource(output(\n\t\tID as string,\n\t\tCRM_UNIV as string,\n\t\tMEDICO_UNIV as string,\n\t\tESPECIALIDADE_UNIV as string,\n\t\tLOGRADOURO_UNIV as string,\n\t\tBAIRRO_UNIV as string,\n\t\tCIDADE_UNIV as string,\n\t\tCEP_UNIV as string,\n\t\tORIGEM_UNIV as string,\n\t\tUF_UNIV as string,\n\t\tBRICK_UNIV as string,\n\t\tTELEFONE_UNIV as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_audit_end.parquet']) ~> dAuditEnd\nsource(output(\n\t\tCRM_CICLO as string,\n\t\tMES as string,\n\t\tCICLO as string,\n\t\tCRM as string,\n\t\tMEDICO as string,\n\t\tTIPO as string,\n\t\tTIPOCONTATO as string,\n\t\tGRUPOPROMOCIONAL as string,\n\t\tESPECIALIDADE as string,\n\t\tLOGRADOURO as string,\n\t\tCOMPLEMENTO as string,\n\t\tBAIRRO as string,\n\t\tCIDADE as string,\n\t\tUF as string,\n\t\tCEP as string,\n\t\tBRICK as string,\n\t\tTELEFONEMEDICO as string,\n\t\tCELULARMEDICO as string,\n\t\tEMAIL_1_1 as string,\n\t\tROW_ID_FUNCIONARIO as string,\n\t\tROW_ID_TERRITORIO as string,\n\t\tROW_ID_CONTATO as string,\n\t\tSTATUS as string,\n\t\tQTD_VISITA_PLANEJADA_PAINEL as string,\n\t\tQTD_VISITA_REALIZADA_PAINEL as string,\n\t\tESPECIALIDADE_02 as string,\n\t\tESPECIALIDADE_03 as string,\n\t\tVP_PROX as string,\n\t\tSTATUS_MEDICO as string,\n\t\tEMAIL_1_1_CONSENT as string,\n\t\tNETWORK_ID as string,\n\t\tRX_GIGYA_ID as string,\n\t\tVEEVA_ID as string,\n\t\tROW_ID_CONTATO_EXT as string,\n\t\tEMAIL_MASS as string,\n\t\tEMAIL_MASS_CONSENT as string,\n\t\tCYCLE_PLAN as string,\n\t\tMERCADO as string,\n\t\tPRODUTO_PAINEL as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_painel_medico.parquet']) ~> dPainelMedico\nsource(output(\n\t\tEN as string,\n\t\tPT_BR as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'excel',\n\tfileSystem: 'gsksynapsestorage',\n\tfolderPath: 'synapse/workspaces/gsk-synapse/warehouse/aux.tabelas_auxiliares',\n\tfileName: 'Aux_Veeva_Especialidade_Traducao.xlsx',\n\tsheetName: 'Sheet3',\n\tfirstRowAsHeader: true) ~> TraducaoEspecialidadeEventos\nConcatChave select(mapColumn(\n\t\tKEY_TERR_CONT_CICLO,\n\t\tID_VISITA,\n\t\tTIPO_VISITA,\n\t\tTIPO_VISITA_PTBR,\n\t\tTIPO_VISITA_ORDER,\n\t\tCLM_IND,\n\t\tRECORD_TYPE_ID,\n\t\tRECORD_TYPE_NAME,\n\t\tDATA,\n\t\tCICLO,\n\t\tTARGET_PER_ID,\n\t\tROW_ID_TERRITORIO,\n\t\tSEMANA,\n\t\tFLAG_VISITA,\n\t\tTIPO_INTERACAO\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ChavemamentoVisitasRealizadas\ndIntVisitasRealizadas derive(KEY_TERR_CONT_CICLO = concat(ROW_ID_TERRITORIO, TARGET_PER_ID, CICLO)) ~> ConcatChave\ndIntVisitasMedico derive(KEY_TERR_CONT_CICLO = concat(ROW_ID_TERRITORIO,ROW_ID_CONTATO,CICLO)) ~> ConcatChave2\nConcatChave2 select(mapColumn(\n\t\tKEY_TERR_CONT_CICLO,\n\t\tCICLO,\n\t\tROW_ID_TERRITORIO,\n\t\tROW_ID_CONTATO,\n\t\tVP,\n\t\tVR,\n\t\tVRE,\n\t\tVRT,\n\t\tPLANEJUN,\n\t\tREALUN,\n\t\tEFFECTIVE_CALLS,\n\t\tUNDER_CALLS,\n\t\tOVER_CALLS,\n\t\tOFF_TARGET_CALLS,\n\t\tTARGET_CUST,\n\t\tUNDER_TARGET,\n\t\tON_TARGET,\n\t\tOVER_TARGET,\n\t\tEMAIL_CONSENT_KPI,\n\t\tAT_DESIRED_FREQUENCY,\n\t\tOVER_DESIRED_FREQUENCY,\n\t\tTIPO_INTERACAO\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ChaveamentoVisitasMedicos\ndIntEmail derive(KEY_TERR_CONT_CICLO = concat(ROW_ID_TERRITORIO,ROW_ID_CONTATO,CICLO)) ~> ConcatChave3\nConcatChave3 select(mapColumn(\n\t\tKEY_TERR_CONT_CICLO,\n\t\tCICLO,\n\t\tID_ENVIO_EMAIL,\n\t\tID_ATIV_EMAIL,\n\t\tTIPO_ATIV_EMAIL,\n\t\tDATA_ATIV_EMAIL,\n\t\tPRODUTO,\n\t\tROW_ID_CONTATO,\n\t\tROW_ID_TERRITORIO,\n\t\tDOCUMENTO_EMAIL,\n\t\tDESC_DOCUMENTO_EMAIL,\n\t\tASSUNTO_EMAIL,\n\t\tTIPO_INTERACAO\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ChaveamentoEmail\ndIntVisitasFranchise derive(KEY_TERR_CONT_CICLO = concat(ROW_ID_TERRITORIO,ROW_ID_CONTATO,CICLO)) ~> ConcatChave4\nConcatChave4 select(mapColumn(\n\t\tKEY_TERR_CONT_CICLO,\n\t\tROW_ID_CONTATO,\n\t\tROW_ID_TERRITORIO,\n\t\tCICLO,\n\t\tPRODUTO_FRANCHISE,\n\t\tFRANCHISE,\n\t\tSUB_CAT_FRANCHISE,\n\t\tPESO_FRANCHISE,\n\t\tTIPO_INTERACAO\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ChaveamentoVisitasFranchise\nHistZona unpivot(output(\n\t\tDATA_ZONA as string,\n\t\t{2020-05-26} as string,\n\t\t{2020-05-29} as string,\n\t\t{2020-06-01} as string,\n\t\t{2020-06-02} as string,\n\t\t{2020-06-03} as string,\n\t\t{2020-06-08} as string,\n\t\t{2020-06-09} as string,\n\t\t{2020-06-10} as string,\n\t\t{2020-06-11} as string,\n\t\t{2020-06-15} as string,\n\t\t{2020-06-17} as string,\n\t\t{2020-06-18} as string,\n\t\t{2020-06-19} as string,\n\t\t{2020-06-22} as string,\n\t\t{2020-06-24} as string,\n\t\t{2020-06-25} as string,\n\t\t{2020-06-26} as string,\n\t\t{2020-06-29} as string,\n\t\t{2020-06-30} as string,\n\t\t{2020-07-01} as string,\n\t\t{2020-07-06} as string,\n\t\t{2020-07-07} as string,\n\t\t{2020-07-10} as string,\n\t\t{2020-07-13} as string,\n\t\t{2020-07-14} as string,\n\t\t{2020-07-15} as string,\n\t\t{2020-07-20} as string,\n\t\t{2020-07-21} as string,\n\t\t{2020-07-27} as string,\n\t\t{2020-07-28} as string,\n\t\t{2020-08-04} as string,\n\t\t{2020-08-05} as string,\n\t\t{2020-08-06} as string,\n\t\t{2020-08-07} as string,\n\t\t{2020-08-10} as string,\n\t\t{2020-08-11} as string,\n\t\t{2020-09-04} as string\n\t),\n\tungroupBy(UF,\n\t\t{Cidade Base},\n\t\tCHAVE,\n\t\tTotal_Reps_OneFarma),\n\tlateral: true,\n\tignoreNullPivots: true) ~> UnpivotHistZona\nUnpivotHistZona select(mapColumn(\n\t\tCHAVE_ZONA = CHAVE,\n\t\tDATA_ZONA,\n\t\tSTATUS_ZONA = {2020-05-26}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoTempHistZona\nSelecaoTempHistZona derive(DATA_ZONA = toDate(DATA_ZONA),\n\t\tNUM_DATA_ZONA = minus(toDate(DATA_ZONA),toDate('1900-01-01'))+2,\n\t\tMES_ZONA = toString(toDate(DATA_ZONA), 'MMM')) ~> ChaveamentoHistZona\nRepsZona select(mapColumn(\n\t\tMUDID = Mudid,\n\t\tCIDADE_ZONA = CIDADE,\n\t\tUF_ZONA = UF,\n\t\tCHAVE,\n\t\tZONA_COMPLETA = ZONA\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoTempRepsZona\nSelecaoTempRepsZona derive(CHAVE_ZONA = concat(CIDADE_ZONA,'-',UF_ZONA),\n\t\tZONA = trim(split(ZONA_COMPLETA,' - ')[1])) ~> ChaveamentoRepsZona\ndForcaVendas select(mapColumn(\n\t\tBU,\n\t\tDIVISAO,\n\t\tNOME_GD,\n\t\tNOME_GR,\n\t\tNOME_REPRESENTANTE,\n\t\tMUDID,\n\t\tROW_ID_TERRITORIO,\n\t\tTERRITORIO,\n\t\tTERRITORIO_GD,\n\t\tTERRITORIO_GR,\n\t\tCICLO_FV,\n\t\tROW_ID_FUNCIONARIO,\n\t\tFLAG_PROJETO,\n\t\tFLAG_TARGET\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoTempForcaVendas\nSelecaoTempForcaVendas derive(KEY_TERR_CICLO = concat(ROW_ID_TERRITORIO,CICLO_FV),\n\t\tKEY_CICLO_TERR_GD = concat(CICLO_FV,right(TERRITORIO_GD,6)),\n\t\tKEY_DIVISAO_CICLO = concat(DIVISAO, CICLO_FV),\n\t\tKEY_MUDID_TERR = concat(MUDID, TERRITORIO),\n\t\tKEY_TERR = trim(concat(ROW_ID_TERRITORIO,''))) ~> ChaveamentoForcaVendas\nChaveamentoForcaVendas, ChaveamentoRepsZona join(SelecaoTempForcaVendas@MUDID == SelecaoTempRepsZona@MUDID,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinRepsZonaFV\ndKPITerritorio select(mapColumn(\n\t\tCICLO,\n\t\tROW_ID_TERRITORIO,\n\t\tTFT,\n\t\tDIAS_UTEIS,\n\t\tVISITAS_ABATER,\n\t\tOBJETIVO_VISITA_DIA,\n\t\tDIAS_VISITACAO,\n\t\tVR_CLM\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoTempKPITerr\nSelecaoTempKPITerr derive(KEY_TERR_CICLO = concat(ROW_ID_TERRITORIO,CICLO)) ~> ChaveamentoKPITerr\ndCoaching select(mapColumn(\n\t\tCICLO,\n\t\tTERRITORIO_GD,\n\t\tTOTAL_COACHING,\n\t\tTOTAL_ABATER,\n\t\tDIAS_UTEIS_COACHING\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoTempCoaching\nSelecaoTempCoaching derive(KEY_CICLO_TERR_GD = concat(CICLO, right(TERRITORIO_GD, 6))) ~> ChaveamentoCoching\ndMSLDivision select(mapColumn(\n\t\tKEY_DIVISAO_CICLO,\n\t\tFUNC_TOTAL\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoTempMSLDivision\nSelecaoTempMSLDivision derive(KEY_DIVISAO_CICLO = replace(KEY_DIVISAO_CICLO, ' - ', '')) ~> ChaveamentoMSLDivision\ndTargetSRO select(mapColumn(\n\t\tCICLO,\n\t\tDIVISAO,\n\t\tTARGET_SRO_CRM,\n\t\tTARGET_SRO_VISITA,\n\t\tTARGET_SRO_MEDIA_DIA,\n\t\tTARGET_SRO_COACHING,\n\t\tTARGET_SRO_COB\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoTempCadTargetSRO\nSelecaoTempCadTargetSRO derive(KEY_DIVISAO_CICLO = concat(DIVISAO, CICLO)) ~> ChaveamentoTargetSRO\ndQuadranteMedico select(mapColumn(\n\t\tCICLO_QUAD,\n\t\tCRM_QUAD,\n\t\tMERCADO_QUAD,\n\t\tCATEGORIA_QUAD,\n\t\tMKT_SHARE_QUAD,\n\t\tQUADRANTE_QUAD,\n\t\tJORNADA_QUAD\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoTempQM\nSelecaoTempQM derive(KEY_CRM_UNIV = trim(concat(CRM_QUAD,'')),\n\t\tKEY_CICLO_CRM = concat(CICLO_QUAD,CRM_QUAD)) ~> ChaveamentoQuadranteMedico\ndQuadranteMedicoGP select(mapColumn(\n\t\tCRM_GP,\n\t\tMERCADO_GP,\n\t\tCATEGORIA_GP,\n\t\tJORNADA_GP,\n\t\tQUADRANTE_GP,\n\t\tROW_ID_TERRITORIO_GP,\n\t\tROW_ID_CONTATO_GP,\n\t\tCICLO\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaotTempQDGP\nSelecaotTempQDGP derive(KEY_TERR_CONT_CICLO = concat(ROW_ID_TERRITORIO_GP, ROW_ID_CONTATO_GP, CICLO)) ~> ChaveamentoQuadranteMedicoGP\ndAuditEnd select(mapColumn(\n\t\tCRM_UNIV,\n\t\tMEDICO_UNIV,\n\t\tESPECIALIDADE_UNIV,\n\t\tLOGRADOURO_UNIV,\n\t\tBAIRRO_UNIV,\n\t\tCIDADE_UNIV,\n\t\tCEP_UNIV,\n\t\tORIGEM_UNIV,\n\t\tUF_UNIV,\n\t\tBRICK_UNIV,\n\t\tTELEFONE_UNIV\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoTempAuditEnd\nSelecaoTempAuditEnd derive(KEY_CRM_UNIV = trim(concat(CRM_UNIV,''))) ~> ChaveamentoAuditEnd\ndPainelMedico derive(KEY_TERR_CONT_CICLO = concat(ROW_ID_TERRITORIO, ROW_ID_CONTATO,CICLO),\n\t\tKEY_TERR_CICLO = concat(ROW_ID_TERRITORIO, CICLO),\n\t\tKEY_CICLO_CRM = concat(CICLO, CRM),\n\t\t{% Date Key} = toDate(toString(CICLO, 'yyyyMM'),'yyyyMM')) ~> ChaveamentoPainelMedico\ndIntEventos filter(EV_CICLO != '43590') ~> RemoverErros1\nRemoverErros1 filter(EVENTO != 'rio') ~> RemoverErros2\nRemoverErros2 filter(ID_EVENTO != '33825') ~> RemoverErros3\nTraducaoEspecialidadeEventos derive(PT_BR = upper(PT_BR)) ~> UpperEspecialidadeBR\nUpperEspecialidadeBR select(mapColumn(\n\t\tEN,\n\t\tEV_ESPECIALIDADE = PT_BR\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> TraducaoEspecialidadePTBR\nRemoverErros3, TraducaoEspecialidadePTBR join(EV_ESPECIALIDADE_ENG == EN,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinTraducaoEspecialidadeEventos\nLeftJoinTraducaoEspecialidadeEventos select(mapColumn(\n\t\tEVENTO,\n\t\tID_EVENTO,\n\t\tEV_CICLO,\n\t\tDATA_EVENTO,\n\t\tDATA_EVENTO_2,\n\t\tEV_CICLO_TERRITORIO,\n\t\tEV_CICLO_CONTATO,\n\t\tKEY_TERR_CONT_CICLO,\n\t\tID_PARTICIPANTE,\n\t\tNOME_PARTICIPANTE,\n\t\tEV_ROW_ID_TERRITORIO,\n\t\tNOME_USUARIO,\n\t\tEV_ROW_ID_CONTATO,\n\t\tDOCUMENTO,\n\t\tEV_ESPECIALIDADE_ENG,\n\t\tSTATUS_CONVIDADO_GR,\n\t\tSTATUS_CONVIDADO,\n\t\tSTATUS_CONVIDADO_ENG,\n\t\tPRODUTO_PRIMARIO,\n\t\tPRODUTO_SECUNDARIO,\n\t\tTIPO_PARTICIPACAO,\n\t\tTIPO_PARTICIPACAO_ENG,\n\t\tTIPO_CONTA,\n\t\tTIPO_CONTA_ENG,\n\t\tVISITADO_SETOR,\n\t\tNOME_SETOR_VISITANTE,\n\t\tEV_ESPECIALIDADE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ChaveamentoEventos\nChavemamentoVisitasRealizadas, ChaveamentoVisitasMedicos, ChaveamentoEmail, ChaveamentoVisitasFranchise, ChaveamentoEventos union(byName: true)~> UnionVisitasMedico\nUnionVisitasMedico select(mapColumn(\n\t\tKEY_TERR_CONT_CICLO,\n\t\tID_VISITA,\n\t\tTIPO_VISITA,\n\t\tTIPO_VISITA_PTBR,\n\t\tTIPO_VISITA_ORDER,\n\t\tCLM_IND,\n\t\tRECORD_TYPE_ID,\n\t\tRECORD_TYPE_NAME,\n\t\tDATA,\n\t\tCICLO,\n\t\tTARGET_PER_ID,\n\t\tROW_ID_TERRITORIO,\n\t\tSEMANA,\n\t\tFLAG_VISITA,\n\t\tTIPO_INTERACAO,\n\t\tROW_ID_CONTATO,\n\t\tVP,\n\t\tVR,\n\t\tVRE,\n\t\tVRT,\n\t\tPLANEJUN,\n\t\tREALUN,\n\t\tEFFECTIVE_CALLS,\n\t\tUNDER_CALLS,\n\t\tOVER_CALLS,\n\t\tOFF_TARGET_CALLS,\n\t\tTARGET_CUST,\n\t\tUNDER_TARGET,\n\t\tON_TARGET,\n\t\tOVER_TARGET,\n\t\tEMAIL_CONSENT_KPI,\n\t\tAT_DESIRED_FREQUENCY,\n\t\tOVER_DESIRED_FREQUENCY,\n\t\tID_ENVIO_EMAIL,\n\t\tID_ATIV_EMAIL,\n\t\tTIPO_ATIV_EMAIL,\n\t\tDATA_ATIV_EMAIL,\n\t\tPRODUTO,\n\t\tDOCUMENTO_EMAIL,\n\t\tDESC_DOCUMENTO_EMAIL,\n\t\tASSUNTO_EMAIL,\n\t\tPRODUTO_FRANCHISE,\n\t\tFRANCHISE,\n\t\tSUB_CAT_FRANCHISE,\n\t\tPESO_FRANCHISE,\n\t\tEVENTO,\n\t\tID_EVENTO,\n\t\tEV_CICLO,\n\t\tDATA_EVENTO,\n\t\tDATA_EVENTO_2,\n\t\tEV_CICLO_TERRITORIO,\n\t\tEV_CICLO_CONTATO,\n\t\tID_PARTICIPANTE,\n\t\tNOME_PARTICIPANTE,\n\t\tEV_ROW_ID_TERRITORIO,\n\t\tNOME_USUARIO,\n\t\tEV_ROW_ID_CONTATO,\n\t\tDOCUMENTO,\n\t\tEV_ESPECIALIDADE_ENG,\n\t\tSTATUS_CONVIDADO_GR,\n\t\tSTATUS_CONVIDADO,\n\t\tSTATUS_CONVIDADO_ENG,\n\t\tPRODUTO_PRIMARIO,\n\t\tPRODUTO_SECUNDARIO,\n\t\tTIPO_PARTICIPACAO,\n\t\tTIPO_PARTICIPACAO_ENG,\n\t\tTIPO_CONTA,\n\t\tTIPO_CONTA_ENG,\n\t\tVISITADO_SETOR,\n\t\tNOME_SETOR_VISITANTE,\n\t\tEV_ESPECIALIDADE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoFatoInteracao\nLeftJoinRepsZonaFV select(mapColumn(\n\t\tBU,\n\t\tDIVISAO,\n\t\tNOME_GD,\n\t\tNOME_GR,\n\t\tNOME_REPRESENTANTE,\n\t\tMUDID = SelecaoTempForcaVendas@MUDID,\n\t\tROW_ID_TERRITORIO,\n\t\tTERRITORIO,\n\t\tTERRITORIO_GD,\n\t\tTERRITORIO_GR,\n\t\tCICLO_FV,\n\t\tROW_ID_FUNCIONARIO,\n\t\tFLAG_PROJETO,\n\t\tFLAG_TARGET,\n\t\tKEY_TERR_CICLO,\n\t\tKEY_CICLO_TERR_GD,\n\t\tKEY_DIVISAO_CICLO,\n\t\tKEY_MUDID_TERR,\n\t\tKEY_TERR,\n\t\tMUDID = SelecaoTempRepsZona@MUDID,\n\t\tCIDADE_ZONA,\n\t\tUF_ZONA,\n\t\tCHAVE,\n\t\tZONA_COMPLETA,\n\t\tCHAVE_ZONA,\n\t\tZONA\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> DimForcaVendas\nChaveamentoPainelMedico select(mapColumn(\n\t\tCRM_CICLO,\n\t\tMES,\n\t\tCICLO,\n\t\tCRM,\n\t\tMEDICO,\n\t\tTIPO,\n\t\tTIPOCONTATO,\n\t\tGRUPOPROMOCIONAL,\n\t\tESPECIALIDADE,\n\t\tLOGRADOURO,\n\t\tCOMPLEMENTO,\n\t\tBAIRRO,\n\t\tCIDADE,\n\t\tUF,\n\t\tCEP,\n\t\tBRICK,\n\t\tTELEFONEMEDICO,\n\t\tCELULARMEDICO,\n\t\tEMAIL_1_1,\n\t\tROW_ID_FUNCIONARIO,\n\t\tROW_ID_TERRITORIO,\n\t\tROW_ID_CONTATO,\n\t\tSTATUS,\n\t\tQTD_VISITA_PLANEJADA_PAINEL,\n\t\tQTD_VISITA_REALIZADA_PAINEL,\n\t\tESPECIALIDADE_02,\n\t\tESPECIALIDADE_03,\n\t\tVP_PROX,\n\t\tSTATUS_MEDICO,\n\t\tEMAIL_1_1_CONSENT,\n\t\tNETWORK_ID,\n\t\tRX_GIGYA_ID,\n\t\tVEEVA_ID,\n\t\tROW_ID_CONTATO_EXT,\n\t\tEMAIL_MASS,\n\t\tEMAIL_MASS_CONSENT,\n\t\tCYCLE_PLAN,\n\t\tMERCADO,\n\t\tPRODUTO_PAINEL,\n\t\tKEY_TERR_CONT_CICLO,\n\t\tKEY_TERR_CICLO,\n\t\tKEY_CICLO_CRM,\n\t\tDATE_KEY = {% Date Key}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoPainelMedico\nSelecaoFatoInteracao sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tfilePattern:'fato_interacoes_[n].parquet',\n\ttruncate: true,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1) ~> SinkFatoInteracoes\nDimForcaVendas sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_forca_vendas.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimForcaVendas\nChaveamentoHistZona sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_historico_zonas.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimHistoricoZonas\nChaveamentoKPITerr sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_kpi_territorio.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimKpiTerritorio\nChaveamentoCoching sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_coaching.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkCoaching\nChaveamentoMSLDivision sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_msl_division.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimMslDivision\nChaveamentoTargetSRO sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_target_sro.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimTargetSro\nChaveamentoQuadranteMedico sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tfilePattern:'dimensao_quadrante_medico_p_[n].parquet',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimQuadranteMedico\nChaveamentoQuadranteMedicoGP sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tfilePattern:'dimensao_quadrante_medico_gp_[n].parquet',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimQuadranteMedicoGp\nChaveamentoAuditEnd sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_audit_end.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimAuditEnd\nSelecaoPainelMedico sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tfilePattern:'dimensao_painel_medico_[n].parquet',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimPainelMedico"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Dim_Email_1_1_Parquet')]",
				"[concat(variables('workspaceId'), '/linkedServices/AzureBlobStorageSynapse')]",
				"[concat(variables('workspaceId'), '/datasets/Dim_KPI_Vis_Parquet')]",
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]",
				"[concat(variables('workspaceId'), '/datasets/SINK_KPI_EMAIL_ADSL2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/GSO_ETL')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "GSO"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "Fact_GSO_Data_Flow",
								"type": "DatasetReference"
							},
							"name": "fGsoCallSummarySource"
						},
						{
							"dataset": {
								"referenceName": "Fact_GSO_Data_Flow",
								"type": "DatasetReference"
							},
							"name": "fGsoResponseSource"
						},
						{
							"dataset": {
								"referenceName": "Fact_GSO_Data_Flow",
								"type": "DatasetReference"
							},
							"name": "dSalesForceTeradata"
						},
						{
							"dataset": {
								"referenceName": "Fact_GSO_Data_Flow",
								"type": "DatasetReference"
							},
							"name": "dSalesForceFuncionario"
						},
						{
							"dataset": {
								"referenceName": "Fact_GSO_Data_Flow",
								"type": "DatasetReference"
							},
							"name": "dSalesForceSqlServer"
						},
						{
							"dataset": {
								"referenceName": "Fact_GSO_Data_Flow",
								"type": "DatasetReference"
							},
							"name": "dSalesForceRegiao"
						},
						{
							"dataset": {
								"referenceName": "Fact_GSO_Data_Flow",
								"type": "DatasetReference"
							},
							"name": "dSurveyQuestion"
						},
						{
							"dataset": {
								"referenceName": "Fact_GSO_Data_Flow",
								"type": "DatasetReference"
							},
							"name": "dVisits"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "SINK_GSO_ADSL2",
								"type": "DatasetReference"
							},
							"name": "FatoGsoDestino"
						},
						{
							"dataset": {
								"referenceName": "SINK_GSO_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SalesForceDestino"
						},
						{
							"dataset": {
								"referenceName": "SINK_GSO_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimSurveyQuestion"
						},
						{
							"dataset": {
								"referenceName": "SINK_GSO_ADSL2",
								"type": "DatasetReference"
							},
							"name": "SinkDimVisits"
						}
					],
					"transformations": [
						{
							"name": "UniaoFato"
						},
						{
							"name": "LeftJoinFuncionario"
						},
						{
							"name": "SelecionarValoresUnicos"
						},
						{
							"name": "LeftJoinSalesForceSQLSERVER"
						},
						{
							"name": "SelecionarValoresUnicos2"
						},
						{
							"name": "LeftJoinRegiao"
						},
						{
							"name": "SelecaoFinal"
						}
					],
					"script": "source(output(\n\t\tCALL_SUMMARY_ID as string,\n\t\tPARENT_CALL_AID as string,\n\t\tLOCAL_CALL_DATE_ID as string,\n\t\tCALL_DATE_ID as string,\n\t\tTERRITORY_ID as string,\n\t\tCYCLE as string,\n\t\tSALES_FORCE_KEY as string,\n\t\tDATE as string,\n\t\tLOCAL_CALL_TIME_ID as string,\n\t\tACCOUNT_ID as string,\n\t\tCALL_NAME as string,\n\t\tRX_CALL_TYPE as string,\n\t\tCALL_STATUS as string,\n\t\tATTENDEE_TYPE as string,\n\t\tCLM_IND as string,\n\t\tSAMPLE_CALL_IND as string,\n\t\tCALL_TYPE as string,\n\t\tDETAILED_PRODUCTS as string,\n\t\tDURATION as string,\n\t\tCREATED_DATE_ID as string,\n\t\tCREATED_DATE_TIME_ID as string,\n\t\tLAST_MODIFIED_DATE_ID as string,\n\t\tLAST_MODIFIED_DATE_TIME_ID as string,\n\t\tPRE_CALL_NOTES as string,\n\t\tNEXT_CALL_NOTES as string,\n\t\tREVIEW_STATUS as string,\n\t\tACCOUNT_NAME as string,\n\t\tRX_LEGAL_ID as string,\n\t\tKEY_MESSAGE_NAME as string,\n\t\tQUESTION_ID as string,\n\t\tPRODUCT as string,\n\t\tCALL_DATE as string,\n\t\tORIGEM as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/fato_gso_call_summary.parquet'],\n\tpartitionBy('hash', 1)) ~> fGsoCallSummarySource\nsource(output(\n\t\tSURVEY_KEY as string,\n\t\tQUESTION_ID as string,\n\t\tSOURCE_CREATED_TS as string,\n\t\tRESPONSE_LAST_MODIFIED_TS as string,\n\t\tSOURCE_USER_AID as string,\n\t\tQUESTION_RESPONSE_ID as string,\n\t\tRESPONSE_NAME as string,\n\t\tRESPONSE_NUMBER as string,\n\t\tRESPONSE as string,\n\t\tPRODUCT as string,\n\t\tRESPONSE_QUESTION_ORDER as string,\n\t\tDATE as string,\n\t\tTARGET_LAST_MODIFIED_TS as string,\n\t\tMODIFIED_DATE as string,\n\t\tSTART_DATE_ID as string,\n\t\tEND_DATE_ID as string,\n\t\tREVIEW_DATE_ID as string,\n\t\tREVIEW_STATUS as string,\n\t\tMANAGER_TERRITORY_ID as string,\n\t\tEMPLOYEE_TERRITORY_ID as string,\n\t\tTERRITORY_ID as string,\n\t\tDATE_DIFF as string,\n\t\tFLAG_PREMIO as string,\n\t\tSALES_FORCE_KEY as string,\n\t\tRESPONSES_KEY as string,\n\t\tORIGEM as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/fato_gso_response.parquet'],\n\tpartitionBy('hash', 1)) ~> fGsoResponseSource\nsource(output(\n\t\tRX_EXTERNAL_ID as string,\n\t\tUSER_ID as string,\n\t\tSF_SOURCE_USER_AID as string,\n\t\tUSER_NAME as string,\n\t\tFIRST_NAME as string,\n\t\tNAME as string,\n\t\tLAST_NAME as string,\n\t\tCOUNTRY as string,\n\t\tSTATE_PROVINCE as string,\n\t\tCITY as string,\n\t\tPOSTAL_CODE as string,\n\t\tACTIVE_IND as string,\n\t\tEMAIL as string,\n\t\tEMPLOYEE_NUMBER_AID as string,\n\t\tUSER_IDENTIFIER_AID as string,\n\t\tCORE_GSK_FUNCTIONAL_PROFILE as string,\n\t\tPROFILE_NAME as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_sales_force_teradata.parquet'],\n\tpartitionBy('hash', 1)) ~> dSalesForceTeradata\nsource(output(\n\t\tRX_EXTERNAL_ID as string,\n\t\tUF as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_sales_force_funcionario.parquet'],\n\tpartitionBy('hash', 1)) ~> dSalesForceFuncionario\nsource(output(\n\t\tRX_EXTERNAL_ID as string,\n\t\tCICLO as string,\n\t\tSALES_FORCE_KEY as string,\n\t\tSF_KEY as string,\n\t\tROW_ID_TERRITORIO as string,\n\t\tROW_ID_GD as string,\n\t\tNOME_GD as string,\n\t\tNOME_GR as string,\n\t\tTERRITORIO_GD as string,\n\t\tTERRITORIO_GR as string,\n\t\tBU as string,\n\t\t{DIVIS√ÉO} as string,\n\t\tTERRITORIO as string,\n\t\tNOME_REP as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_sales_force_sqlserver.parquet'],\n\tpartitionBy('hash', 1)) ~> dSalesForceSqlServer\nsource(output(\n\t\tAREA as string,\n\t\tUF as string,\n\t\tREGION as string,\n\t\tSTATE as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_region.parquet'],\n\tpartitionBy('hash', 1)) ~> dSalesForceRegiao\nsource(output(\n\t\tQUESTION_ID as string,\n\t\tQUESTION_CREATED_DATE as string,\n\t\tQUESTION_NAME as string,\n\t\tQUESTION_LAST_MODIFIED_TS as string,\n\t\tQUESTION_TEXT as string,\n\t\tQUESTION_ORDER as string,\n\t\tQUESTION_TYPE as string,\n\t\tTIPO_QUESTAO as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_survey_question.parquet']) ~> dSurveyQuestion\nsource(output(\n\t\tSURVEY_KEY as string,\n\t\tVISIT_DATE as string,\n\t\tVISIT_PRODUCT as string,\n\t\tTOTAL_VISITS as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.gso/dim_visits.parquet']) ~> dVisits\nfGsoResponseSource, fGsoCallSummarySource union(byName: true,\n\tpartitionBy('hash', 1))~> UniaoFato\ndSalesForceTeradata, dSalesForceFuncionario join(dSalesForceTeradata@RX_EXTERNAL_ID == dSalesForceFuncionario@RX_EXTERNAL_ID,\n\tjoinType:'left',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> LeftJoinFuncionario\nLeftJoinFuncionario select(mapColumn(\n\t\tRX_EXTERNAL_ID = dSalesForceTeradata@RX_EXTERNAL_ID,\n\t\tUSER_ID,\n\t\tSF_SOURCE_USER_AID,\n\t\tUSER_NAME,\n\t\tFIRST_NAME,\n\t\tNAME,\n\t\tLAST_NAME,\n\t\tCOUNTRY,\n\t\tSTATE_PROVINCE,\n\t\tCITY,\n\t\tPOSTAL_CODE,\n\t\tACTIVE_IND,\n\t\tEMAIL,\n\t\tEMPLOYEE_NUMBER_AID,\n\t\tUSER_IDENTIFIER_AID,\n\t\tCORE_GSK_FUNCTIONAL_PROFILE,\n\t\tPROFILE_NAME,\n\t\tRX_EXTERNAL_ID = dSalesForceFuncionario@RX_EXTERNAL_ID,\n\t\tUF\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecionarValoresUnicos\nSelecionarValoresUnicos, dSalesForceSqlServer join(SelecionarValoresUnicos@RX_EXTERNAL_ID == dSalesForceSqlServer@RX_EXTERNAL_ID,\n\tjoinType:'left',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> LeftJoinSalesForceSQLSERVER\nLeftJoinSalesForceSQLSERVER select(mapColumn(\n\t\tRX_EXTERNAL_ID = SelecionarValoresUnicos@RX_EXTERNAL_ID,\n\t\tUSER_ID,\n\t\tSF_SOURCE_USER_AID,\n\t\tUSER_NAME,\n\t\tFIRST_NAME,\n\t\tNAME,\n\t\tLAST_NAME,\n\t\tCOUNTRY,\n\t\tSTATE_PROVINCE,\n\t\tCITY,\n\t\tPOSTAL_CODE,\n\t\tACTIVE_IND,\n\t\tEMAIL,\n\t\tEMPLOYEE_NUMBER_AID,\n\t\tUSER_IDENTIFIER_AID,\n\t\tCORE_GSK_FUNCTIONAL_PROFILE,\n\t\tPROFILE_NAME,\n\t\tUF,\n\t\tRX_EXTERNAL_ID = dSalesForceSqlServer@RX_EXTERNAL_ID,\n\t\tCICLO,\n\t\tSALES_FORCE_KEY,\n\t\tSF_KEY,\n\t\tROW_ID_TERRITORIO,\n\t\tROW_ID_GD,\n\t\tNOME_GD,\n\t\tNOME_GR,\n\t\tTERRITORIO_GD,\n\t\tTERRITORIO_GR,\n\t\tBU,\n\t\tDIVISAO = {DIVIS√ÉO},\n\t\tTERRITORIO,\n\t\tNOME_REP\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecionarValoresUnicos2\nSelecionarValoresUnicos2, dSalesForceRegiao join(SelecionarValoresUnicos2@UF == dSalesForceRegiao@UF,\n\tjoinType:'left',\n\tpartitionBy('hash', 1),\n\tbroadcast: 'auto')~> LeftJoinRegiao\nLeftJoinRegiao select(mapColumn(\n\t\tRX_EXTERNAL_ID,\n\t\tUSER_ID,\n\t\tSF_SOURCE_USER_AID,\n\t\tUSER_NAME,\n\t\tFIRST_NAME,\n\t\tNAME,\n\t\tLAST_NAME,\n\t\tCOUNTRY,\n\t\tSTATE_PROVINCE,\n\t\tCITY,\n\t\tPOSTAL_CODE,\n\t\tACTIVE_IND,\n\t\tEMAIL,\n\t\tEMPLOYEE_NUMBER_AID,\n\t\tUSER_IDENTIFIER_AID,\n\t\tCORE_GSK_FUNCTIONAL_PROFILE,\n\t\tPROFILE_NAME,\n\t\tUF = SelecionarValoresUnicos2@UF,\n\t\tCICLO,\n\t\tSALES_FORCE_KEY,\n\t\tSF_KEY,\n\t\tROW_ID_TERRITORIO,\n\t\tROW_ID_GD,\n\t\tNOME_GD,\n\t\tNOME_GR,\n\t\tTERRITORIO_GD,\n\t\tTERRITORIO_GR,\n\t\tBU,\n\t\tDIVISAO,\n\t\tTERRITORIO,\n\t\tNOME_REP,\n\t\tAREA,\n\t\tUF = SelecionarValoresUnicos2@UF,\n\t\tREGION,\n\t\tSTATE\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoFinal\nUniaoFato sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['fato_gso.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1) ~> FatoGsoDestino\nSelecaoFinal sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_sales_force.parquet'],\n\tmapColumn(\n\t\tRX_EXTERNAL_ID,\n\t\tUSER_ID,\n\t\tSF_SOURCE_USER_AID,\n\t\tUSER_NAME,\n\t\tFIRST_NAME,\n\t\tNAME,\n\t\tLAST_NAME,\n\t\tCOUNTRY,\n\t\tSTATE_PROVINCE,\n\t\tCITY,\n\t\tPOSTAL_CODE,\n\t\tACTIVE_IND,\n\t\tEMAIL,\n\t\tEMPLOYEE_NUMBER_AID,\n\t\tUSER_IDENTIFIER_AID,\n\t\tCORE_GSK_FUNCTIONAL_PROFILE,\n\t\tPROFILE_NAME,\n\t\tUF,\n\t\tCICLO,\n\t\tSALES_FORCE_KEY,\n\t\tSF_KEY,\n\t\tROW_ID_TERRITORIO,\n\t\tROW_ID_GD,\n\t\tNOME_GD,\n\t\tNOME_GR,\n\t\tTERRITORIO_GD,\n\t\tTERRITORIO_GR,\n\t\tBU,\n\t\tDIVISAO,\n\t\tTERRITORIO,\n\t\tNOME_REP,\n\t\tAREA,\n\t\tREGION,\n\t\tSTATE\n\t),\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SalesForceDestino\ndSurveyQuestion sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_survey_question.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimSurveyQuestion\ndVisits sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tpartitionFileNames:['dimensao_visits.parquet'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimVisits"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/Fact_GSO_Data_Flow')]",
				"[concat(variables('workspaceId'), '/datasets/SINK_GSO_ADSL2')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_ETL')]",
			"type": "Microsoft.Synapse/workspaces/dataflows",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO"
				},
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"linkedService": {
								"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
								"type": "LinkedServiceReference"
							},
							"name": "DimTopIndependentes"
						},
						{
							"dataset": {
								"referenceName": "Source_Dim_KPI",
								"type": "DatasetReference"
							},
							"name": "DimPainelMedico"
						},
						{
							"dataset": {
								"referenceName": "Source_Dim_KPI",
								"type": "DatasetReference"
							},
							"name": "FatoVisitasRealizadas"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "Sink_KPI_Visitacao",
								"type": "DatasetReference"
							},
							"name": "SinkDimPainelMedico"
						},
						{
							"dataset": {
								"referenceName": "Sink_KPI_Visitacao",
								"type": "DatasetReference"
							},
							"name": "SinkFatoVisitasRealizadas"
						}
					],
					"transformations": [
						{
							"name": "CriandoColunaTopIndFlag"
						},
						{
							"name": "ChavemamentoTopIndependente"
						},
						{
							"name": "LeftJoinPainelMedTopIndependente"
						},
						{
							"name": "CondicaoTopIndFlag"
						},
						{
							"name": "SelecaoFinal"
						},
						{
							"name": "TransformarEmData"
						},
						{
							"name": "SelecaoFatoFinal"
						}
					],
					"script": "source(output(\n\t\tCNPJ as string,\n\t\tGRI as string,\n\t\tREP as string,\n\t\t{RAZAO SOCIAL} as string,\n\t\tENDERECO as string,\n\t\tBAIRRO as string,\n\t\tCIDADE as string,\n\t\tUF as string,\n\t\tSTATUS as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'excel',\n\tfileSystem: 'gsksynapsestorage',\n\tfolderPath: 'synapse/workspaces/gsk-synapse/warehouse/aux.tabelas_auxiliares',\n\tfileName: 'CNPJS TOP INDEPENDENTES - RI.xlsx',\n\tsheetName: 'LISTA CNPJs',\n\tfirstRowAsHeader: true) ~> DimTopIndependentes\nsource(output(\n\t\tCICLO_TERRITORIO_CONTATO as string,\n\t\tPAINEL_CICLO as string,\n\t\tPAINEL_CICLO_ATUAL as string,\n\t\tPAINEL_ROW_ID_TERRITORIO as string,\n\t\tCICLO_TERRITORIO_DIVISAO as string,\n\t\tDOCUMENTO as string,\n\t\tBRICK as string,\n\t\tMEDICO as string,\n\t\tDOC_NAME as string,\n\t\tGRUPOPROMOCIONAL as string,\n\t\tESPECIALIDADE as string,\n\t\tTIPOCONTATO as string,\n\t\tCOMPLEMENTO as string,\n\t\tCEP as string,\n\t\tLOGRADOURO as string,\n\t\tBAIRRO as string,\n\t\tCIDADE as string,\n\t\tUF as string,\n\t\tEMAIL_1_1 as string,\n\t\tEMAIL_MASS as string,\n\t\tTELEFONEMEDICO as string,\n\t\tCELULARMEDICO as string,\n\t\tULTALTCONTATO as string,\n\t\tUFDOCUMENTO as string,\n\t\tNUMERODOCUMENTO as string,\n\t\tPAINEL_ROW_ID_CONTATO as string,\n\t\tPAINEL_ROW_ID_GRUPOPROMOCIONAL as string,\n\t\tPAINEL_ROW_ID_DIVISAO as string,\n\t\tPAINEL_ROW_ID_FUNCIONARIO as string,\n\t\tPAINEL_DIVISAO as string,\n\t\tPERSON_UID as string,\n\t\tORIGEM_DADOS as string,\n\t\tDATA_CARGA as string,\n\t\tPAINEL_STATUS as string,\n\t\tTIPO as string,\n\t\tBRICK_NOME as string,\n\t\tSITUACAO as string,\n\t\tFLG_OFICIAL_GOVERNO as string,\n\t\tESPECIALIDADE_02 as string,\n\t\tESPECIALIDADE_03 as string,\n\t\tROW_ID_ENDERECO as string,\n\t\tCPF as string,\n\t\tORIGEM_END as string,\n\t\tNETWORKID as string,\n\t\tDOCUMENTO_VEEVA as string,\n\t\tFLG_MEDICO_AUDIT as string,\n\t\tESPEC_CYCLE_PLAN as string,\n\t\tSTATUS_MEDICO as string,\n\t\tEMAIL_1_1_CONSENT as string,\n\t\tEMAIL_MASS_CONSENT as string,\n\t\tCOMENTARIO as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao/dim_painel_medico.parquet']) ~> DimPainelMedico\nsource(output(\n\t\tVISITA as string,\n\t\tCICLO_TERRITORIO_CONTATO as string,\n\t\tCICLO_TERRITORIO_DIVISAO as string,\n\t\tDATA as string,\n\t\tDATA_VISITA as string,\n\t\tVISITA_ID as string,\n\t\tCICLO as string,\n\t\tVR_TIPO as string,\n\t\tQTD_VISITA_REALIZADA as string,\n\t\tORIGEM as string,\n\t\tMUDID as string,\n\t\tID_PROPRIETARIO as string,\n\t\tPOSICAO_PROPRIETARIO as string,\n\t\tTODO_CD as string,\n\t\tROW_ID_CONTATO as string,\n\t\tTIPO_VISITA as string,\n\t\tGP as string,\n\t\tFLAG_CLM as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'parquet',\n\twildcardPaths:['synapse/workspaces/gsk-synapse/warehouse/dash.kpi_visitacao/fato_visitas_realizadas.parquet']) ~> FatoVisitasRealizadas\nDimTopIndependentes derive(TOP_IND_FLAG = 'S') ~> CriandoColunaTopIndFlag\nCriandoColunaTopIndFlag select(mapColumn(\n\t\tDOCUMENTO = CNPJ,\n\t\tTOP_IND_FLAG\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ChavemamentoTopIndependente\nDimPainelMedico, ChavemamentoTopIndependente join(DimPainelMedico@DOCUMENTO == ChavemamentoTopIndependente@DOCUMENTO,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> LeftJoinPainelMedTopIndependente\nLeftJoinPainelMedTopIndependente derive(TOP_IND_FLAG = case(isNull(TOP_IND_FLAG),'N',TOP_IND_FLAG)) ~> CondicaoTopIndFlag\nCondicaoTopIndFlag select(mapColumn(\n\t\tCICLO_TERRITORIO_CONTATO,\n\t\tPAINEL_CICLO,\n\t\tPAINEL_CICLO_ATUAL,\n\t\tPAINEL_ROW_ID_TERRITORIO,\n\t\tCICLO_TERRITORIO_DIVISAO,\n\t\tDOCUMENTO = DimPainelMedico@DOCUMENTO,\n\t\tBRICK,\n\t\tMEDICO,\n\t\tDOC_NAME,\n\t\tGRUPOPROMOCIONAL,\n\t\tESPECIALIDADE,\n\t\tTIPOCONTATO,\n\t\tCOMPLEMENTO,\n\t\tCEP,\n\t\tLOGRADOURO,\n\t\tBAIRRO,\n\t\tCIDADE,\n\t\tUF,\n\t\tEMAIL_1_1,\n\t\tEMAIL_MASS,\n\t\tTELEFONEMEDICO,\n\t\tCELULARMEDICO,\n\t\tULTALTCONTATO,\n\t\tUFDOCUMENTO,\n\t\tNUMERODOCUMENTO,\n\t\tPAINEL_ROW_ID_CONTATO,\n\t\tPAINEL_ROW_ID_GRUPOPROMOCIONAL,\n\t\tPAINEL_ROW_ID_DIVISAO,\n\t\tPAINEL_ROW_ID_FUNCIONARIO,\n\t\tPAINEL_DIVISAO,\n\t\tPERSON_UID,\n\t\tORIGEM_DADOS,\n\t\tDATA_CARGA,\n\t\tPAINEL_STATUS,\n\t\tTIPO,\n\t\tBRICK_NOME,\n\t\tSITUACAO,\n\t\tFLG_OFICIAL_GOVERNO,\n\t\tESPECIALIDADE_02,\n\t\tESPECIALIDADE_03,\n\t\tROW_ID_ENDERECO,\n\t\tCPF,\n\t\tORIGEM_END,\n\t\tNETWORKID,\n\t\tDOCUMENTO_VEEVA,\n\t\tFLG_MEDICO_AUDIT,\n\t\tESPEC_CYCLE_PLAN,\n\t\tSTATUS_MEDICO,\n\t\tEMAIL_1_1_CONSENT,\n\t\tEMAIL_MASS_CONSENT,\n\t\tCOMENTARIO,\n\t\tDOCUMENTO = DimPainelMedico@DOCUMENTO,\n\t\tTOP_IND_FLAG\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoFinal\nFatoVisitasRealizadas derive(DATA = toDate(DATA),\n\t\tDATA_VISITA = toDate(DATA_VISITA)) ~> TransformarEmData\nTransformarEmData select(mapColumn(\n\t\tVISITA,\n\t\tCICLO_TERRITORIO_CONTATO,\n\t\tCICLO_TERRITORIO_DIVISAO,\n\t\tDATA,\n\t\tDATA_VISITA,\n\t\tVISITA_ID,\n\t\tCICLO,\n\t\tVR_TIPO,\n\t\tQTD_VISITA_REALIZADA,\n\t\tORIGEM,\n\t\tMUDID,\n\t\tID_PROPRIETARIO,\n\t\tPOSICAO_PROPRIETARIO,\n\t\tTODO_CD,\n\t\tROW_ID_CONTATO,\n\t\tTIPO_VISITA,\n\t\tGP,\n\t\tFLAG_CLM\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> SelecaoFatoFinal\nSelecaoFinal sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tfilePattern:'dimensao_painel_medico[n].parquet',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 2) ~> SinkDimPainelMedico\nSelecaoFatoFinal sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tfilePattern:'fato_visitas_realizadas[n].parquet',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tsaveOrder: 1) ~> SinkFatoVisitasRealizadas"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]",
				"[concat(variables('workspaceId'), '/datasets/Source_Dim_KPI')]",
				"[concat(variables('workspaceId'), '/datasets/Sink_KPI_Visitacao')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/WorkspaceSystemIdentity')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/GSO_CREATE_VIEW_DIM_SALES_FORCE')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "GSO"
				},
				"content": {
					"query": "-- ALTER VIEW gso.dim_sales_force\n-- AS\n\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/GSO/dimensao_sales_force.parquet',\n        FORMAT='PARQUET'\n    ) WITH( USER_ID                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            SF_SOURCE_USER_AID              VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            [USER_NAME]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            FIRST_NAME                      VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            [NAME]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            LAST_NAME                       VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            COUNTRY                         CHAR(2) COLLATE Latin1_General_100_BIN2_UTF8,\n            STATE_PROVINCE                  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            CITY                            VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            POSTAL_CODE                     VARCHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,\n            ACTIVE_IND                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            EMAIL                           VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            EMPLOYEE_NUMBER_AID           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8 ,\n            USER_IDENTIFIER_AID             VARCHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,\n            CORE_GSK_FUNCTIONAL_PROFILE     VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            PROFILE_NAME                    VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            CICLO                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8 ,\n            SALES_FORCE_KEY                 VARCHAR(15) COLLATE Latin1_General_100_BIN2_UTF8,\n            ROW_ID_TERRITORIO               VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            ROW_ID_GD                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            NOME_GD                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            NOME_GR                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            TERRITORIO_GD                   VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            TERRITORIO_GR                   VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            BU                              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            DIVISAO                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            TERRITORIO                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            NOME_REP                        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8,\n            AREA                            VARCHAR(MAX) COLLATE Latin1_General_100_BIN2_UTF8,\n            UF                              CHAR(2) COLLATE Latin1_General_100_BIN2_UTF8,\n            REGION                          VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8,\n            [STATE]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8 \n            \n        ) AS ROW",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/GSO_CREATE_VIEW_DIM_SURVEY_QUESTION')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "GSO"
				},
				"content": {
					"query": "ALTER VIEW gso.dim_survey_question\nAS\n\nSELECT\n     [QUESTION_ID] COLLATE Latin1_General_100_BIN2_UTF8 as [QUESTION_ID]\n    ,CAST(LEFT(QUESTION_CREATED_DATE,19) AS DATETIME) as [QUESTION_CREATED_DATE]\n    ,[QUESTION_NAME] COLLATE Latin1_General_100_BIN2_UTF8 as [QUESTION_NAME]\n    ,CAST(LEFT([QUESTION_LAST_MODIFIED_TS] ,19) AS DATETIME) as [QUESTION_LAST_MODIFIED_TS]\n    ,[QUESTION_TEXT]  COLLATE Latin1_General_100_BIN2_UTF8 as [QUESTION_TEXT]\n    ,[QUESTION_ORDER] COLLATE Latin1_General_100_BIN2_UTF8 as [QUESTION_ORDER]\n    ,[QUESTION_TYPE] COLLATE Latin1_General_100_BIN2_UTF8 as [QUESTION_TYPE]\n    ,[TIPO_QUESTAO] COLLATE Latin1_General_100_BIN2_UTF8 as [TIPO_QUESTAO]\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/GSO/dimensao_survey_question.parquet',\n        FORMAT='PARQUET') \n        WITH( [QUESTION_ID] VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,QUESTION_CREATED_DATE VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[QUESTION_NAME] VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[QUESTION_LAST_MODIFIED_TS] VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[QUESTION_TEXT]  VARCHAR(MAX) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[QUESTION_ORDER] VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[QUESTION_TYPE] VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[TIPO_QUESTAO] VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8 ) as ROW\n           \n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/GSO_CREATE_VIEW_DIM_VISITS')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "GSO"
				},
				"content": {
					"query": "-- ALTER VIEW gso.dim_visits\n-- AS\n\nSELECT\n     [SURVEY_KEY]\n    ,CAST(left([VISIT_DATE],10) as date) as [VISIT_DATE]\n    ,[VISIT_PRODUCT]\n    ,CAST([TOTAL_VISITS] as int) as [TOTAL_VISITS]\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/GSO/dimensao_visits.parquet',\n        FORMAT='PARQUET'\n    ) WITH( \n             [SURVEY_KEY]       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8 \n            ,[VISIT_DATE]       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[VISIT_PRODUCT]    VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[TOTAL_VISITS]     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8 ) as ROW\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/GSO_CREATE_VIEW_FATO_GSO')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "GSO"
				},
				"content": {
					"query": "-- ALTER VIEW gso.fato_gso\n-- AS\n\nSELECT\n    [CALL_SUMMARY_ID]\n    ,[PARENT_CALL_AID]\n    ,[LOCAL_CALL_DATE_ID]\n    ,[CALL_DATE_ID]\n    ,[TERRITORY_ID]\n    ,[CYCLE]\n    ,[SALES_FORCE_KEY]\n    ,CASE\n    WHEN LEN([DATE]) = 6 then CAST(CONCAT(left([DATE],4),'-',right([DATE],2),'-01') as DATE)\n    ELSE CAST(left([DATE],10) AS DATE) END AS 'DATE'\n    ,[LOCAL_CALL_TIME_ID]\n    ,[ACCOUNT_ID]\n    ,[CALL_NAME]\n    ,[RX_CALL_TYPE]\n    ,[CALL_STATUS]\n    ,[ATTENDEE_TYPE]\n    ,[CLM_IND]\n    ,[SAMPLE_CALL_IND]\n    ,[CALL_TYPE]\n    ,[DETAILED_PRODUCTS]\n    ,[DURATION]\n    ,[CREATED_DATE_ID]\n    ,[CREATED_DATE_TIME_ID]\n    ,[LAST_MODIFIED_DATE_ID]\n    ,[LAST_MODIFIED_DATE_TIME_ID]\n    ,[PRE_CALL_NOTES]\n    ,[NEXT_CALL_NOTES]\n    ,[REVIEW_STATUS]\n    ,[ACCOUNT_NAME]\n    ,[RX_LEGAL_ID]\n    ,[KEY_MESSAGE_NAME]\n    ,[QUESTION_ID]\n    ,[PRODUCT]\n    ,[CALL_DATE]\n    ,[ORIGEM]\n    ,[SURVEY_KEY]\n    ,CAST(left([SOURCE_CREATED_TS],19) as DATETIME) AS [SOURCE_CREATED_TS]\n    ,CAST(left([RESPONSE_LAST_MODIFIED_TS],19) as DATETIME) AS [RESPONSE_LAST_MODIFIED_TS]\n    ,[SOURCE_USER_AID]\n    ,[QUESTION_RESPONSE_ID]\n    ,[RESPONSE_NAME]\n    ,CAST([RESPONSE_NUMBER] as INT) as [RESPONSE_NUMBER]\n    ,[RESPONSE]\n    ,[RESPONSE_QUESTION_ORDER]\n    ,CAST(left([TARGET_LAST_MODIFIED_TS],19) as DATETIME) AS [TARGET_LAST_MODIFIED_TS]\n    ,CAST(left([MODIFIED_DATE],10) as DATE) AS [MODIFIED_DATE]\n    ,[START_DATE_ID]\n    ,[END_DATE_ID]\n    ,[REVIEW_DATE_ID]\n    ,[MANAGER_TERRITORY_ID]\n    ,[EMPLOYEE_TERRITORY_ID]\n    ,CAST([DATE_DIFF] as INT) as [DATE_DIFF]\n    ,[FLAG_PREMIO]\n    ,[RESPONSES_KEY]\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/GSO/fato_gso.parquet',\n        FORMAT='PARQUET'\n    ) WITH(\n\t[CALL_SUMMARY_ID]                    VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[PARENT_CALL_AID]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[LOCAL_CALL_DATE_ID]                VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_DATE_ID]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[TERRITORY_ID]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CYCLE]                             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SALES_FORCE_KEY]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[DATE]                              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[LOCAL_CALL_TIME_ID]                VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[ACCOUNT_ID]                        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_NAME]                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RX_CALL_TYPE]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_STATUS]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[ATTENDEE_TYPE]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CLM_IND]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SAMPLE_CALL_IND]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_TYPE]                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[DETAILED_PRODUCTS]                 VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[DURATION]                          VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CREATED_DATE_ID]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CREATED_DATE_TIME_ID]              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[LAST_MODIFIED_DATE_ID]             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[LAST_MODIFIED_DATE_TIME_ID]        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[PRE_CALL_NOTES]                    VARCHAR(MAX) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[NEXT_CALL_NOTES]                   VARCHAR(MAX) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[REVIEW_STATUS]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[ACCOUNT_NAME]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RX_LEGAL_ID]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[KEY_MESSAGE_NAME]                  VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[QUESTION_ID]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[PRODUCT]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_DATE]                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[ORIGEM]                            VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SURVEY_KEY]                        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SOURCE_CREATED_TS]                 VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE_LAST_MODIFIED_TS]         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SOURCE_USER_AID]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[QUESTION_RESPONSE_ID]              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE_NAME]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE_NUMBER]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE]                          VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE_QUESTION_ORDER]           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[TARGET_LAST_MODIFIED_TS]           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[MODIFIED_DATE]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[START_DATE_ID]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[END_DATE_ID]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[REVIEW_DATE_ID]                    VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[MANAGER_TERRITORY_ID]              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[EMPLOYEE_TERRITORY_ID]             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[DATE_DIFF]                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[FLAG_PREMIO]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSES_KEY]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8 ) AS ROW\n\n-- ¬†SELECT¬†column_name,\n-- ¬†¬†¬†¬†¬†¬†¬†data_type,\n-- ¬†¬†¬†¬†¬†¬†¬†character_maximum_length,\n-- ¬†¬†¬†¬†¬†¬†¬†table_name\n-- FROM¬†information_schema.columns\n-- WHERE ¬†¬†¬†¬†¬†¬†¬†table_name like '%fato%'\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_AUDIT_END')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- ALTER VIEW kpiemail.dim_audit_end\n-- AS\nSELECT\n    [CRM_UNIV]\n,[MEDICO_UNIV]\n,[ESPECIALIDADE_UNIV]\n,[LOGRADOURO_UNIV]\n,[BAIRRO_UNIV]\n,[CIDADE_UNIV]\n,[CEP_UNIV]\n,[ORIGEM_UNIV]\n,[UF_UNIV]\n,[BRICK_UNIV]\n,[TELEFONE_UNIV]\n,[KEY_CRM_UNIV]\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_audit_end.parquet',\n        FORMAT='PARQUET'\n    ) WITH (\n [CRM_UNIV]      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[MEDICO_UNIV]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ESPECIALIDADE_UNIV]\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[LOGRADOURO_UNIV]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[BAIRRO_UNIV]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CIDADE_UNIV]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CEP_UNIV]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ORIGEM_UNIV]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[UF_UNIV]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[BRICK_UNIV]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TELEFONE_UNIV]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_CRM_UNIV]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ) AS ROW\n\n-- SELECT collation_name\n-- FROM sys.databases\n-- WHERE database_id = DB_ID()\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_COACHING')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- CREATE VIEW kpiemail.dim_coaching\n-- AS\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_coaching.parquet',\n        FORMAT='PARQUET'\n    ) AS [result]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_FORCA_VENDAS')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- ALTER VIEW kpiemail.dim_forca_vendas\n-- AS\nSELECT\n    [BU]\n,[DIVISAO]\n,[NOME_GD]\n,[NOME_GR]\n,[NOME_REPRESENTANTE]\n,[MUDID]\n,[ROW_ID_TERRITORIO]\n,[TERRITORIO]\n,[TERRITORIO_GD]\n,[TERRITORIO_GR]\n,[CICLO_FV]\n,[ROW_ID_FUNCIONARIO]\n,[FLAG_PROJETO]\n,[FLAG_TARGET]\n,[KEY_TERR_CICLO]\n,[KEY_CICLO_TERR_GD]\n,[KEY_DIVISAO_CICLO]\n,[KEY_MUDID_TERR]\n,[KEY_TERR]\n,[CIDADE_ZONA]\n,[UF_ZONA]\n,[CHAVE]\n,[ZONA_COMPLETA]\n,[CHAVE_ZONA]\n,[ZONA]\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_forca_vendas.parquet',\n        FORMAT='PARQUET'\n    ) WITH (\n       [BU]\t\t\t\t\t\t VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[DIVISAO]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[NOME_GD]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[NOME_GR]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[NOME_REPRESENTANTE]        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[MUDID]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ROW_ID_TERRITORIO]         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TERRITORIO]                VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TERRITORIO_GD]             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TERRITORIO_GR]             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CICLO_FV]                  VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ROW_ID_FUNCIONARIO]        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[FLAG_PROJETO]              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[FLAG_TARGET]               VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_TERR_CICLO]            VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_CICLO_TERR_GD]         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_DIVISAO_CICLO]         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_MUDID_TERR]            VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_TERR]                  VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CIDADE_ZONA]               VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[UF_ZONA]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CHAVE]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ZONA_COMPLETA]             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CHAVE_ZONA]                VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ZONA]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ) AS ROW\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_HISTORICO_ZONAS')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- ALTER VIEW kpiemail.dim_historico_zonas\n-- as\nSELECT\n   [CHAVE_ZONA]\n,[DATA_ZONA]\n,[STATUS_ZONA]\n,[NUM_DATA_ZONA]\n,[MES_ZONA] \nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_historico_zonas.parquet',\n        FORMAT='PARQUET'\n    ) WITH ([CHAVE_ZONA]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[DATA_ZONA]            VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[STATUS_ZONA]          VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[NUM_DATA_ZONA]        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n            ,[MES_ZONA]             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8) AS ROW\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_KPI_TERRITORIO')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- CREATE VIEW kpiemail.dim_kpi_territorio\n-- AS\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_kpi_territorio.parquet',\n        FORMAT='PARQUET'\n    ) AS [result]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_MSL_DIVISION')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- CREATE VIEW kpiemail.dim_msl_division\n-- AS\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_msl_division.parquet',\n        FORMAT='PARQUET'\n    ) AS [result]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_PAINEL_MEDICO')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- ALTER VIEW kpiemail.dim_painel_medico\n-- as\nSELECT\n     [CRM_CICLO]\n,[MES]\n,[CICLO]\n,[CRM]\n,[MEDICO]\n,[TIPO]\n,[TIPOCONTATO]\n,[GRUPOPROMOCIONAL]\n,[ESPECIALIDADE]\n,[LOGRADOURO]\n,[COMPLEMENTO]\n,[BAIRRO]\n,[CIDADE]\n,[UF]\n,[CEP]\n,[BRICK]\n,[TELEFONEMEDICO]\n,[CELULARMEDICO]\n,[EMAIL_1_1]\n,[ROW_ID_FUNCIONARIO]\n,[ROW_ID_TERRITORIO]\n,[ROW_ID_CONTATO]\n,[STATUS]\n,[QTD_VISITA_PLANEJADA_PAINEL]\n,[QTD_VISITA_REALIZADA_PAINEL]\n,[ESPECIALIDADE_02]\n,[ESPECIALIDADE_03]\n,[VP_PROX]\n,[STATUS_MEDICO]\n,[EMAIL_1_1_CONSENT]\n,[NETWORK_ID]\n,[RX_GIGYA_ID]\n,[VEEVA_ID]\n,[ROW_ID_CONTATO_EXT]\n,[EMAIL_MASS]\n,[EMAIL_MASS_CONSENT]\n,[CYCLE_PLAN]\n,[MERCADO]\n,[PRODUTO_PAINEL]\n,[KEY_TERR_CONT_CICLO]\n,[KEY_TERR_CICLO]\n,[KEY_CICLO_CRM]\n,[DATE_KEY]\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_painel_medico_*.parquet',\n        FORMAT='PARQUET'\n    ) WITH (\n        [CRM_CICLO]             \t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[MES]                              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CICLO]                            VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CRM]                              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[MEDICO]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPO]                             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPOCONTATO]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[GRUPOPROMOCIONAL]                 VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ESPECIALIDADE]                    VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[LOGRADOURO]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[COMPLEMENTO]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[BAIRRO]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CIDADE]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[UF]                               VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CEP]                              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[BRICK]                            VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TELEFONEMEDICO]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CELULARMEDICO]                    VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EMAIL_1_1]                        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ROW_ID_FUNCIONARIO]               VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ROW_ID_TERRITORIO]                VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ROW_ID_CONTATO]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[STATUS]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[QTD_VISITA_PLANEJADA_PAINEL]      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[QTD_VISITA_REALIZADA_PAINEL]      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ESPECIALIDADE_02]                 VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ESPECIALIDADE_03]                 VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[VP_PROX]                          VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[STATUS_MEDICO]                    VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EMAIL_1_1_CONSENT]                VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[NETWORK_ID]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[RX_GIGYA_ID]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[VEEVA_ID]                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ROW_ID_CONTATO_EXT]               VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EMAIL_MASS]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EMAIL_MASS_CONSENT]               VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CYCLE_PLAN]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[MERCADO]                          VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[PRODUTO_PAINEL]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_TERR_CONT_CICLO]              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_TERR_CICLO]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_CICLO_CRM]\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[DATE_KEY]  DATE ) AS ROW\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_QUADRANTE_MEDICO')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- CREATE VIEW kpiemail.dim_quadrante_medico\n-- as\nSELECT\n    *\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_quadrante_medico_p_*.parquet',\n        FORMAT='PARQUET'\n    ) as [result]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_QUADRANTE_MEDICO_GP')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- CREATE VIEW kpiemail.dim_quadrante_medico_gp\n-- as\nSELECT\n     *\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_quadrante_medico_gp_*.parquet',\n        FORMAT='PARQUET'\n    ) AS [result]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_DIM_TARGET_SRO')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- CREATE VIEW kpiemail.dim_target_sro\n-- AS\nSELECT\n   *\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/dimensao_target_sro.parquet',\n        FORMAT='PARQUET'\n    ) AS [result]\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/KPI_EMAIL_CREATE_VIEW_FATO_INTERACOES')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"folder": {
					"name": "KPI VISITACAO & EMAIL"
				},
				"content": {
					"query": "-- ALTER VIEW kpiemail.fato_interacoes\n-- as\nSELECT\n    [KEY_TERR_CONT_CICLO]\n,[ID_VISITA]\n,[TIPO_VISITA]\n,[TIPO_VISITA_PTBR]\n,[TIPO_VISITA_ORDER]\n,[CLM_IND]\n,[RECORD_TYPE_ID]\n,[RECORD_TYPE_NAME]\n,[DATA]\n,[CICLO]\n,[TARGET_PER_ID]\n,[ROW_ID_TERRITORIO]\n,[SEMANA]\n,[FLAG_VISITA]\n,[TIPO_INTERACAO]\n,[ROW_ID_CONTATO]\n,[VP]\n,[VR]\n,[VRE]\n,[VRT]\n,[PLANEJUN]\n,[REALUN]\n,[EFFECTIVE_CALLS]\n,[UNDER_CALLS]\n,[OVER_CALLS]\n,[OFF_TARGET_CALLS]\n,[TARGET_CUST]\n,[UNDER_TARGET]\n,[ON_TARGET]\n,[OVER_TARGET]\n,[EMAIL_CONSENT_KPI]\n,[AT_DESIRED_FREQUENCY]\n,[OVER_DESIRED_FREQUENCY]\n,[ID_ENVIO_EMAIL]\n,[ID_ATIV_EMAIL]\n,[TIPO_ATIV_EMAIL]\n,[DATA_ATIV_EMAIL]\n,[PRODUTO]\n,[DOCUMENTO_EMAIL]\n,[DESC_DOCUMENTO_EMAIL]\n,[ASSUNTO_EMAIL]\n,[PRODUTO_FRANCHISE]\n,[FRANCHISE]\n,[SUB_CAT_FRANCHISE]\n,[PESO_FRANCHISE]\n,[EVENTO]\n,[ID_EVENTO]\n,[EV_CICLO]\n,[DATA_EVENTO]\n,[DATA_EVENTO_2]\n,[EV_CICLO_TERRITORIO]\n,[EV_CICLO_CONTATO]\n,[ID_PARTICIPANTE]\n,[NOME_PARTICIPANTE]\n,[EV_ROW_ID_TERRITORIO]\n,[NOME_USUARIO]\n,[EV_ROW_ID_CONTATO]\n,[DOCUMENTO]\n,[EV_ESPECIALIDADE_ENG]\n,[STATUS_CONVIDADO_GR]\n,[STATUS_CONVIDADO]\n,[STATUS_CONVIDADO_ENG]\n,[PRODUTO_PRIMARIO]\n,[PRODUTO_SECUNDARIO]\n,[TIPO_PARTICIPACAO]\n,[TIPO_PARTICIPACAO_ENG]\n,[TIPO_CONTA]\n,[TIPO_CONTA_ENG]\n,[VISITADO_SETOR]\n,[NOME_SETOR_VISITANTE]\n,[EV_ESPECIALIDADE]\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Email & KPI Visitacao/fato_interacoes_*.parquet',\n        FORMAT='PARQUET'\n    ) WITH(\n         [KEY_TERR_CONT_CICLO]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ID_VISITA]                VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8   \n,[TIPO_VISITA]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPO_VISITA_PTBR]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPO_VISITA_ORDER]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CLM_IND]\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[RECORD_TYPE_ID]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[RECORD_TYPE_NAME]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[DATA]\t\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[CICLO]\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TARGET_PER_ID]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ROW_ID_TERRITORIO]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[SEMANA]\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[FLAG_VISITA]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPO_INTERACAO]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ROW_ID_CONTATO]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[VP]\t\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[VR]\t\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[VRE]\t\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[VRT]\t\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[PLANEJUN]\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[REALUN]\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EFFECTIVE_CALLS]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[UNDER_CALLS]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[OVER_CALLS]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[OFF_TARGET_CALLS]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TARGET_CUST]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[UNDER_TARGET]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ON_TARGET]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[OVER_TARGET]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EMAIL_CONSENT_KPI]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[AT_DESIRED_FREQUENCY]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[OVER_DESIRED_FREQUENCY]\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ID_ENVIO_EMAIL]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ID_ATIV_EMAIL]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPO_ATIV_EMAIL]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[DATA_ATIV_EMAIL]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[PRODUTO]\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[DOCUMENTO_EMAIL]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[DESC_DOCUMENTO_EMAIL]\t\tVARCHAR(MAX) COLLATE Latin1_General_100_BIN2_UTF8\n,[ASSUNTO_EMAIL]\t\t\tVARCHAR(MAX) COLLATE Latin1_General_100_BIN2_UTF8\n,[PRODUTO_FRANCHISE]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[FRANCHISE]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[SUB_CAT_FRANCHISE]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[PESO_FRANCHISE]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EVENTO]\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ID_EVENTO]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EV_CICLO]\t\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[DATA_EVENTO]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[DATA_EVENTO_2]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EV_CICLO_TERRITORIO]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EV_CICLO_CONTATO]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[ID_PARTICIPANTE]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[NOME_PARTICIPANTE]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EV_ROW_ID_TERRITORIO]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[NOME_USUARIO]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EV_ROW_ID_CONTATO]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[DOCUMENTO]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EV_ESPECIALIDADE_ENG]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[STATUS_CONVIDADO_GR]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[STATUS_CONVIDADO]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[STATUS_CONVIDADO_ENG]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[PRODUTO_PRIMARIO]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[PRODUTO_SECUNDARIO]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPO_PARTICIPACAO]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPO_PARTICIPACAO_ENG]\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPO_CONTA]\t\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[TIPO_CONTA_ENG]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[VISITADO_SETOR]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[NOME_SETOR_VISITANTE]\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n,[EV_ESPECIALIDADE]\t\t\tVARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    )AS ROW\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/TESTE UNITARIO')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "SELECT\n    TOP 100  \n    chave.[PRIMARY KEY],\n    valor.*\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gsksynapsestorage/synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_audit_end.parquet',\n        FORMAT='PARQUET'\n    ) AS valor\nleft join (\n  SELECT\n\t   ROW_NUMBER() OVER(ORDER BY(temp.[CRM_UNIV])) AS 'PRIMARY KEY'\t\n      ,temp.[CRM_UNIV]\n  FROM \n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gsksynapsestorage/synapse/workspaces/gsk-synapse/warehouse/dash.email1to1/dim_audit_end.parquet',\n        FORMAT='PARQUET'\n   ) as temp\n   GROUP BY temp.[CRM_UNIV]) AS [chave] ON valor.[CRM_UNIV] = chave.[CRM_UNIV];",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "GSK",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Sink_KPI_Visitacao')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "gsk-synapse-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "KPI Visitacao",
						"fileSystem": "gskoutputfiles"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/gsk-synapse-WorkspaceDefaultStorage')]"
			]
		}
	]
}