{
	"name": "2 - Extract - KPI Visitacao",
	"properties": {
		"activities": [
			{
				"name": "dim_eventos",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": "SET NOCOUNT ON\n\nSELECT  \n\t\tROW_NUMBER() OVER(ORDER BY (GETDATE())) as ID,\n\t\tf.[% EVENTO],\n\t\tf.[% ID_EVENTO],\n\t\tf.[% EM_ID_EVENTO],\n\t\tf.[% EM_ID_EVENTO] + [NOME_PARTICIPANTE]\tas '% XLS',\n\t\tf.[CICLO],\n\t\tf.[FATO_DATA],\n\t\tf.[ID_PARTICIPANTE],\n\t\tf.[EV ROW_ID_TERRITORIO],\n\t\tf.[EV ROW_ID_CONTATO],\n\t\tf.[TIPO_CONTA],\n\t\tCASE\n\t\twhen f.TIPO_CONTA = 'Usuário' then\n\t\t\tCase\n\t\t\t\twhen Len(f.TERRITORIO) > 0 then f.TERRITORIO\n\t\t\t\telse \n\t\t\t\t\tCase\n\t\t\t\t\t\tWHEN Len(f.TERRITORIO_GD) > 0 THEN f.TERRITORIO_GD\n\t\t\t\t\t\tELSE 'N/D'\n\t\t\t\t\t\tEND\n\t\t\t\tEND\n\t\tELSE f.DOCUMENTO \n\t\tEND AS 'DOCUMENTO',\n\t\tf.[EV ESPECIALIDADE],\n\t\tf.NOME_PARTICIPANTE,\n\t\tf.NOME_REPRESENTANTE,\n\t\tf.NOME_GD,\n\t\tf.STATUS_CONVIDADO \tas 'STATUS_CONVIDADO_ENG',\n\t\tCASE\n\t\tWHEN (f.STATUS_CONVIDADO = 'Invited' or \n\t\t\t  f.STATUS_CONVIDADO = 'Approved' or \n\t\t\t  f.STATUS_CONVIDADO = 'Nominated')THEN 'Convidado'\n\t\tWHEN f.STATUS_CONVIDADO = 'Attended' THEN 'Participou'\n\t\tWHEN f.STATUS_CONVIDADO = 'Signed' THEN 'Assinado'\n\t\tWHEN f.STATUS_CONVIDADO = 'Accepted' THEN 'Aceitou'\n\t\tWHEN f.STATUS_CONVIDADO = 'Canceled' THEN 'Cancelado'\n\t\tWHEN f.STATUS_CONVIDADO = 'Cleared Signature' THEN 'Assinatura apagada'\n\t\tWHEN f.STATUS_CONVIDADO = 'No Show' THEN 'Não compareceu'\n\t\tWHEN (f.STATUS_CONVIDADO = 'Rejected' or f.STATUS_CONVIDADO = 'No Response') THEN 'Rejeitou'\n\t\tELSE f.STATUS_CONVIDADO\n\t\tEND AS 'STATUS_CONVIDADO',\n\n\t\tCASE\n\t\tWHEN (f.STATUS_CONVIDADO = 'Invited' OR \n\t\t\t  f.STATUS_CONVIDADO = 'Accepted' OR \n\t\t\t  f.STATUS_CONVIDADO = 'Approved' OR \n\t\t\t  f.STATUS_CONVIDADO = 'Canceled' OR\n\t\t\t  f.STATUS_CONVIDADO = 'Cleared Signature' OR\n\t\t\t  f.STATUS_CONVIDADO = 'No Show' OR\n\t\t\t  f.STATUS_CONVIDADO = 'Nominated' OR\n\t\t\t  f.STATUS_CONVIDADO = 'Rejected' OR\n\t\t\t  f.STATUS_CONVIDADO = 'No Response') THEN 'Convidado'\n\t\tWHEN (f.STATUS_CONVIDADO = 'Attended' OR f.STATUS_CONVIDADO = 'Signed') THEN 'Participou'\n\t\tELSE f.STATUS_CONVIDADO\n\t\tEND AS 'STATUS_CONVIDADO_GR',\n\n\t\tTIPO_PARTICIPACAO\tas 'TIPO_PARTICIPACAO_ENG',\n\t\tCASE\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'F2F Participant' THEN 'F2F'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Chairman / Moderator' THEN 'Moderador'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Facilitator' THEN 'FV GSK'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Hybrid Participant' THEN 'Híbrido'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Primary Contact' THEN 'Staff GSK'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Speaker' THEN 'Palestrante'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Subject Matter Expert' THEN 'Especialista Convidado'\n\t\tELSE f.TIPO_PARTICIPACAO \n\t\tEND as 'TIPO_PARTICIPACAO'\nfrom FATO_EVENTOS_TEMP f\nWHERE (f.[% EVENTO] <> 'N/D' OR f.[% EVENTO] is not null OR f.[% EVENTO] <> '')\nOPTION(FAST 10000)",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "bigint"
								},
								"sink": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "Int64"
								}
							},
							{
								"source": {
									"name": "% EVENTO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "% EVENTO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "% ID_EVENTO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "% ID_EVENTO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "% EM_ID_EVENTO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "% EM_ID_EVENTO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "% XLS",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "% XLS",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "CICLO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "CICLO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "FATO_DATA",
									"type": "DateTime",
									"physicalType": "date"
								},
								"sink": {
									"name": "FATO_DATA",
									"type": "DateTime",
									"physicalType": "DateTime"
								}
							},
							{
								"source": {
									"name": "ID_PARTICIPANTE",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "ID_PARTICIPANTE",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "EV ROW_ID_TERRITORIO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "EV ROW_ID_TERRITORIO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "EV ROW_ID_CONTATO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "EV ROW_ID_CONTATO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TIPO_CONTA",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "TIPO_CONTA",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "DOCUMENTO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "DOCUMENTO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "EV ESPECIALIDADE",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "EV ESPECIALIDADE",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "NOME_PARTICIPANTE",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "NOME_PARTICIPANTE",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "NOME_REPRESENTANTE",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "NOME_REPRESENTANTE",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "NOME_GD",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "NOME_GD",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "STATUS_CONVIDADO_ENG",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "STATUS_CONVIDADO_ENG",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "STATUS_CONVIDADO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "STATUS_CONVIDADO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "STATUS_CONVIDADO_GR",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "STATUS_CONVIDADO_GR",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TIPO_PARTICIPACAO_ENG",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "TIPO_PARTICIPACAO_ENG",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TIPO_PARTICIPACAO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "TIPO_PARTICIPACAO",
									"type": "String",
									"physicalType": "String"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SqlServerGSK",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "2_Arquivo_Em_TxT",
						"type": "DatasetReference",
						"parameters": {
							"nome_do_arquivo": "dim_eventos.txt"
						}
					}
				]
			},
			{
				"name": "dim_eventos_expandida",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": "SET NOCOUNT ON\n\nSELECT\n\t\t\n\t\tROW_NUMBER() OVER(ORDER BY (GETDATE())) as ID,\n\t\tf.[% EVENTO],\n\t\tf.[% ID_EVENTO],\n\t\tf.[% EM_ID_EVENTO],\n\t\tf.[% EM_ID_EVENTO] + f.[NOME_PARTICIPANTE]\tas '% XLS',\n\t\tf.[CICLO],\n\t\tf.[FATO_DATA],\n\t\tf.[ID_PARTICIPANTE],\n\t\tf.[EV ROW_ID_TERRITORIO],\n\t\tf.[EV ROW_ID_CONTATO],\n\t\tf.[TIPO_CONTA],\n\t\tCASE\n\t\twhen f.TIPO_CONTA = 'Usuário' then\n\t\t\tCase\n\t\t\t\twhen Len(f.TERRITORIO) > 0 then f.TERRITORIO\n\t\t\t\telse \n\t\t\t\t\tCase\n\t\t\t\t\t\tWHEN Len(f.TERRITORIO_GD) > 0 THEN f.TERRITORIO_GD\n\t\t\t\t\t\tELSE 'N/D'\n\t\t\t\t\t\tEND\n\t\t\t\tEND\n\t\tELSE f.DOCUMENTO \n\t\tEND AS 'DOCUMENTO',\n\t\tf.[EV ESPECIALIDADE],\n\t\tf.NOME_REPRESENTANTE,\n\t\tf.NOME_GD,\n\t\tf.STATUS_CONVIDADO \tas 'STATUS_CONVIDADO_ENG',\n\t\tCASE\n\t\tWHEN (f.STATUS_CONVIDADO = 'Invited' or \n\t\t\t  f.STATUS_CONVIDADO = 'Approved' or \n\t\t\t  f.STATUS_CONVIDADO = 'Nominated')THEN 'Convidado'\n\t\tWHEN f.STATUS_CONVIDADO = 'Attended' THEN 'Participou'\n\t\tWHEN f.STATUS_CONVIDADO = 'Signed' THEN 'Assinado'\n\t\tWHEN f.STATUS_CONVIDADO = 'Accepted' THEN 'Aceitou'\n\t\tWHEN f.STATUS_CONVIDADO = 'Canceled' THEN 'Cancelado'\n\t\tWHEN f.STATUS_CONVIDADO = 'Cleared Signature' THEN 'Assinatura apagada'\n\t\tWHEN f.STATUS_CONVIDADO = 'No Show' THEN 'Não compareceu'\n\t\tWHEN (f.STATUS_CONVIDADO = 'Rejected' or f.STATUS_CONVIDADO = 'No Response') THEN 'Rejeitou'\n\t\tELSE f.STATUS_CONVIDADO\n\t\tEND AS 'STATUS_CONVIDADO',\n\n\t\tCASE\n\t\tWHEN (f.STATUS_CONVIDADO = 'Invited' OR \n\t\t\t  f.STATUS_CONVIDADO = 'Accepted' OR \n\t\t\t  f.STATUS_CONVIDADO = 'Approved' OR \n\t\t\t  f.STATUS_CONVIDADO = 'Canceled' OR\n\t\t\t  f.STATUS_CONVIDADO = 'Cleared Signature' OR\n\t\t\t  f.STATUS_CONVIDADO = 'No Show' OR\n\t\t\t  f.STATUS_CONVIDADO = 'Nominated' OR\n\t\t\t  f.STATUS_CONVIDADO = 'Rejected' OR\n\t\t\t  f.STATUS_CONVIDADO = 'No Response') THEN 'Convidado'\n\t\tWHEN (f.STATUS_CONVIDADO = 'Attended' OR f.STATUS_CONVIDADO = 'Signed') THEN 'Participou'\n\t\tELSE f.STATUS_CONVIDADO\n\t\tEND AS 'STATUS_CONVIDADO_GR',\n\n\t\tTIPO_PARTICIPACAO\tas 'TIPO_PARTICIPACAO_ENG',\n\t\tCASE\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'F2F Participant' THEN 'F2F'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Chairman / Moderator' THEN 'Moderador'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Facilitator' THEN 'FV GSK'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Hybrid Participant' THEN 'Híbrido'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Primary Contact' THEN 'Staff GSK'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Speaker' THEN 'Palestrante'\n\t\tWHEN f.TIPO_PARTICIPACAO  = 'Subject Matter Expert' THEN 'Especialista Convidado'\n\t\tELSE f.TIPO_PARTICIPACAO \n\t\tEND as 'TIPO_PARTICIPACAO',\n\t\tt3.NOME_USUARIO,\n\t\tt3.CICLO_TERRITORIO_CONTATO_EXP,\n\t\tt3.CICLO_TERRITORIO_EXP,\n\t\tt3.[EV CICLO_CONTATO],\n\t\tt3.NOME_PARTICIPANTE\nfrom FATO_EVENTOS_TEMP f\nLEFT JOIN (SELECT  \n\t\tu.[% EVENTO],\n\t\tu.NOME_PARTICIPANTE as 'NOME_USUARIO',\n\t\tc.NOME_PARTICIPANTE,\n\t\tc.[EV CICLO_CONTATO],\n\t\tu.[CICLO] + \n\t\t'-' + \n\t\tu.[EV ROW_ID_TERRITORIO] + \n\t\t'-' +\n\t\tc.[EV ROW_ID_CONTATO] as 'CICLO_TERRITORIO_CONTATO_EXP',\n\t\tu.[CICLO] + \n\t\t'-' + \n\t\tu.[EV ROW_ID_TERRITORIO] as 'CICLO_TERRITORIO_EXP'\nfrom FATO_EVENTOS_TEMP u\nLEFT JOIN ( SELECT  \n\t\t[% EVENTO],\n\t\tNOME_PARTICIPANTE,\n\t\t[CICLO] + '-' + [EV ROW_ID_CONTATO] as 'EV CICLO_CONTATO',\n\t\t[EV ROW_ID_CONTATO] \n\t\tfrom FATO_EVENTOS_TEMP\n\t\tWHERE ([% EVENTO] <> 'N/D' OR [% EVENTO] is not null OR [% EVENTO] <> '') AND\n\t\tTIPO_CONTA <> 'Usuário') as c on u.[% EVENTO] = c.[% EVENTO]\t\t\nWHERE (u.[% EVENTO] <> 'N/D' OR u.[% EVENTO] is not null OR u.[% EVENTO] <> '') AND\nu.TIPO_CONTA = 'Usuário') as t3 ON f.[% EVENTO] = t3.[% EVENTO]\nWHERE (f.[% EVENTO] <> 'N/D' OR f.[% EVENTO] is not null OR f.[% EVENTO] <> '')\nOPTION(FAST 10000)",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "bigint"
								},
								"sink": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "Int64"
								}
							},
							{
								"source": {
									"name": "% EVENTO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "% EVENTO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "% ID_EVENTO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "% ID_EVENTO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "% EM_ID_EVENTO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "% EM_ID_EVENTO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "% XLS",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "% XLS",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "CICLO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "CICLO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "FATO_DATA",
									"type": "DateTime",
									"physicalType": "date"
								},
								"sink": {
									"name": "FATO_DATA",
									"type": "DateTime",
									"physicalType": "DateTime"
								}
							},
							{
								"source": {
									"name": "ID_PARTICIPANTE",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "ID_PARTICIPANTE",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "EV ROW_ID_TERRITORIO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "EV ROW_ID_TERRITORIO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "EV ROW_ID_CONTATO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "EV ROW_ID_CONTATO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TIPO_CONTA",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "TIPO_CONTA",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "DOCUMENTO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "DOCUMENTO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "EV ESPECIALIDADE",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "EV ESPECIALIDADE",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "NOME_REPRESENTANTE",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "NOME_REPRESENTANTE",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "NOME_GD",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "NOME_GD",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "STATUS_CONVIDADO_ENG",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "STATUS_CONVIDADO_ENG",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "STATUS_CONVIDADO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "STATUS_CONVIDADO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "STATUS_CONVIDADO_GR",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "STATUS_CONVIDADO_GR",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TIPO_PARTICIPACAO_ENG",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "TIPO_PARTICIPACAO_ENG",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TIPO_PARTICIPACAO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "TIPO_PARTICIPACAO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "NOME_USUARIO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "NOME_USUARIO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "CICLO_TERRITORIO_CONTATO_EXP",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "CICLO_TERRITORIO_CONTATO_EXP",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "CICLO_TERRITORIO_EXP",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "CICLO_TERRITORIO_EXP",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "EV CICLO_CONTATO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "EV CICLO_CONTATO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "NOME_PARTICIPANTE",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "NOME_PARTICIPANTE",
									"type": "String",
									"physicalType": "String"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SqlServerGSK",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "2_Arquivo_Em_TxT",
						"type": "DatasetReference",
						"parameters": {
							"nome_do_arquivo": "dim_eventos_expandida.txt"
						}
					}
				]
			},
			{
				"name": "dim_eventos_produtos",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": "SET NOCOUNT ON\n\nSELECT  distinct\n\t\tROW_NUMBER() OVER(ORDER BY (GETDATE())) as ID,\nCASE\nWHEN xls.[Event: Event ID] is null then sp.[Event: Event ID]\nelse xls.[Event: Event ID] end as 'EM_ID_EVENTO',\nCASE\nWHEN UPPER(xls.[Event: Product]) is null then UPPER(sp.[Event: Product])\nelse UPPER(xls.[Event: Product]) end as 'PRODUTO_PRIMARIO_XLS',\nCASE\nWHEN UPPER(xls.[Event: Secondary Product]) is null then UPPER(sp.[Event: Secondary Product])\nelse UPPER(xls.[Event: Secondary Product]) end as 'PRODUTO_SECUNDARIO_XLS',\nCASE\nWHEN xls.[Event: Topic] is null then sp.[Event: Topic]\nelse xls.[Event: Topic] end as 'TOPICO',\nCASE\nWHEN xls.[Event: Additional Therapy Area] is null then sp.[Event: Additional Therapy Area]\nelse xls.[Event: Additional Therapy Area] end as 'AREA TERAPEUTICA',\nCASE\nWHEN xls.[Event: Therapy Area - Others]is null then sp.[Event: Therapy Area - Others]\nelse xls.[Event: Therapy Area - Others] end as 'AREA TERAPEUTICA 2',\nCASE\nWHEN xls.[Event: Parent Event] is null then sp.[Parent Event]\nelse xls.[Event: Parent Event] end as 'NOME_EVENTO_PAI',\nCASE\nWHEN xls.[Event: Record Type] is null then sp.[Event: Record Type]\nelse xls.[Event: Record Type] end as 'TIPO_REGISTRO',\nCASE\nWHEN xls.[Event: Created Alias] is null then sp.[Event: Created Alias]\nelse xls.[Event: Created Alias] end as 'MUDID_CRADOR',\nCASE\nWHEN xls.[Event: Created By] is null then sp.[Event: Created By]\nelse xls.[Event: Created By] end as 'CRIADO_POR'\nfrom [USPRD1967].[dbo].[br_veeva_evento_evento] as xls\nfull outer join [USPRD1967].[dbo].[br_veeva_evento_sem_participantes]\nas sp on xls.[Event: Event ID] = sp.[Event: Event ID]\nOPTION(FAST 10000)",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "bigint"
								},
								"sink": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "Int64"
								}
							},
							{
								"source": {
									"name": "EM_ID_EVENTO",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "EM_ID_EVENTO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "PRODUTO_PRIMARIO_XLS",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "PRODUTO_PRIMARIO_XLS",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "PRODUTO_SECUNDARIO_XLS",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "PRODUTO_SECUNDARIO_XLS",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TOPICO",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "TOPICO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "AREA TERAPEUTICA",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "AREA TERAPEUTICA",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "AREA TERAPEUTICA 2",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "AREA TERAPEUTICA 2",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "NOME_EVENTO_PAI",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "NOME_EVENTO_PAI",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TIPO_REGISTRO",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "TIPO_REGISTRO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "MUDID_CRADOR",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "MUDID_CRADOR",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "CRIADO_POR",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "CRIADO_POR",
									"type": "String",
									"physicalType": "String"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SqlServerGSK",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "2_Arquivo_Em_TxT",
						"type": "DatasetReference",
						"parameters": {
							"nome_do_arquivo": "dim_eventos_produtos.txt"
						}
					}
				]
			},
			{
				"name": "dim_msl_division",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": "SET NOCOUNT ON\n\n\nDECLARE @divisao as NVARCHAR\nset @divisao = 'A.DIVISÃO'\n\nSET NOCOUNT ON\n\nSELECT  distinct\n\t\tROW_NUMBER() OVER(ORDER BY (GETDATE())) as ID,   \n    CASE \n    \tWHEN RIGHT(A.TERRITORIO,6) ='022010' THEN 'MSL LUPUS'\n        WHEN RIGHT(A.TERRITORIO,6) ='037000' THEN 'MSL HEALTHECO'\n        WHEN RIGHT(A.TERRITORIO,6) ='022001' THEN 'MSL VIIV'\n        WHEN RIGHT(A.TERRITORIO,6) ='022011' THEN 'MSL VIIV'\n        WHEN RIGHT(A.TERRITORIO,6) ='022012' THEN 'MSL VIIV'\n        WHEN RIGHT(A.TERRITORIO,6) ='022007' THEN 'MSL RESP'\n        WHEN RIGHT(A.TERRITORIO,6) ='022009' THEN 'MSL RESP'\n        WHEN RIGHT(A.TERRITORIO,6) ='036000' THEN 'MSL DPOC'\n        WHEN RIGHT(A.TERRITORIO,6) ='055001' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055002' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055003' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055004' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055005' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055006' THEN 'MSL VACINAS'\n\tELSE @divisao END +' - '+ A.CICLO AS KEY_DIVISAO_CICLO,\n    COUNT(A.TERRITORIO) as FUNC_TOTAL   \nFROM \n\t(SELECT * FROM Dim_Cad_Forca_Vendas WHERE FLAG_BI IS NULL) A LEFT OUTER JOIN Dim_Rep_Target B\n    ON\tA.CICLO = B.CICLO AND A.ROW_ID_TERRITORIO = B.ROW_ID_TERRITORIO\n\n\tLEFT OUTER JOIN (\tSELECT DISTINCT \n\t\t\t\t\t\t\t--A.TERRITORY,B.TERRITORIO,\n\t\t\t\t\t\t\tRIGHT(A.CYCLE_PLAN_NAME,6) AS CICLO,\n\t\t\t\t\t\t\tB.TERRITORY_ID \n\t\t\t\t\t\tFROM \n\t\t\t\t\t\t\tSTG_Cad_MCCP_Veeva A LEFT OUTER JOIN STG_CAD_HIERARQUIA_VEEVA B\n\t\t\t\t\t\t\tON A.TERRITORY = B.TERRITORIO\n\t\t\t\t\t\tWHERE\n\t\t\t\t\t\t\tLEFT(RIGHT(CYCLE_PLAN_NAME,6),4) IN (CAST(YEAR(GETDATE()) AS VARCHAR(6)),CAST(YEAR(GETDATE())-1 AS VARCHAR(6)))) C\n\tON A.CICLO = C.CICLO AND A.ROW_ID_TERRITORIO = C.TERRITORY_ID\nWHERE \n\tLEFT(CAST(A.CICLO AS VARCHAR(10)),4) IN (YEAR(GETDATE()),YEAR(GETDATE())-1) AND\n    EXISTS (SELECT B.* FROM DIM_CAD_FORCA_VENDAS B WHERE A.CICLO = B.CICLO AND A.ROW_ID_TERRITORIO = B.ROW_ID_TERRITORIO \n            AND B.FLAG_BI IS NULL)\nGROUP BY CASE \n    \tWHEN RIGHT(A.TERRITORIO,6) ='022010' THEN 'MSL LUPUS'\n        WHEN RIGHT(A.TERRITORIO,6) ='037000' THEN 'MSL HEALTHECO'\n        WHEN RIGHT(A.TERRITORIO,6) ='022001' THEN 'MSL VIIV'\n        WHEN RIGHT(A.TERRITORIO,6) ='022011' THEN 'MSL VIIV'\n        WHEN RIGHT(A.TERRITORIO,6) ='022012' THEN 'MSL VIIV'\n        WHEN RIGHT(A.TERRITORIO,6) ='022007' THEN 'MSL RESP'\n        WHEN RIGHT(A.TERRITORIO,6) ='022009' THEN 'MSL RESP'\n        WHEN RIGHT(A.TERRITORIO,6) ='036000' THEN 'MSL DPOC'\n        WHEN RIGHT(A.TERRITORIO,6) ='055001' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055002' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055003' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055004' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055005' THEN 'MSL VACINAS'\n        WHEN RIGHT(A.TERRITORIO,6) ='055006' THEN 'MSL VACINAS'\n\tELSE @divisao END +' - '+ A.CICLO\nOPTION(FAST 10000)",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "bigint"
								},
								"sink": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "Int64"
								}
							},
							{
								"source": {
									"name": "KEY_DIVISAO_CICLO",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "KEY_DIVISAO_CICLO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "FUNC_TOTAL",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "FUNC_TOTAL",
									"type": "Int32",
									"physicalType": "Int32"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SqlServerGSK",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "2_Arquivo_Em_TxT",
						"type": "DatasetReference",
						"parameters": {
							"nome_do_arquivo": "dim_msl_division.txt"
						}
					}
				]
			},
			{
				"name": "dim_coaching",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "SqlServerSource",
						"sqlReaderQuery": "SET NOCOUNT ON\n\nSELECT  distinct\n\t\tROW_NUMBER() OVER(ORDER BY (GETDATE())) as ID,\n\tA.CICLO,\n\tA.TERRITORIO_GD,\n\tA.TOTAL_COACHING,\n\tA.TOTAL_ABATER,\n\tB.[DIAS UTEIS] AS DIAS_UTEIS_COACHING\nFROM \n\tDIM_TFT_COACHING A LEFT OUTER JOIN DIM_CAD_CICLO_PROMOCIONAL B\n\tON\tA.CICLO = B.CICLO\nWHERE\n\tLEFT(A.CICLO,4) IN (YEAR(GETDATE()),YEAR(GETDATE())-1)\nOPTION(FAST 10000)",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "DelimitedTextSink",
						"storeSettings": {
							"type": "AzureBlobStorageWriteSettings"
						},
						"formatSettings": {
							"type": "DelimitedTextWriteSettings",
							"quoteAllText": true,
							"fileExtension": ".txt"
						}
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "bigint"
								},
								"sink": {
									"name": "ID",
									"type": "Int64",
									"physicalType": "Int64"
								}
							},
							{
								"source": {
									"name": "CICLO",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "CICLO",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TERRITORIO_GD",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "TERRITORIO_GD",
									"type": "String",
									"physicalType": "String"
								}
							},
							{
								"source": {
									"name": "TOTAL_COACHING",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 10
								},
								"sink": {
									"name": "TOTAL_COACHING",
									"type": "Decimal",
									"physicalType": "Decimal"
								}
							},
							{
								"source": {
									"name": "TOTAL_ABATER",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 2,
									"precision": 10
								},
								"sink": {
									"name": "TOTAL_ABATER",
									"type": "Decimal",
									"physicalType": "Decimal"
								}
							},
							{
								"source": {
									"name": "DIAS_UTEIS_COACHING",
									"type": "Int32",
									"physicalType": "int"
								},
								"sink": {
									"name": "DIAS_UTEIS_COACHING",
									"type": "Int32",
									"physicalType": "Int32"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "SqlServerGSK",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "2_Arquivo_Em_TxT",
						"type": "DatasetReference",
						"parameters": {
							"nome_do_arquivo": "dim_coaching.txt"
						}
					}
				]
			}
		],
		"folder": {
			"name": "Extract"
		},
		"annotations": []
	}
}