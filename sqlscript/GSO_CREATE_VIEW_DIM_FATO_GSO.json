{
	"name": "GSO_CREATE_VIEW_DIM_FATO_GSO",
	"properties": {
		"folder": {
			"name": "GSO"
		},
		"content": {
			"query": "-- ALTER VIEW gso.fato_gso\n-- AS\n\nSELECT\n    [CALL_SUMMARY_ID]\n    ,[PARENT_CALL_AID]\n    ,[LOCAL_CALL_DATE_ID]\n    ,[CALL_DATE_ID]\n    ,[TERRITORY_ID]\n    ,[CYCLE]\n    ,[SALES_FORCE_KEY]\n    ,CASE\n    WHEN LEN([DATE]) = 6 then CAST(CONCAT(left([DATE],4),'-',right([DATE],2),'-01') as DATE)\n    ELSE CAST(left([DATE],10) AS DATE) END AS 'DATE'\n    ,[LOCAL_CALL_TIME_ID]\n    ,[ACCOUNT_ID]\n    ,[CALL_NAME]\n    ,[RX_CALL_TYPE]\n    ,[CALL_STATUS]\n    ,[ATTENDEE_TYPE]\n    ,[CLM_IND]\n    ,[SAMPLE_CALL_IND]\n    ,[CALL_TYPE]\n    ,[DETAILED_PRODUCTS]\n    ,[DURATION]\n    ,[CREATED_DATE_ID]\n    ,[CREATED_DATE_TIME_ID]\n    ,[LAST_MODIFIED_DATE_ID]\n    ,[LAST_MODIFIED_DATE_TIME_ID]\n    ,[PRE_CALL_NOTES]\n    ,[NEXT_CALL_NOTES]\n    ,[REVIEW_STATUS]\n    ,[ACCOUNT_NAME]\n    ,[RX_LEGAL_ID]\n    ,[KEY_MESSAGE_NAME]\n    ,[QUESTION_ID]\n    ,[PRODUCT]\n    ,[CALL_DATE]\n    ,[ORIGEM]\n    ,[SURVEY_KEY]\n    ,CAST(left([SOURCE_CREATED_TS],19) as DATETIME) AS [SOURCE_CREATED_TS]\n    ,CAST(left([RESPONSE_LAST_MODIFIED_TS],19) as DATETIME) AS [RESPONSE_LAST_MODIFIED_TS]\n    ,[SOURCE_USER_AID]\n    ,[QUESTION_RESPONSE_ID]\n    ,[RESPONSE_NAME]\n    ,CAST([RESPONSE_NUMBER] as INT) as [RESPONSE_NUMBER]\n    ,[RESPONSE]\n    ,[RESPONSE_QUESTION_ORDER]\n    ,CAST(left([TARGET_LAST_MODIFIED_TS],19) as DATETIME) AS [TARGET_LAST_MODIFIED_TS]\n    ,CAST(left([MODIFIED_DATE],10) as DATE) AS [MODIFIED_DATE]\n    ,[START_DATE_ID]\n    ,[END_DATE_ID]\n    ,[REVIEW_DATE_ID]\n    ,[MANAGER_TERRITORY_ID]\n    ,[EMPLOYEE_TERRITORY_ID]\n    ,CAST([DATE_DIFF] as INT) as [DATE_DIFF]\n    ,[FLAG_PREMIO]\n    ,[RESPONSES_KEY]\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/GSO/fato_gso.parquet',\n        FORMAT='PARQUET'\n    ) WITH(\n\t[CALL_SUMMARY_ID]                    VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[PARENT_CALL_AID]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[LOCAL_CALL_DATE_ID]                VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_DATE_ID]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[TERRITORY_ID]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CYCLE]                             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SALES_FORCE_KEY]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[DATE]                              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[LOCAL_CALL_TIME_ID]                VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[ACCOUNT_ID]                        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_NAME]                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RX_CALL_TYPE]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_STATUS]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[ATTENDEE_TYPE]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CLM_IND]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SAMPLE_CALL_IND]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_TYPE]                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[DETAILED_PRODUCTS]                 VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[DURATION]                          VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CREATED_DATE_ID]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CREATED_DATE_TIME_ID]              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[LAST_MODIFIED_DATE_ID]             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[LAST_MODIFIED_DATE_TIME_ID]        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[PRE_CALL_NOTES]                    VARCHAR(MAX) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[NEXT_CALL_NOTES]                   VARCHAR(MAX) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[REVIEW_STATUS]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[ACCOUNT_NAME]                      VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RX_LEGAL_ID]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[KEY_MESSAGE_NAME]                  VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[QUESTION_ID]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[PRODUCT]                           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[CALL_DATE]                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[ORIGEM]                            VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SURVEY_KEY]                        VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SOURCE_CREATED_TS]                 VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE_LAST_MODIFIED_TS]         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[SOURCE_USER_AID]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[QUESTION_RESPONSE_ID]              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE_NAME]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE_NUMBER]                   VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE]                          VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSE_QUESTION_ORDER]           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[TARGET_LAST_MODIFIED_TS]           VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[MODIFIED_DATE]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[START_DATE_ID]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[END_DATE_ID]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[REVIEW_DATE_ID]                    VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[MANAGER_TERRITORY_ID]              VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[EMPLOYEE_TERRITORY_ID]             VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[DATE_DIFF]                         VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[FLAG_PREMIO]                       VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8\n    ,[RESPONSES_KEY]                     VARCHAR(250) COLLATE Latin1_General_100_BIN2_UTF8 ) AS ROW\n\n--  SELECT column_name,\n--        data_type,\n--        character_maximum_length,\n--        table_name\n-- FROM information_schema.columns\n-- WHERE        table_name like '%fato%'\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"name": "GSK",
				"type": "SqlOnDemand"
			}
		},
		"type": "SqlQuery"
	}
}