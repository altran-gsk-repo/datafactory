{
	"name": "UNIV_MEDICO_CREATE_VIEW_FATO_UNIVERSO_MEDICO",
	"properties": {
		"folder": {
			"name": "UNIVERSO MEDICO"
		},
		"content": {
			"query": "--ALTER VIEW univmed.fato_universo_medico\n--AS\nSELECT DISTINCT \n\n    NULLIF (REPLACE(UPPER(TRIM(KEY_CRM)), 'NO INFO.', ''), '') AS KEY_CRM\n    , NULLIF (REPLACE(UPPER(TRIM(CICLO)), 'NO INFO.', ''), '') AS CICLO\n    , NULLIF (REPLACE(UPPER(TRIM(KEY_CRM_EMAIL)), 'NO INFO.', ''), '') AS KEY_CRM_EMAIL\n    , NULLIF (REPLACE(UPPER(TRIM(UF)),'NO INFO.', ''), '') AS UF\n    , NULLIF (REPLACE(UPPER(TRIM(CRM)), 'NO INFO.', ''), '') AS CRM\n    , NULLIF (REPLACE(UPPER(TRIM(CRM2)), 'NO INFO.', ''), '') AS CRM2\n    , NULLIF (REPLACE(UPPER(TRIM(EMAIL_PRINCIPAL)), 'NO INFO.', ''), '') AS EMAIL_PRINCIPAL\n    , NULLIF (REPLACE(UPPER(TRIM(EMAIL_SECUNDARIO)), 'NO INFO.', ''), '') AS EMAIL_SECUNDARIO\n    , NULLIF (REPLACE(UPPER(TRIM(NOME)), 'NO INFO.', ''), '') AS NOME\n    , NULLIF (REPLACE(UPPER(TRIM(ESPECIALIDADE)), 'NO INFO.', ''), '') AS ESPECIALIDADE\n    , NULLIF (REPLACE(UPPER(TRIM(ESPECIALIDADE2)), 'NO INFO.', ''), '') AS ESPECIALIDADE2\n    , NULLIF (REPLACE(UPPER(TRIM(ESPECIALIDADE3)), 'NO INFO.', ''), '') AS ESPECIALIDADE3\n    , ISNULL (NULLIF(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(TRIM(VISITADO)),'NO INFO.',''),'N',''),'M',''),'S','SIM'),'0',''),'1',''),'2',''),'3',''),'4',''),'5',''),'6',''),'7',''),'8',''),'9',''),''),'NÃO') AS VISITADO\n    , NULLIF (REPLACE(UPPER(TRIM(NETWORK_ID)), 'NO INFO.', ''), '') AS NETWORK_ID\n    , NULLIF (REPLACE(UPPER(TRIM(VEEVA_ID)), 'NO INFO.', ''), '') AS VEEVA_ID\n    , NULLIF (REPLACE(UPPER(TRIM(RX_GIGYA_ID)), 'NO INFO.', ''), '') AS RX_GIGYA_ID\n    , NULLIF (REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(TRIM(TELEFONE)),'Ã','A'),'É','E'),'ROSANACOSENTINO@BOL.COM.BR',''),'ZINABERTELI@YAHOO.COM.BR',''),'AMANDA.REGIO@BOL.COM.BR',''),'REGINABERTELI@GMAIL.COM',''),'CAABRUNO@GMAIL.COM',''),'NAO FORNECE',''),'NAO INFORMA',''),'NO INFO.',''),'CANCELE',''),'CELULAR',''),'THALYTA',''),'ERRADO',''),'MEDICO',''),'NULL',''),'TEL',''),'NA',''),'NI',''),'-',''),' ',''),'(',''),')',''),',',''),'.',''),'.',''),'/',''),':',''),'M',''),'N',''),'+55','')\n        , '') AS TELEFONE\n    , NULLIF (REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(TRIM(CELULAR)),'Ã','A'),'É','E'),'ROSANACOSENTINO@BOL.COM.BR',''),'ZINABERTELI@YAHOO.COM.BR',''),'AMANDA.REGIO@BOL.COM.BR',''),'REGINABERTELI@GMAIL.COM',''),'CAABRUNO@GMAIL.COM',''),'NAO FORNECE',''),'NAO INFORMA',''),'NO INFO.',''),'CANCELE',''),'CELULAR',''),'THALYTA',''),'ERRADO',''),'MEDICO',''),'NULL',''),'TEL',''),'NA',''),'NI',''),'-',''),' ',''),'(',''),')',''),',',''),'.',''),'.',''),'/',''),':',''),'M',''),'N',''),'+55','')\n        , '') AS CELULAR\n    , NULLIF (REPLACE(UPPER(TRIM(EMAIL)), 'NO INFO.', ''), '') AS EMAIL\n    , NULLIF(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(TRIM(EMAIL_ORIGEM)),'NO INFO.',''),'NULL',''),'EEVA EMAIL','VEEVA EMAIL'),'N',''),'S',''),'VV','V'),'UIVERO MEDICO','UNIVERSO MÉDICO'),'') AS EMAIL_ORIGEM\n    , ISNULL (NULLIF(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(TRIM(ONE_MASS)),'NO INFO.',''),'N',''),'M',''),'S','SIM'),'0',''),'1',''),'2',''),'3',''),'4',''),'5',''),'6',''),'7',''),'8',''),'9',''),''),'NÃO') AS ONE_MASS\n    , ISNULL (NULLIF(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(TRIM(ONE_ONE)),'NO INFO.',''),'N',''),'M',''),'S','SIM'),'0',''),'1',''),'2',''),'3',''),'4',''),'5',''),'6',''),'7',''),'8',''),'9',''),''),'NÃO') AS ONE_ONE\n    , ISNULL (NULLIF(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(UPPER(TRIM(VISITADO_GSK)),'NO INFO.',''),'N',''),'M',''),'S','SIM'),'0',''),'1',''),'2',''),'3',''),'4',''),'5',''),'6',''),'7',''),'8',''),'9',''),''),'NÃO') AS VISITADO_GSK\n\nFROM\n    OPENROWSET(\n        BULK 'https://gsksynapseaccount.dfs.core.windows.net/gskoutputfiles/Universo Medico/dimensao_universo_medico_*.parquet',\n        FORMAT='PARQUET'\n    ) WITH (\n[KEY_CRM]\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[CICLO]\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[KEY_CRM_EMAIL]\t\t  VARCHAR(150) COLLATE Latin1_General_100_BIN2_UTF8\n,[UF]\t\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[CRM]\t\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[CRM2]\t\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[EMAIL_PRINCIPAL]\t\t  VARCHAR(150) COLLATE Latin1_General_100_BIN2_UTF8\n,[EMAIL_SECUNDARIO]\t\t  VARCHAR(150) COLLATE Latin1_General_100_BIN2_UTF8\n,[NOME]\t\t\t\t\t  VARCHAR(150) COLLATE Latin1_General_100_BIN2_UTF8\n,[ESPECIALIDADE]\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[ESPECIALIDADE2]\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[ESPECIALIDADE3]\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[VISITADO]\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[NETWORK_ID]\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[VEEVA_ID]\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[RX_GIGYA_ID]\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[TELEFONE]\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[CELULAR]\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[EMAIL]\t\t\t\t  VARCHAR(150) COLLATE Latin1_General_100_BIN2_UTF8\n,[EMAIL_ORIGEM]\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[ONE_MASS]\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[ONE_ONE]\t\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n,[VISITADO_GSK]\t\t\t  VARCHAR(50) COLLATE Latin1_General_100_BIN2_UTF8\n    ) AS ROW \n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "Built-in",
				"databaseName": "GSK"
			}
		},
		"type": "SqlQuery"
	}
}